<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>SNS ì½˜í…ì¸  ìƒì„±ê¸° v5</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root{--bg1:#0f0f14;--bg2:#16161d;--bg3:#1c1c26;--bg4:#22222e;--border:#2a2a3a;--t1:#f0f0f5;--t2:#9a9ab0;--t3:#5a5a72;--ac:#f97316;--acs:rgba(249,115,22,.08);--b:#60a5fa;--g:#34d399;--r:#f87171;--ff:'Inter',sans-serif;--fb:'Inter',sans-serif;--fm:'SF Mono',monospace;--r1:8px;--r2:12px;--r3:16px}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:var(--ff);background:var(--bg1);color:var(--t1);font-size:15px;line-height:1.55;overflow-x:hidden}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-thumb{background:var(--border);border-radius:4px}
.wrap{display:flex;min-height:100vh}
.side{width:220px;background:var(--bg2);border-right:1px solid var(--border);padding:14px 10px;display:flex;flex-direction:column;position:fixed;height:100vh;overflow-y:auto;z-index:10}
.logo{font-size:1.1em;font-weight:700;padding:8px;margin-bottom:14px;display:flex;align-items:center;gap:8px}.logo .dot{width:10px;height:10px;border-radius:50%;background:var(--ac)}
.nav-i{display:flex;align-items:center;gap:8px;width:100%;padding:8px 10px;border:none;background:none;color:var(--t2);font-size:.88em;border-radius:var(--r1);cursor:pointer;text-align:left;transition:.15s;font-family:var(--fb)}
.nav-i:hover{background:var(--bg4);color:var(--t1)}.nav-i.a,.nav-i:active{background:var(--acs);color:var(--ac)}
.ni{font-size:1.1em;width:20px;text-align:center;flex-shrink:0}
.nav-sep{height:1px;background:var(--border);margin:8px 4px}
.main{margin-left:220px;flex:1;padding:20px 28px;max-width:900px}
.top{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;flex-wrap:wrap;gap:8px}
.top-l{display:flex;align-items:center;gap:8px}.top-l .hamburger{display:none;background:none;border:none;color:var(--t1);font-size:1.4em;cursor:pointer}
.mbadge{background:var(--acs);color:var(--ac);padding:2px 8px;border-radius:10px;font-size:.78em;font-weight:600}
.btn-s{background:var(--bg4);color:var(--t2);border:1px solid var(--border);padding:4px 10px;border-radius:var(--r1);cursor:pointer;font-size:.82em;transition:.15s;font-family:var(--fb)}
.btn-s:hover{border-color:var(--ac);color:var(--ac)}
.mnav{display:none;overflow-x:auto;gap:4px;padding:4px 0;margin-bottom:10px}
.mnav button{flex-shrink:0;padding:6px 12px;background:var(--bg3);border:1px solid var(--border);border-radius:20px;color:var(--t2);font-size:.8em;cursor:pointer;white-space:nowrap;font-family:var(--fb)}
.mnav button.a{background:var(--acs);color:var(--ac);border-color:rgba(249,115,22,.2)}
.tab-c{display:none}.tab-c.a{display:block}
.ph{margin-bottom:16px}.pt{font-size:1.25em;font-weight:700;display:flex;align-items:center;gap:8px}.ps{color:var(--t2);font-size:.88em;margin-top:2px}
.sc{background:var(--bg3);border:1px solid var(--border);border-radius:var(--r3);overflow:hidden;margin-bottom:14px}
.sch{padding:10px 14px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.sct{font-weight:600;font-size:.92em}.scb{padding:14px}
.mi{width:100%;padding:8px 10px;background:var(--bg4);border:1px solid var(--border);border-radius:var(--r1);color:var(--t1);font-size:.9em;font-family:var(--fb);outline:none;transition:.15s;margin-bottom:8px}
.mi:focus{border-color:var(--ac)}.mi::placeholder{color:var(--t3)}
select.mi{cursor:pointer;appearance:none}
textarea.mi{resize:vertical;min-height:80px}
.mlbl{font-size:.82em;color:var(--t2);margin-bottom:3px;font-weight:600}
.btn-p{padding:8px 18px;background:var(--ac);color:#fff;border:none;border-radius:var(--r1);cursor:pointer;font-weight:600;font-size:.88em;transition:.15s;font-family:var(--fb)}.btn-p:hover{filter:brightness(1.1)}.btn-p:disabled{opacity:.5;cursor:not-allowed}.btn-p.full{width:100%}
.btn-o{padding:6px 14px;background:var(--bg4);color:var(--t2);border:1px solid var(--border);border-radius:var(--r1);cursor:pointer;font-size:.84em;transition:.15s;font-family:var(--fb)}.btn-o:hover{border-color:var(--ac);color:var(--ac)}
.bg{display:flex;gap:6px;flex-wrap:wrap;margin-top:8px}
.steps{display:flex;gap:0;margin-bottom:14px;background:var(--bg3);border-radius:var(--r2);overflow:hidden;border:1px solid var(--border)}
.step{flex:1;padding:8px 6px;text-align:center;font-size:.8em;color:var(--t3);cursor:pointer;transition:.2s;position:relative}
.step.a{color:var(--ac);background:var(--acs)}.step.done{color:var(--g)}
.step-n{display:block;font-weight:700;font-size:1em;font-family:var(--fm)}
.sc-body{display:none}.sc-body.a{display:block}
.ra{display:none;margin-top:10px}.ra.show{display:block}
.rc{font-size:.88em;color:var(--t2);line-height:1.6;white-space:pre-wrap;max-height:300px;overflow-y:auto;padding:8px}
.ig{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:8px}
.isl{width:64px;height:64px;border:1px dashed var(--border);border-radius:var(--r1);display:flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;transition:.15s;flex-shrink:0;position:relative}
.isl:hover{border-color:var(--ac)}.isl.filled{border-style:solid}.isl img{width:100%;height:100%;object-fit:cover}
.ebtn{padding:4px 10px;background:var(--bg4);border:1px solid var(--border);border-radius:16px;color:var(--t2);font-size:.8em;cursor:pointer;transition:.15s;font-family:var(--fb)}.ebtn:hover{border-color:var(--ac);color:var(--ac)}
.fpi{margin-bottom:6px}.fpt{display:flex;align-items:center;gap:4px;width:100%;padding:6px 10px;background:var(--bg4);border:1px solid var(--border);border-radius:var(--r1);color:var(--t2);font-size:.85em;cursor:pointer;font-family:var(--fb)}.fpt.a{color:var(--g);border-color:rgba(52,211,153,.2)}
.fpc{display:none;padding:6px 0}.fpc.show{display:block}.fta{width:100%;padding:6px 8px;background:var(--bg1);border:1px solid var(--border);border-radius:var(--r1);color:var(--t1);font-size:.85em;font-family:var(--fb);min-height:50px;resize:vertical}
.ad-plats{display:flex;flex-wrap:wrap;gap:4px;margin:6px 0}
.ad-plat{padding:4px 10px;background:var(--bg4);border:1px solid var(--border);border-radius:16px;color:var(--t2);font-size:.8em;cursor:pointer;transition:.15s;font-family:var(--fb)}.ad-plat.a{background:var(--acs);color:var(--ac);border-color:rgba(249,115,22,.2)}
.cmp-vs{display:grid;grid-template-columns:1fr 50px 1fr;gap:10px;align-items:start}.cmp-mid{text-align:center;font-weight:700;color:var(--ac);padding-top:30px}
.dt{width:100%;border-collapse:collapse;font-size:.82em}.dt th{background:var(--bg4);padding:8px 6px;text-align:left;font-weight:600;color:var(--t2);border-bottom:1px solid var(--border)}.dt td{padding:6px;border-bottom:1px solid var(--border);color:var(--t2)}
.ts{overflow-x:auto}
.badge{padding:2px 6px;border-radius:8px;font-size:.78em;font-weight:600}.badge.green{background:rgba(52,211,153,.15);color:var(--g)}.badge.yellow{background:rgba(250,204,21,.12);color:#facc15}.badge.blue{background:rgba(96,165,250,.12);color:var(--b)}.badge.red{background:rgba(248,113,113,.12);color:var(--r)}
.stat-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:8px}
.stat-card{background:var(--bg4);border:1px solid var(--border);border-radius:var(--r2);padding:10px;text-align:center}
.stat-v{font-size:1.3em;font-weight:700;color:var(--ac);font-family:var(--fm)}.stat-l{font-size:.78em;color:var(--t2);margin-top:2px}
.tip-box{padding:10px 12px;background:var(--acs);border:1px solid rgba(249,115,22,.12);border-radius:var(--r2);font-size:.88em;color:var(--t2);line-height:1.6;margin-top:10px}.tip-box b{color:var(--ac)}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:99;backdrop-filter:blur(4px)}.modal.show{display:flex}
.modal-c{background:var(--bg3);border:1px solid var(--border);border-radius:var(--r3);padding:20px;width:90%;max-width:400px}
.modal-t{font-weight:700;font-size:1.05em;margin-bottom:12px}
.md{font-size:.8em;color:var(--t3);margin-top:6px}
.spinner{display:inline-block;width:14px;height:14px;border:2px solid transparent;border-top-color:currentColor;border-radius:50%;animation:sp .6s linear infinite;vertical-align:middle;margin-right:4px}
.toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%) translateY(80px);background:var(--bg4);color:var(--t1);padding:10px 20px;border-radius:var(--r2);font-size:.88em;border:1px solid var(--border);transition:.3s;opacity:0;z-index:100}.toast.show{transform:translateX(-50%) translateY(0);opacity:1}
.p-logo{width:24px;height:24px;display:inline-flex;align-items:center;justify-content:center;border-radius:6px;flex-shrink:0}
.p-logo.naver{background:#03C75A}.p-logo.naver::after{content:'N';color:#fff;font-weight:800;font-size:13px}
.p-logo.ig{background:linear-gradient(45deg,#f09433,#e6683c,#dc2743,#cc2366,#bc1888)}.p-logo.ig::after{content:'';width:11px;height:11px;border:2px solid #fff;border-radius:3px}
.p-logo.fbk{background:#1877F2}.p-logo.fbk::after{content:'f';color:#fff;font-weight:800;font-size:14px}
.ab-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:8px}
.ab-col{background:var(--bg4);border:1px solid var(--border);border-radius:var(--r2);padding:12px;position:relative}
.ab-lbl{position:absolute;top:-8px;left:12px;padding:0 6px;font-size:.78em;font-weight:700;background:var(--bg4);border-radius:4px}
.ab-lbl.a-lbl{color:var(--ac)}.ab-lbl.b-lbl{color:var(--b)}
.credit-bar{display:flex;align-items:center;justify-content:space-between;padding:8px 12px;background:var(--bg1);border:1px solid var(--border);border-radius:var(--r2);margin-top:8px;font-size:.82em;color:var(--t2)}.credit-bar .cv{color:var(--ac);font-family:var(--fm);font-weight:600}
.sub-pills{display:flex;gap:4px;margin-bottom:12px}.sub-pill{padding:6px 14px;background:var(--bg4);border:1px solid var(--border);border-radius:20px;font-size:.88em;cursor:pointer;transition:.2s;color:var(--t2);font-family:var(--fb)}.sub-pill.a{background:var(--acs);color:var(--ac);border-color:rgba(249,115,22,.2)}
.ooh-cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:10px}
.ooh-card{background:var(--bg4);border:1px solid var(--border);border-radius:var(--r3);padding:14px;transition:.2s;cursor:pointer}.ooh-card:hover{border-color:var(--ac);transform:translateY(-2px)}
.ooh-icon{font-size:1.6em;margin-bottom:4px}.ooh-name{font-weight:600;font-size:.95em;margin-bottom:4px}.ooh-price{font-size:.85em;color:var(--ac);margin-bottom:4px}.ooh-info{font-size:.8em;color:var(--t2);line-height:1.5}
.ooh-detail-box{background:var(--bg4);border:1px solid var(--border);border-radius:var(--r3);padding:16px;margin-top:10px;display:none}.ooh-detail-box.show{display:block}
.tag-list{display:flex;flex-wrap:wrap;gap:4px;margin-top:6px}.tag{padding:2px 8px;background:var(--bg4);border:1px solid var(--border);border-radius:12px;font-size:.78em;color:var(--t2)}
.dash-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px;margin-bottom:16px}
.dash-grid.full{grid-column:1/-1}
.hero-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px}
.hero-card{background:var(--bg3);border:1px solid var(--border);border-radius:var(--r3);padding:18px 20px;transition:all .3s}
.hero-card:hover{border-color:rgba(255,255,255,.08);transform:translateY(-2px)}
.hero-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.hero-label{font-size:.9em;color:var(--t2);font-weight:500}
.hero-icon{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:1em}
.hero-icon.views{background:rgba(249,115,22,.15);color:var(--ac)}
.hero-icon.exposure{background:rgba(248,113,113,.15);color:var(--r)}
.hero-icon.posts{background:rgba(96,165,250,.15);color:var(--b)}
.hero-icon.engage{background:rgba(139,92,246,.15);color:#8b5cf6}
.hero-val{font-size:2em;font-weight:700;font-family:var(--fm);color:var(--t1);line-height:1.2;margin-bottom:6px}
.hero-change{font-size:.85em;font-weight:600}
.hero-change.up{color:var(--g)}.hero-change.down{color:var(--r)}.hero-change .arrow{margin-right:2px}
.hero-sub{font-size:.82em;color:var(--t3);margin-top:2px}
.trend-card{background:var(--bg3);border:1px solid var(--border);border-radius:var(--r3);padding:20px;margin-bottom:16px}
.trend-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
.trend-title{font-size:.95em;font-weight:600;display:flex;align-items:center;gap:8px}
.trend-tabs{display:flex;gap:0;background:var(--bg4);border-radius:8px;padding:2px;border:1px solid var(--border)}
.trend-tab{padding:5px 14px;border-radius:6px;font-size:.82em;cursor:pointer;color:var(--t3);font-family:var(--fb);border:none;background:none;transition:.2s;font-weight:500}
.trend-tab.a{background:var(--bg1);color:var(--t1);font-weight:600;box-shadow:0 1px 3px rgba(0,0,0,.2)}
.trend-tab:hover:not(.a){color:var(--t2)}
.trend-chart{display:flex;align-items:flex-end;gap:6px;height:160px;padding-top:10px}
.trend-bar-group{flex:1;display:flex;gap:2px;align-items:flex-end;height:100%}
.trend-bar{border-radius:4px 4px 0 0;transition:all .4s cubic-bezier(.4,0,.2,1);min-width:8px;flex:1;cursor:pointer;position:relative}
.trend-bar:hover{filter:brightness(1.2)}
.trend-bar.naver{background:#3B82F6}.trend-bar.insta{background:var(--ac)}
.trend-day-label{text-align:center;font-size:.72em;color:var(--t3);margin-top:6px;font-weight:500}
.trend-legend{display:flex;gap:14px;margin-top:12px;padding-top:10px;border-top:1px solid var(--border)}
.trend-legend-item{display:flex;align-items:center;gap:5px;font-size:.75em;color:var(--t2)}
.trend-legend-dot{width:8px;height:8px;border-radius:2px}
.visual-card{background:var(--bg3);border:1px solid var(--border);border-radius:var(--r3);padding:20px;height:100%}
.card-header{font-size:1em;font-weight:600;margin-bottom:16px;display:flex;align-items:center;gap:10px;color:var(--t1)}
.card-icon{font-size:1.4em}
.progress-row{margin-bottom:12px}
.progress-label{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;font-size:.85em}
.progress-bar{background:var(--bg1);height:12px;border-radius:20px;overflow:hidden;position:relative}
.progress-fill{height:100%;border-radius:20px;transition:all .8s cubic-bezier(.4,0,.2,1);position:relative;background:linear-gradient(90deg,var(--ac),var(--b))}
.progress-fill::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);animation:shimmer 2s infinite}
@keyframes shimmer{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}
.mini-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
.mini-card{background:var(--bg4);border:1px solid var(--border);border-radius:var(--r2);padding:14px;text-align:center;transition:all .2s}
.mini-card:hover{border-color:var(--ac);transform:translateY(-2px)}
.mini-num{font-size:1.6em;font-weight:700;font-family:var(--fm);color:var(--ac);margin-bottom:4px}
.mini-label{font-size:.82em;color:var(--t3)}
.kw-grid{display:flex;flex-wrap:wrap;gap:8px}
.kw-pill{padding:8px 14px;background:var(--bg4);border:1px solid var(--border);border-radius:20px;font-size:.9em;cursor:pointer;transition:all .2s;display:inline-flex;align-items:center;gap:8px}
.kw-pill:hover{background:var(--acs);border-color:var(--ac);color:var(--ac);transform:scale(1.05)}
.kw-score{background:linear-gradient(135deg,var(--ac),var(--b));color:#fff;padding:3px 8px;border-radius:12px;font-size:.8em;font-weight:600}
.strength-grid{display:grid;gap:12px}
.strength-item{padding:12px;background:var(--bg4);border-left:3px solid var(--g);border-radius:var(--r2);font-size:.9em;color:var(--t2);line-height:1.6;transition:.2s}
.strength-item:hover{background:var(--bg3)}
.strength-item.weak{border-left-color:var(--r)}
.insight-box{background:linear-gradient(135deg,rgba(249,115,22,.08),rgba(96,165,250,.08));border:1px solid rgba(249,115,22,.2);border-radius:var(--r3);padding:18px;margin-bottom:16px}
.insight-title{font-size:1em;font-weight:600;color:var(--ac);margin-bottom:12px;display:flex;align-items:center;gap:8px}
.insight-text{font-size:.9em;color:var(--t2);line-height:1.7}
.compare-row{display:flex;justify-content:space-between;align-items:center;padding:12px;background:var(--bg4);border-radius:var(--r2);margin-bottom:8px;font-size:.9em;transition:.2s}
.compare-row:hover{background:var(--bg3);border:1px solid var(--border)}
.compare-label{color:var(--t2)}
.compare-values{display:flex;align-items:center;gap:12px}
.compare-ours{color:var(--ac);font-weight:600}
.compare-theirs{color:var(--t3);font-size:.9em}
.badge{padding:4px 10px;border-radius:12px;font-size:.75em;font-weight:600}
.badge.good{background:rgba(52,211,153,.15);color:var(--g)}
.badge.bad{background:rgba(248,113,113,.15);color:var(--r)}
.badge.neutral{background:rgba(96,165,250,.15);color:var(--b)}
.platform-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px;margin-bottom:16px}
.platform-card{background:var(--bg3);border:1px solid var(--border);border-radius:var(--r2);padding:12px;transition:all .3s;cursor:pointer;position:relative;overflow:hidden}
.platform-card::before{content:'';position:absolute;top:0;left:0;width:3px;height:100%;transition:.3s}
.platform-card:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.2);border-color:var(--ac)}
.platform-card.naver::before{background:#03C75A}
.platform-card.insta::before{background:linear-gradient(45deg,#f09433,#e6683c,#dc2743,#cc2366,#bc1888)}
.platform-card.facebook::before{background:#1877F2}
.platform-card.homepage::before{background:var(--ac)}
.pc-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.pc-title{display:flex;align-items:center;gap:6px;font-size:.82em;font-weight:600}
.pc-logo{width:22px;height:22px;display:flex;align-items:center;justify-content:center;border-radius:6px}
.pc-row{display:flex;justify-content:space-between;align-items:center;padding:3px 0;font-size:.78em}
.pc-row-label{color:var(--t3)}
.pc-row-val{font-weight:600;font-family:var(--fm);color:var(--t1)}
.pc-row-val.accent{color:var(--ac)}
.pc-eff-bar{margin-top:8px;padding-top:8px;border-top:1px solid var(--border)}
.pc-eff-row{display:flex;align-items:center;gap:6px}
.pc-grade{font-size:.85em;font-weight:700;padding:2px 8px;border-radius:8px;font-family:var(--fm)}
.pc-grade.s{background:rgba(52,211,153,.2);color:var(--g)}.pc-grade.a{background:rgba(249,115,22,.15);color:var(--ac)}.pc-grade.b{background:rgba(96,165,250,.15);color:var(--b)}.pc-grade.c{background:rgba(248,113,113,.15);color:var(--r)}
.pc-cost{font-size:.72em;color:var(--t2)}
.kw-rank-table{width:100%;font-size:.78em;border-collapse:collapse}
.kw-rank-table th{text-align:left;padding:6px 8px;color:var(--t3);font-weight:600;border-bottom:1px solid var(--border);font-size:.9em}
.kw-rank-table td{padding:6px 8px;border-bottom:1px solid rgba(42,42,58,.5);color:var(--t2)}
.kw-rank-table tr:hover{background:var(--bg4)}
.rank-num{font-family:var(--fm);font-weight:700;font-size:1em}
.rank-num.top{color:var(--g)}.rank-num.mid{color:var(--ac)}.rank-num.low{color:var(--r)}
.rank-change{font-size:.8em;font-weight:600}
.rank-change.up{color:var(--g)}.rank-change.down{color:var(--r)}.rank-change.same{color:var(--t3)}
@keyframes sp{to{transform:rotate(360deg)}}@keyframes fu{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
#blog-editor:empty:before{content:attr(data-placeholder);color:var(--t3);pointer-events:none}
#blog-editor img{max-width:100%;border-radius:6px;margin:10px 0;display:block;cursor:pointer}
#blog-editor img:hover{outline:2px solid var(--ac);outline-offset:2px}
#blog-editor img.selected{outline:2px solid var(--r);outline-offset:2px}
#blog-editor p{margin-bottom:6px}
.blog-preview{background:#fff;border-radius:12px;max-width:680px;overflow:hidden;color:#333;font-family:'Noto Sans KR','Malgun Gothic',sans-serif}
.bp-header{background:#fff;padding:16px 20px;border-bottom:1px solid #eee}
.bp-profile{display:flex;align-items:center;gap:10px;margin-bottom:10px}
.bp-avatar{width:36px;height:36px;border-radius:50%;background:#03C75A;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:.85em}
.bp-author{font-size:.88em;font-weight:600;color:#333}
.bp-date{font-size:.78em;color:#999}
.bp-title{font-size:1.3em;font-weight:700;color:#222;line-height:1.4;padding:20px 20px 10px}
.bp-body{padding:0 20px 20px;font-size:.92em;line-height:1.9;color:#333;word-break:keep-all}
.bp-body p{margin-bottom:14px}
.bp-body img{width:100%;border-radius:6px;margin:12px 0}
.bp-body .bp-img-placeholder{background:#f5f5f5;border:1px dashed #ddd;border-radius:6px;padding:30px;text-align:center;color:#aaa;margin:12px 0;font-size:.85em}
.bp-tags{padding:10px 20px 16px;display:flex;flex-wrap:wrap;gap:4px}
.bp-tag{font-size:.82em;color:#03C75A;cursor:default}
.bp-footer{padding:12px 20px;border-top:1px solid #eee;display:flex;gap:16px;font-size:.82em;color:#888}
.bp-footer span{display:flex;align-items:center;gap:4px;cursor:default}
@media(max-width:768px){.blog-preview{border-radius:0}.side{display:none;position:fixed;width:260px}.side.open{display:flex}.main{margin-left:0;padding:12px}.mnav{display:flex}.top-l .hamburger{display:block}.ab-grid{grid-template-columns:1fr}.cmp-vs{grid-template-columns:1fr}.ooh-cards{grid-template-columns:1fr}.dash-grid{grid-template-columns:1fr}.hero-grid{grid-template-columns:1fr 1fr}.platform-cards{grid-template-columns:repeat(2,1fr)}.kw-rank-table{font-size:.7em}.trend-chart{height:120px}}
</style></head><body>
<div class="wrap">
<div class="side" id="sidebar">
<div class="logo"><span class="dot"></span>SNS Generator</div>
<button class="nav-i a" onclick="go('blog')" data-t="blog"><span class="ni"><span class="p-logo naver"></span></span>ë¸”ë¡œê·¸</button>
<button class="nav-i" onclick="go('insta')" data-t="insta"><span class="ni"><span class="p-logo ig"></span></span>ì¸ìŠ¤íƒ€ê·¸ë¨</button>
<button class="nav-i" onclick="go('fb')" data-t="fb"><span class="ni"><span class="p-logo fbk"></span></span>í˜ì´ìŠ¤ë¶</button>
<div class="nav-sep"></div>
<button class="nav-i" onclick="go('sp')" data-t="sp"><span class="ni">ğŸ“</span>ìŠ¤ë§ˆíŠ¸í”Œë ˆì´ìŠ¤</button>
<button class="nav-i" onclick="go('ooh')" data-t="ooh"><span class="ni">ğŸ“‹</span>ì˜¥ì™¸ê´‘ê³ </button>
<div class="nav-sep"></div>
<button class="nav-i" onclick="go('dash')" data-t="dash"><span class="ni">ğŸ“Š</span>ëŒ€ì‹œë³´ë“œ</button>
<button class="nav-i" onclick="go('kwresearch')" data-t="kwresearch"><span class="ni">ğŸ”</span>í‚¤ì›Œë“œ ë¶„ì„</button>
<button class="nav-i" onclick="go('compare')" data-t="compare"><span class="ni">âš–ï¸</span>ë¹„êµ ë¶„ì„</button>
<button class="nav-i" onclick="go('adsim')" data-t="adsim"><span class="ni">ğŸ“¢</span>ê´‘ê³  ì‹œë®¬ë ˆì´í„°</button>
<button class="nav-i" onclick="go('style')" data-t="style"><span class="ni">ğŸ¨</span>ë¬¸ì²´ í•™ìŠµ</button>
<div class="nav-sep"></div>
<button class="nav-i" onclick="showM('m-api')"><span class="ni">ğŸ”‘</span>API ì„¤ì •</button>
<button class="nav-i" onclick="showM('m-myinfo')"><span class="ni">ğŸ‘¤</span>ë‚´ ì •ë³´</button>
</div>

<div class="main">
<div class="top"><div class="top-l"><button class="hamburger" onclick="document.getElementById('sidebar').classList.toggle('open')">â˜°</button><span class="mbadge">AI Engine v5</span></div><div class="top-r"><button class="btn-s" onclick="showM('m-myinfo')">ğŸ‘¤ ë‚´ ì •ë³´</button><button class="btn-s" onclick="showM('m-api')">ğŸ”‘ API</button></div></div>
<div class="mnav" id="mnav"></div>

<!-- ==================== BLOG TAB ==================== -->
<div class="tab-c a" id="blog-tab">
<div class="ph"><div class="pt"><span class="p-logo naver"></span> ë„¤ì´ë²„ ë¸”ë¡œê·¸</div><div class="ps">AIê°€ A/B ë‘ ê°€ì§€ ì•ˆì„ ìƒì„±í•˜ê³  ë¹„êµ ë¶„ì„í•©ë‹ˆë‹¤</div></div>
<div class="steps" id="blog-steps"><div class="step a" onclick="bst(0)"><span class="step-n">01</span>ì •ë³´ ì…ë ¥</div><div class="step" onclick="bst(1)"><span class="step-n">02</span>A/B ìƒì„±</div><div class="step" onclick="bst(2)"><span class="step-n">03</span>ìˆ˜ì •Â·ê²€ìˆ˜</div><div class="step" onclick="bst(3)"><span class="step-n">04</span>ì´ë¯¸ì§€Â·ì™„ì„±</div><div class="step" onclick="bst(4)"><span class="step-n">05</span>ë¯¸ë¦¬ë³´ê¸°</div></div>
<div class="sc-body a" id="bs0">
<div class="sc"><div class="sch"><div class="sct">ğŸ“ ë¸”ë¡œê·¸ ì •ë³´</div></div><div class="scb">
<div class="mlbl">ëª©ì </div><select class="mi" id="b-purpose"><option>ì‹œê³µì‚¬ë¡€ í™ë³´</option><option>ì¥ë¹„ ì†Œê°œ</option><option>í–‰ì‚¬ í›„ê¸°</option><option>ê¸°ìˆ  ì •ë³´</option><option>ì´ë²¤íŠ¸/í”„ë¡œëª¨ì…˜</option></select>
<div class="mlbl">í–‰ì‚¬/í˜„ì¥ëª…</div><input class="mi" id="b-event" placeholder="ì˜ˆ: 2024 ì½”ì—‘ìŠ¤ ì „ì‹œíšŒ">
<div class="mlbl">ìƒì„¸ ë‚´ìš©</div><textarea class="mi" id="b-detail" placeholder="ì£¼ìš” ë‚´ìš©, íŠ¹ì´ì‚¬í•­ ë“±..."></textarea>
<div class="mlbl">ê°•ì¡° í¬ì¸íŠ¸</div><input class="mi" id="b-highlight" placeholder="ì˜ˆ: ì´ˆëŒ€í˜• LED, ì‹¤ì‹œê°„ ì¤‘ê³„">
<div class="bg"><button class="btn-p full" onclick="bst(1)">ë‹¤ìŒ â†’ A/B ìƒì„±</button></div>
</div></div></div>
<div class="sc-body" id="bs1">
<button class="btn-p full" onclick="genBlog()" id="blog-gen-btn">A/B ë‘ ê°€ì§€ ì•ˆ ìƒì„±í•˜ê¸°</button>
<div class="ra" id="blog-ra">
<div class="ab-grid"><div class="ab-col"><span class="ab-lbl a-lbl">Aì•ˆ (ì „ë¬¸í˜•)</span><div class="rc" id="blog-rc-a"></div></div><div class="ab-col"><span class="ab-lbl b-lbl">Bì•ˆ (ì¹œê·¼í˜•)</span><div class="rc" id="blog-rc-b"></div></div></div>
<div class="sc" style="margin-top:10px"><div class="sch"><div class="sct">âš–ï¸ A/B ë¹„êµ ë¶„ì„</div></div><div class="scb"><div class="rc" id="blog-ab-diff"></div></div></div>
<div class="bg"><button class="btn-p" onclick="pickAB('blog','a')">âœ… Aì•ˆ ì„ íƒ</button><button class="btn-p" onclick="pickAB('blog','b')" style="background:var(--b)">âœ… Bì•ˆ ì„ íƒ</button><button class="btn-o" onclick="genBlog()">ğŸ”„ ë‹¤ì‹œ</button></div>
<div class="credit-bar">ì‚¬ìš© í¬ë ˆë”§: <span class="cv" id="blog-credit">$0.00</span> | ëˆ„ì : <span class="cv" id="blog-credit-total">$0.00</span></div>
</div></div>
<div class="sc-body" id="bs2">
<div class="sc"><div class="sch"><div class="sct">âœï¸ ìˆ˜ì •Â·ê²€ìˆ˜</div></div><div class="scb">
<!-- ì—ë””í„° íˆ´ë°” -->
<div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:6px;padding:6px 8px;background:var(--bg1);border:1px solid var(--border);border-bottom:none;border-radius:var(--r1) var(--r1) 0 0">
<button class="ebtn" onclick="aiCheck('blog-edit-ta','spell')">ğŸ” ì˜¤íƒˆì</button>
<button class="ebtn" onclick="aiCheck('blog-edit-ta','sensitive')">âš ï¸ ì˜ˆë¯¼í‘œí˜„</button>
<button class="ebtn" onclick="aiCheck('blog-edit-ta','improve')">âœ¨ ë‹¤ë“¬ê¸°</button>
<button class="ebtn" onclick="editorInsertTag()">ğŸ·ï¸ íƒœê·¸</button>
<span style="width:1px;background:var(--border);margin:0 2px"></span>
<button class="ebtn" style="background:var(--acs);border-color:rgba(249,115,22,.2);color:var(--ac)" onclick="editorInsertImage()">ğŸ“· ì´ë¯¸ì§€ ì‚½ì…</button>
<input type="file" id="blog-inline-file" accept="image/*" style="display:none" onchange="handleEditorImg(this)">
</div>
<!-- ë¦¬ì¹˜ ì—ë””í„° -->
<div id="blog-editor" contenteditable="true" style="width:100%;min-height:280px;padding:14px;background:var(--bg4);border:1px solid var(--border);border-radius:0 0 var(--r1) var(--r1);color:var(--t1);font-size:.9em;font-family:var(--fb);line-height:1.8;outline:none;overflow-y:auto;max-height:500px;word-break:keep-all" data-placeholder="ì„ íƒí•œ ì•ˆì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤. ê¸€ ì‚¬ì´ì— ì´ë¯¸ì§€ë¥¼ ììœ ë¡­ê²Œ ë„£ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."></div>
<!-- ìˆ¨ê²¨ì§„ textarea (AI ì—°ë™ìš©) -->
<textarea class="mi" id="blog-edit-ta" style="display:none"></textarea>

<div class="bg" style="margin-top:8px"><button class="btn-p" onclick="bst(3)">ë‹¤ìŒ â†’ ì™„ì„±</button><button class="btn-o" onclick="bst(1)">â† ì´ì „</button></div>
</div></div></div>
<div class="sc-body" id="bs3">
<div class="sc"><div class="sch"><div class="sct">ğŸ–¼ï¸ ëŒ€í‘œ ì´ë¯¸ì§€ (ì¸ë„¤ì¼)</div></div><div class="scb">
<div class="mlbl">ë¸”ë¡œê·¸ ìƒë‹¨ì— í‘œì‹œë  ëŒ€í‘œ ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”</div>
<div class="ig" id="blog-imgs"><div class="isl" onclick="this.querySelector('input').click()"><span style="color:var(--t3);font-size:1.4em">+</span><input type="file" accept="image/*" style="display:none" onchange="addI(this,'blog-imgs')"></div></div>
</div></div>
<div class="sc"><div class="sch"><div class="sct">ğŸ“‹ ìµœì¢… ê²°ê³¼</div></div><div class="scb"><div class="rc" id="blog-final" style="max-height:400px"></div><div class="bg"><button class="btn-p" onclick="copyF('blog')">ğŸ“‹ ì „ì²´ ë³µì‚¬</button><button class="btn-p" onclick="bst(4)" style="background:var(--b)">ğŸ‘€ ë¯¸ë¦¬ë³´ê¸°</button><button class="btn-o" onclick="bst(2)">â† ìˆ˜ì •</button></div></div></div>
</div>
<div class="sc-body" id="bs4">
<div class="sc"><div class="sch"><div class="sct">ğŸ‘€ ë„¤ì´ë²„ ë¸”ë¡œê·¸ ë¯¸ë¦¬ë³´ê¸°</div><div style="display:flex;gap:4px"><button class="btn-o" onclick="bst(2)">âœï¸ ìˆ˜ì •í•˜ê¸°</button><button class="btn-o" onclick="copyF('blog')">ğŸ“‹ ë³µì‚¬</button></div></div><div class="scb" style="background:var(--bg1);padding:20px">
<div class="blog-preview" id="blog-preview-card"></div>
</div></div>
</div></div>

<!-- ==================== INSTA TAB ==================== -->
<div class="tab-c" id="insta-tab">
<div class="ph"><div class="pt"><span class="p-logo ig"></span> ì¸ìŠ¤íƒ€ê·¸ë¨</div><div class="ps">A/B ìº¡ì…˜ì„ ë¹„êµ ìƒì„±í•©ë‹ˆë‹¤</div></div>
<div class="steps" id="insta-steps"><div class="step a" onclick="ist(0)"><span class="step-n">01</span>ì‚¬ì§„Â·ì •ë³´</div><div class="step" onclick="ist(1)"><span class="step-n">02</span>A/B ìº¡ì…˜</div><div class="step" onclick="ist(2)"><span class="step-n">03</span>ê²€ìˆ˜Â·ì™„ì„±</div></div>
<div class="sc-body a" id="is0">
<div class="sc"><div class="sch"><div class="sct">ğŸ“¸ ì •ë³´ ì…ë ¥</div></div><div class="scb">
<div class="ig" id="insta-imgs"><div class="isl" onclick="this.querySelector('input').click()"><span style="color:var(--t3);font-size:1.4em">+</span><input type="file" accept="image/*" style="display:none" onchange="addI(this,'insta-imgs')"></div></div>
<button class="btn-o" onclick="addIS('insta-imgs')">+ ì‚¬ì§„ ì¶”ê°€</button>
<div class="fpi"><button class="fpt a" onclick="togFP(this)">âœ… ë„ì… ë¬¸êµ¬</button><div class="fpc show"><textarea class="fta" id="i-intro">ì•ˆë…•í•˜ì„¸ìš”, ë°©ì†¡ì¤‘ê³„ ì „ë¬¸ ê¸°ì—…ì…ë‹ˆë‹¤! ğŸ¬ğŸ“¡</textarea></div></div>
<div class="fpi"><button class="fpt a" onclick="togFP(this)">âœ… ë§ˆë¬´ë¦¬ ë¬¸êµ¬</button><div class="fpc show"><textarea class="fta" id="i-outro">ğŸ“ ë¬¸ì˜ëŠ” DM ë˜ëŠ” ì „í™”ë¡œ!\nğŸ”— í”„ë¡œí•„ ë§í¬ì—ì„œ ìì„¸í•œ ì •ë³´ í™•ì¸</textarea></div></div>
<div class="mlbl">ìº¡ì…˜ ë‚´ìš©</div><textarea class="mi" id="i-content" placeholder="ìº¡ì…˜ì— í¬í•¨í•  ë‚´ìš©..."></textarea>
<div class="mlbl">í•´ì‹œíƒœê·¸ ì¹´í…Œê³ ë¦¬</div>
<div class="ad-plats" id="i-htag">
<button class="ad-plat a" data-tags="#ë°©ì†¡ì¤‘ê³„ #LEDì „ê´‘íŒ #ì´ë²¤íŠ¸ì˜ìƒ #í–‰ì‚¬ì´¬ì˜" onclick="this.classList.toggle('a')">ë°©ì†¡ì¤‘ê³„</button>
<button class="ad-plat" data-tags="#LEDìŠ¤í¬ë¦° #ì „ê´‘íŒë Œíƒˆ #ì´ë²¤íŠ¸ #ë¬´ëŒ€ì—°ì¶œ" onclick="this.classList.toggle('a')">LEDì¥ë¹„</button>
<button class="ad-plat" data-tags="#ê¸°ì—…í–‰ì‚¬ #ì»¨í¼ëŸ°ìŠ¤ #ì„¸ë¯¸ë‚˜ #ì „ì‹œíšŒ" onclick="this.classList.toggle('a')">í–‰ì‚¬</button>
</div>
<div class="bg"><button class="btn-p full" onclick="ist(1)">ë‹¤ìŒ â†’ A/B ìº¡ì…˜ ìƒì„±</button></div>
</div></div></div>
<div class="sc-body" id="is1">
<button class="btn-p full" onclick="genInsta()" id="insta-gen-btn">A/B ìº¡ì…˜ ìƒì„±</button>
<div class="ra" id="insta-ra">
<div class="ab-grid"><div class="ab-col"><span class="ab-lbl a-lbl">Aì•ˆ (ì •ë³´í˜•)</span><div class="rc" id="insta-rc-a"></div></div><div class="ab-col"><span class="ab-lbl b-lbl">Bì•ˆ (ê°ì„±í˜•)</span><div class="rc" id="insta-rc-b"></div></div></div>
<div class="sc" style="margin-top:10px"><div class="sch"><div class="sct">âš–ï¸ ë¹„êµ</div></div><div class="scb"><div class="rc" id="insta-ab-diff"></div></div></div>
<div class="bg"><button class="btn-p" onclick="pickAB('insta','a')">âœ… Aì•ˆ</button><button class="btn-p" onclick="pickAB('insta','b')" style="background:var(--b)">âœ… Bì•ˆ</button><button class="btn-o" onclick="genInsta()">ğŸ”„</button></div>
<div class="credit-bar">í¬ë ˆë”§: <span class="cv" id="insta-credit">$0.00</span> | ëˆ„ì : <span class="cv" id="insta-credit-total">$0.00</span></div>
</div></div>
<div class="sc-body" id="is2">
<div class="sc"><div class="sch"><div class="sct">ê²€ìˆ˜Â·ì™„ì„±</div></div><div class="scb">
<textarea class="mi" id="insta-edit-ta" style="min-height:120px"></textarea>
<div class="bg"><button class="ebtn" onclick="aiCheck('insta-edit-ta','spell')">ğŸ” ì˜¤íƒˆì</button><button class="ebtn" onclick="aiCheck('insta-edit-ta','improve')">âœ¨ ë‹¤ë“¬ê¸°</button></div>
<div class="bg"><button class="btn-p" onclick="copyF('insta')">ğŸ“‹ ë³µì‚¬</button><button class="btn-o" onclick="ist(1)">â† ì´ì „</button></div>
</div></div></div></div>

<!-- ==================== FB TAB ==================== -->
<div class="tab-c" id="fb-tab">
<div class="ph"><div class="pt"><span class="p-logo fbk"></span> í˜ì´ìŠ¤ë¶</div><div class="ps">A/B ê²Œì‹œë¬¼ ë¹„êµ ìƒì„±</div></div>
<div class="steps" id="fb-steps"><div class="step a" onclick="fst(0)"><span class="step-n">01</span>ì •ë³´</div><div class="step" onclick="fst(1)"><span class="step-n">02</span>A/B ìƒì„±</div><div class="step" onclick="fst(2)"><span class="step-n">03</span>ì™„ì„±</div></div>
<div class="sc-body a" id="fs0">
<div class="sc"><div class="sch"><div class="sct">ğŸ“˜ ì •ë³´ ì…ë ¥</div></div><div class="scb">
<div class="ig" id="fb-imgs"><div class="isl" onclick="this.querySelector('input').click()"><span style="color:var(--t3);font-size:1.4em">+</span><input type="file" accept="image/*" style="display:none" onchange="addI(this,'fb-imgs')"></div></div>
<div class="fpi"><button class="fpt a" onclick="togFP(this)">âœ… ë„ì… ë¬¸êµ¬</button><div class="fpc show"><textarea class="fta" id="f-intro">ë°©ì†¡ì¤‘ê³„Â·LEDì‹œìŠ¤í…œ ì „ë¬¸ ê¸°ì—…ì´ ì „í•˜ëŠ” í˜„ì¥ ì´ì•¼ê¸° ğŸ“º</textarea></div></div>
<div class="fpi"><button class="fpt a" onclick="togFP(this)">âœ… ë§ˆë¬´ë¦¬ ë¬¸êµ¬</button><div class="fpc show"><textarea class="fta" id="f-outro">ìì„¸í•œ ë¬¸ì˜ëŠ” í™ˆí˜ì´ì§€ ë˜ëŠ” ì „í™”ë¡œ ì—°ë½ì£¼ì„¸ìš”! ğŸ“</textarea></div></div>
<div class="mlbl">ê²Œì‹œë¬¼ ë‚´ìš©</div><textarea class="mi" id="f-content" placeholder="ê²Œì‹œë¬¼ ë‚´ìš©..."></textarea>
<div class="bg"><button class="btn-p full" onclick="fst(1)">A/B ìƒì„± â†’</button></div>
</div></div></div>
<div class="sc-body" id="fs1">
<button class="btn-p full" onclick="genFB()" id="fb-gen-btn">A/B ê²Œì‹œë¬¼ ìƒì„±</button>
<div class="ra" id="fb-ra">
<div class="ab-grid"><div class="ab-col"><span class="ab-lbl a-lbl">Aì•ˆ (ì •ë³´í˜•)</span><div class="rc" id="fb-rc-a"></div></div><div class="ab-col"><span class="ab-lbl b-lbl">Bì•ˆ (ê³µê°í˜•)</span><div class="rc" id="fb-rc-b"></div></div></div>
<div class="sc" style="margin-top:10px"><div class="sch"><div class="sct">âš–ï¸ ë¹„êµ</div></div><div class="scb"><div class="rc" id="fb-ab-diff"></div></div></div>
<div class="bg"><button class="btn-p" onclick="pickAB('fb','a')">âœ… Aì•ˆ</button><button class="btn-p" onclick="pickAB('fb','b')" style="background:var(--b)">âœ… Bì•ˆ</button><button class="btn-o" onclick="genFB()">ğŸ”„</button></div>
<div class="credit-bar">í¬ë ˆë”§: <span class="cv" id="fb-credit">$0.00</span> | ëˆ„ì : <span class="cv" id="fb-credit-total">$0.00</span></div>
</div></div>
<div class="sc-body" id="fs2">
<div class="sc"><div class="sch"><div class="sct">ì™„ì„±</div></div><div class="scb">
<textarea class="mi" id="fb-edit-ta" style="min-height:120px"></textarea>
<div class="bg"><button class="ebtn" onclick="aiCheck('fb-edit-ta','spell')">ğŸ” ì˜¤íƒˆì</button><button class="ebtn" onclick="aiCheck('fb-edit-ta','improve')">âœ¨ ë‹¤ë“¬ê¸°</button></div>
<div class="bg"><button class="btn-p" onclick="copyF('fb')">ğŸ“‹ ë³µì‚¬</button><button class="btn-o" onclick="fst(1)">â† ì´ì „</button></div>
</div></div></div></div>

<!-- ==================== SMART PLACE TAB ==================== -->
<div class="tab-c" id="sp-tab">
<div class="ph"><div class="pt">ğŸ“ ìŠ¤ë§ˆíŠ¸í”Œë ˆì´ìŠ¤</div><div class="ps">ë„¤ì´ë²„ í”Œë ˆì´ìŠ¤ ì„±ê³¼ ë¶„ì„ & í‚¤ì›Œë“œ ìµœì í™”</div></div>

<div class="sub-pills" id="sp-pills">
<button class="sub-pill a" onclick="setSpMode('myplace')">ğŸª ë‚´ í”Œë ˆì´ìŠ¤</button>
<button class="sub-pill" onclick="setSpMode('dashboard')">ğŸ“Š ì„±ê³¼ ëŒ€ì‹œë³´ë“œ</button>
<button class="sub-pill" onclick="setSpMode('keyword')">ğŸ”‘ í‚¤ì›Œë“œ ìµœì í™”</button>
<button class="sub-pill" onclick="setSpMode('ranking')">ğŸ† ì§€ì—­ ìˆœìœ„</button>
</div>

<!-- ===== ì„±ê³¼ ëŒ€ì‹œë³´ë“œ ===== -->
<div id="sp-dashboard" style="display:none">

<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
<div style="font-size:.95em;font-weight:600;color:var(--t2)">ğŸ“Š í”Œë ˆì´ìŠ¤ ì„±ê³¼ í˜„í™©</div>
<button class="btn-o" onclick="refreshSpDash()" id="sp-refresh-btn">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
</div>

<!-- í•µì‹¬ ì§€í‘œ -->
<div class="hero-grid">
<div class="hero-card">
<div class="hero-top"><span class="hero-label">í”Œë ˆì´ìŠ¤ ì¡°íšŒìˆ˜</span><span class="hero-icon views">ğŸ‘</span></div>
<div class="hero-val" id="sp-views">2,340</div>
<div class="hero-change up"><span class="arrow">â†‘</span> 12.4% ì „ì£¼ ëŒ€ë¹„</div>
</div>
<div class="hero-card">
<div class="hero-top"><span class="hero-label">ì „í™” ì—°ê²°</span><span class="hero-icon engage">ğŸ“</span></div>
<div class="hero-val" id="sp-calls">38</div>
<div class="hero-change up"><span class="arrow">â†‘</span> 8ê±´ ì „ì£¼ ëŒ€ë¹„</div>
</div>
</div>

<!-- ì¶”ê°€ ì§€í‘œ -->
<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:16px">
<div class="stat-card"><div class="stat-v">4.8</div><div class="stat-l">â­ í‰ì </div></div>
<div class="stat-card"><div class="stat-v">127</div><div class="stat-l">ğŸ“ ë¦¬ë·°ìˆ˜</div></div>
<div class="stat-card"><div class="stat-v">92%</div><div class="stat-l">ğŸ” ê²€ìƒ‰ ìœ ì…</div></div>
<div class="stat-card"><div class="stat-v">8%</div><div class="stat-l">ğŸ“² ì§ì ‘ ìœ ì…</div></div>
</div>

<!-- ìœ ì… ê²€ìƒ‰ì–´ -->
<div class="visual-card" style="margin-bottom:16px;height:auto">
<div class="card-header">
<span class="card-icon">ğŸ”</span>ìœ ì… ê²€ìƒ‰ì–´ TOP 10
<button class="btn-o" onclick="refreshSpKeywords()" style="margin-left:auto">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
</div>
<div class="mlbl" style="margin-bottom:8px">ë°©ë¬¸ìë“¤ì´ ì–´ë–¤ ê²€ìƒ‰ì–´ë¡œ ë‚´ í”Œë ˆì´ìŠ¤ì— ë“¤ì–´ì™”ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤</div>
<div style="overflow-x:auto">
<table class="kw-rank-table">
<thead><tr><th>#</th><th>ê²€ìƒ‰ì–´</th><th>ìœ ì…ìˆ˜</th><th>ë¹„ìœ¨</th><th>ì „í™˜ìœ¨</th><th>ì¶”ì´</th></tr></thead>
<tbody id="sp-search-tbody"></tbody>
</table>
</div>
</div>

<!-- í–‰ë™ ë¶„ì„ (ì£¼ê°„ íŠ¸ë Œë“œ) -->
<div class="trend-card">
<div class="trend-header">
<div class="trend-title"><span>ğŸ“ˆ</span> ì£¼ê°„ í–‰ë™ ì¶”ì´</div>
<div class="trend-tabs" id="sp-trend-tabs">
<button class="trend-tab a" onclick="setSpTrend('views')">ì¡°íšŒ</button>
<button class="trend-tab" onclick="setSpTrend('calls')">ì „í™”</button>
</div>
</div>
<div class="trend-chart" id="sp-trend-chart"></div>
<div class="trend-legend">
<div class="trend-legend-item"><div class="trend-legend-dot" style="background:#03C75A"></div>ì´ë²ˆ ì£¼</div>
<div class="trend-legend-item"><div class="trend-legend-dot" style="background:var(--bg4);border:1px solid var(--t3)"></div>ì§€ë‚œ ì£¼</div>
</div>
</div>

<!-- ì „í™˜ í¼ë„ -->
<div class="visual-card" style="margin-bottom:16px;height:auto">
<div class="card-header"><span class="card-icon">ğŸ”„</span>ë°©ë¬¸ì ì „í™˜ í¼ë„</div>
<div id="sp-funnel"></div>
</div>
</div>

<!-- ===== ë‚´ í”Œë ˆì´ìŠ¤ ë¯¸ë¦¬ë³´ê¸° ===== -->
<div id="sp-myplace">

<div class="sc"><div class="sch"><div class="sct">ğŸª ë‚´ ì—…ì²´ ë“±ë¡ ì •ë³´</div><button class="btn-o" onclick="updatePlacePreview()">ë¯¸ë¦¬ë³´ê¸° ê°±ì‹ </button></div><div class="scb">
<div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
<div><div class="mlbl">ì—…ì²´ëª… *</div><input class="mi" id="mp-name" placeholder="ì˜ˆ: â—‹â—‹LEDë¯¸ë””ì–´" value="ì„¸ì¢…ë¯¸ë””ì–´"></div>
<div><div class="mlbl">ì—…ì¢… ì¹´í…Œê³ ë¦¬</div><select class="mi" id="mp-category">
<option>LEDì „ê´‘íŒ/ì˜ìƒì¥ë¹„</option><option>ê´‘ê³ ëŒ€í–‰</option><option>ì´ë²¤íŠ¸/í–‰ì‚¬</option><option>ì¸í…Œë¦¬ì–´</option><option>ITì„œë¹„ìŠ¤</option><option>ìŒì‹ì </option><option>ì¹´í˜</option><option>ë¯¸ìš©/ë·°í‹°</option><option>ë³‘ì›/ì˜ì›</option><option>í•™ì›/êµìœ¡</option><option>ê¸°íƒ€</option>
</select></div>
</div>
<div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
<div><div class="mlbl">ì „í™”ë²ˆí˜¸</div><input class="mi" id="mp-phone" placeholder="02-0000-0000" value="02-1234-5678"></div>
<div><div class="mlbl">ì˜ì—…ì‹œê°„</div><input class="mi" id="mp-hours" placeholder="09:00 - 18:00" value="09:00 - 18:00 (ì£¼ë§ íœ´ë¬´)"></div>
</div>
<div class="mlbl">ì£¼ì†Œ</div>
<input class="mi" id="mp-addr" placeholder="ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ..." value="ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123">
<div class="mlbl">ì—…ì²´ ì†Œê°œ (í•œì¤„)</div>
<input class="mi" id="mp-desc" placeholder="ìš°ë¦¬ ì—…ì²´ë¥¼ í•œì¤„ë¡œ ì„¤ëª…í•´ì£¼ì„¸ìš”" value="LEDì „ê´‘íŒ ì„¤ì¹˜Â·ë Œíƒˆ ë° ë°©ì†¡ì¤‘ê³„ ì „ë¬¸ ê¸°ì—… | 10ë…„ ê²½ë ¥">
<div class="mlbl">ì£¼ìš” ì„œë¹„ìŠ¤/ë©”ë‰´ (ì‰¼í‘œ êµ¬ë¶„)</div>
<input class="mi" id="mp-services" placeholder="LEDì „ê´‘íŒ ì„¤ì¹˜, ì „ê´‘íŒ ë Œíƒˆ, ë°©ì†¡ì¤‘ê³„" value="LEDì „ê´‘íŒ ì„¤ì¹˜, ì „ê´‘íŒ ë Œíƒˆ, ë°©ì†¡ì¤‘ê³„, ì˜ìƒì¥ë¹„ ëŒ€ì—¬">
<div class="mlbl">í‚¤ì›Œë“œ íƒœê·¸ (ì‰¼í‘œ êµ¬ë¶„)</div>
<input class="mi" id="mp-tags" placeholder="LEDì „ê´‘íŒ, ì „ê´‘íŒì„¤ì¹˜, ë°©ì†¡ì¤‘ê³„" value="LEDì „ê´‘íŒ, ì „ê´‘íŒì„¤ì¹˜, ë°©ì†¡ì¤‘ê³„, ì˜¥ì™¸ê´‘ê³ , ì˜ìƒì¥ë¹„">
<div class="mlbl">í™ˆí˜ì´ì§€ URL</div>
<input class="mi" id="mp-url" placeholder="https://..." value="https://www.sejongmedia.co.kr">
<div class="mlbl">ëŒ€í‘œ ì´ë¯¸ì§€</div>
<div class="ig" id="mp-imgs"><div class="isl" onclick="this.querySelector('input').click()"><span style="color:var(--t3);font-size:1.4em">+</span><input type="file" accept="image/*" style="display:none" onchange="addI(this,'mp-imgs')"></div></div>
<button class="btn-o" onclick="addIS('mp-imgs')" style="margin-top:4px">+ ì´ë¯¸ì§€ ì¶”ê°€</button>
</div></div>

<!-- í”Œë ˆì´ìŠ¤ ë¯¸ë¦¬ë³´ê¸° ì¹´ë“œ -->
<div style="margin-top:14px">
<div style="font-size:.9em;font-weight:600;margin-bottom:10px;display:flex;align-items:center;gap:6px;color:var(--t2)">ğŸ‘€ ë„¤ì´ë²„ í”Œë ˆì´ìŠ¤ ë¯¸ë¦¬ë³´ê¸°</div>

<div id="mp-preview" style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r3);overflow:hidden;max-width:420px">
<!-- ì´ë¯¸ì§€ ì˜ì—­ -->
<div id="mp-prev-img" style="height:180px;background:linear-gradient(135deg,var(--bg3),var(--bg4));display:flex;align-items:center;justify-content:center;color:var(--t3);font-size:.85em;border-bottom:1px solid var(--border)">
ğŸ“· ëŒ€í‘œ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
</div>

<!-- ë©”ì¸ ì •ë³´ -->
<div style="padding:16px">
<div style="display:flex;align-items:center;gap:6px;margin-bottom:4px">
<span id="mp-prev-name" style="font-size:1.15em;font-weight:700;color:var(--t1)">ì„¸ì¢…ë¯¸ë””ì–´</span>
<span style="background:#03C75A;color:#fff;padding:1px 6px;border-radius:4px;font-size:.6em;font-weight:600">í”Œë ˆì´ìŠ¤</span>
</div>
<div id="mp-prev-cat" style="font-size:.78em;color:var(--t3);margin-bottom:10px">LEDì „ê´‘íŒ/ì˜ìƒì¥ë¹„</div>

<!-- í‰ì  -->
<div style="display:flex;align-items:center;gap:6px;margin-bottom:12px">
<span style="color:#FFD700;font-size:.9em">â˜…â˜…â˜…â˜…â˜…</span>
<span style="font-size:.85em;font-weight:600;color:var(--t1)">4.8</span>
<span style="font-size:.78em;color:var(--t3)">ë°©ë¬¸ì ë¦¬ë·° 127</span>
</div>

<!-- ì •ë³´ í–‰ë“¤ -->
<div style="display:grid;gap:8px;font-size:.82em">
<div style="display:flex;align-items:center;gap:8px;color:var(--t2)">
<span style="width:20px;text-align:center;flex-shrink:0">ğŸ“</span>
<span id="mp-prev-phone">02-1234-5678</span>
</div>
<div style="display:flex;align-items:center;gap:8px;color:var(--t2)">
<span style="width:20px;text-align:center;flex-shrink:0">ğŸ•</span>
<span id="mp-prev-hours">09:00 - 18:00 (ì£¼ë§ íœ´ë¬´)</span>
</div>
<div style="display:flex;align-items:center;gap:8px;color:var(--t2)">
<span style="width:20px;text-align:center;flex-shrink:0">ğŸ“</span>
<span id="mp-prev-addr">ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123</span>
</div>
<div style="display:flex;align-items:center;gap:8px;color:var(--t2)">
<span style="width:20px;text-align:center;flex-shrink:0">ğŸŒ</span>
<span id="mp-prev-url" style="color:var(--b)">www.sejongmedia.co.kr</span>
</div>
</div>

<!-- ì†Œê°œ -->
<div style="margin-top:12px;padding:10px;background:var(--bg3);border-radius:var(--r2)">
<div style="font-size:.72em;color:var(--t3);margin-bottom:4px">ì—…ì²´ ì†Œê°œ</div>
<div id="mp-prev-desc" style="font-size:.82em;color:var(--t2);line-height:1.5">LEDì „ê´‘íŒ ì„¤ì¹˜Â·ë Œíƒˆ ë° ë°©ì†¡ì¤‘ê³„ ì „ë¬¸ ê¸°ì—… | 10ë…„ ê²½ë ¥</div>
</div>

<!-- ì„œë¹„ìŠ¤/ë©”ë‰´ -->
<div style="margin-top:10px">
<div style="font-size:.72em;color:var(--t3);margin-bottom:6px">ì£¼ìš” ì„œë¹„ìŠ¤</div>
<div id="mp-prev-services" style="display:flex;flex-wrap:wrap;gap:4px"></div>
</div>

<!-- íƒœê·¸ í‚¤ì›Œë“œ -->
<div style="margin-top:10px">
<div style="font-size:.72em;color:var(--t3);margin-bottom:6px">í‚¤ì›Œë“œ</div>
<div id="mp-prev-tags" style="display:flex;flex-wrap:wrap;gap:4px"></div>
</div>

<!-- í•˜ë‹¨ ë²„íŠ¼ -->
<div style="margin-top:14px;display:flex;gap:6px">
<div style="flex:1;padding:10px;background:#03C75A;color:#fff;text-align:center;border-radius:8px;font-size:.82em;font-weight:600;cursor:default">ğŸ“ ì „í™”í•˜ê¸°</div>
<div style="flex:1;padding:10px;background:var(--bg4);color:var(--t2);text-align:center;border-radius:8px;font-size:.82em;border:1px solid var(--border);cursor:default">ğŸ’¬ í†¡í†¡ ë¬¸ì˜</div>
</div>
</div>
</div>

<!-- AI ì§„ë‹¨ -->
<div style="margin-top:12px">
<button class="btn-p full" onclick="diagnosePlaceProfile()" id="mp-diag-btn">ğŸ¤– AI í”Œë ˆì´ìŠ¤ í”„ë¡œí•„ ì§„ë‹¨</button>
<div id="mp-diag-result" style="display:none;margin-top:10px">
<div class="tip-box" id="mp-diag-content"></div>
</div>
</div>
</div>
</div>
<div id="sp-keyword" style="display:none">

<div class="sc"><div class="sch"><div class="sct">ğŸ¢ ë‚´ ì—…ì²´ ì •ë³´</div></div><div class="scb">
<div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
<div><div class="mlbl">ì—…ì¢…</div><select class="mi" id="sp-biz-type">
<option>LEDì „ê´‘íŒ/ì˜ìƒì¥ë¹„</option><option>ì¸í…Œë¦¬ì–´</option><option>ê´‘ê³ ëŒ€í–‰</option><option>ì´ë²¤íŠ¸/í–‰ì‚¬</option><option>ITì„œë¹„ìŠ¤</option><option>ìŒì‹ì </option><option>ì¹´í˜</option><option>ë¯¸ìš©/ë·°í‹°</option><option>ë³‘ì›/ì˜ì›</option><option>í•™ì›/êµìœ¡</option><option>ê¸°íƒ€</option>
</select></div>
<div><div class="mlbl">ì§€ì—­</div><select class="mi" id="sp-biz-area">
<option>ì„œìš¸ ê°•ë‚¨êµ¬</option><option>ì„œìš¸ ì„œì´ˆêµ¬</option><option>ì„œìš¸ ë§ˆí¬êµ¬</option><option>ì„œìš¸ ì†¡íŒŒêµ¬</option><option>ì„œìš¸ ì˜ë“±í¬êµ¬</option><option>ì„œìš¸ ì¢…ë¡œêµ¬</option><option>ê²½ê¸° ì„±ë‚¨ì‹œ</option><option>ê²½ê¸° ìˆ˜ì›ì‹œ</option><option>ì¸ì²œ</option><option>ë¶€ì‚°</option><option>ëŒ€ì „</option><option>ëŒ€êµ¬</option><option>ê´‘ì£¼</option>
</select></div>
</div>
<div class="mlbl">ì—…ì²´ëª…</div>
<input class="mi" id="sp-biz-name" placeholder="ì˜ˆ: â—‹â—‹ë¯¸ë””ì–´, â—‹â—‹LED">
<div class="mlbl">ì£¼ìš” ì„œë¹„ìŠ¤/ìƒí’ˆ (ì‰¼í‘œ êµ¬ë¶„)</div>
<input class="mi" id="sp-biz-service" placeholder="ì˜ˆ: LEDì „ê´‘íŒ ì„¤ì¹˜, ë°©ì†¡ì¤‘ê³„, ì˜ìƒì¥ë¹„ ë Œíƒˆ" value="LEDì „ê´‘íŒ ì„¤ì¹˜, ë°©ì†¡ì¤‘ê³„, ì˜ìƒì¥ë¹„ ë Œíƒˆ">
<div class="mlbl">í˜„ì¬ í”Œë ˆì´ìŠ¤ì— ë“±ë¡ëœ í‚¤ì›Œë“œ</div>
<input class="mi" id="sp-biz-current-kw" placeholder="ì˜ˆ: LEDì „ê´‘íŒ, ì „ê´‘íŒì„¤ì¹˜, ë°©ì†¡ì¤‘ê³„">
<div class="mlbl">íŠ¹ì´ì‚¬í•­ / ê°•ì </div>
<input class="mi" id="sp-biz-strength" placeholder="ì˜ˆ: 10ë…„ ê²½ë ¥, 24ì‹œê°„ AS, ì „êµ­ ì¶œì¥">
<button class="btn-p full" onclick="analyzeSpKeywords()" id="sp-kw-btn" style="margin-top:4px">ğŸ¤– AI í‚¤ì›Œë“œ ìµœì í™” ë¶„ì„</button>
</div></div>

<!-- AI ë¶„ì„ ê²°ê³¼ -->
<div id="sp-kw-results" style="display:none;margin-top:14px">

<!-- ì¶”ì²œ í‚¤ì›Œë“œ -->
<div class="visual-card" style="margin-bottom:14px;height:auto">
<div class="card-header"><span class="card-icon">âœ¨</span>AI ì¶”ì²œ í‚¤ì›Œë“œ</div>
<div class="mlbl" style="margin-bottom:6px">í”Œë ˆì´ìŠ¤ì— ì¶”ê°€í•˜ë©´ ë…¸ì¶œì´ í–¥ìƒë  í‚¤ì›Œë“œì…ë‹ˆë‹¤</div>
<div id="sp-rec-keywords"></div>
</div>

<!-- í‚¤ì›Œë“œ ì „ëµ -->
<div class="visual-card" style="margin-bottom:14px;height:auto">
<div class="card-header"><span class="card-icon">ğŸ“‹</span>í‚¤ì›Œë“œ ì „ëµ ê°€ì´ë“œ</div>
<div id="sp-kw-strategy" style="font-size:.85em;color:var(--t2);line-height:1.7;white-space:pre-wrap"></div>
</div>

<!-- í˜„ì¬ vs ì¶”ì²œ ë¹„êµ -->
<div class="visual-card" style="height:auto">
<div class="card-header"><span class="card-icon">âš–ï¸</span>í˜„ì¬ í‚¤ì›Œë“œ ì§„ë‹¨</div>
<div id="sp-kw-diagnosis" style="font-size:.85em;color:var(--t2);line-height:1.7;white-space:pre-wrap"></div>
</div>
</div>
</div>

<!-- ===== ì§€ì—­ ìˆœìœ„ ===== -->
<div id="sp-ranking" style="display:none">

<div class="sc"><div class="sch"><div class="sct">ğŸ” ë‚´ ìˆœìœ„ í™•ì¸</div></div><div class="scb">
<div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px">
<div><div class="mlbl">ê²€ìƒ‰ í‚¤ì›Œë“œ</div><input class="mi" id="sp-rank-kw" placeholder="ì˜ˆ: LEDì „ê´‘íŒ ì„¤ì¹˜" style="margin-bottom:0"></div>
<div><div class="mlbl">ì§€ì—­</div><select class="mi" id="sp-rank-area" style="margin-bottom:0">
<option>ì„œìš¸ ê°•ë‚¨êµ¬</option><option>ì„œìš¸ ì„œì´ˆêµ¬</option><option>ì„œìš¸ ë§ˆí¬êµ¬</option><option>ì„œìš¸ ì†¡íŒŒêµ¬</option><option>ì„œìš¸ ì˜ë“±í¬êµ¬</option><option>ê²½ê¸° ì„±ë‚¨ì‹œ</option><option>ê²½ê¸° ìˆ˜ì›ì‹œ</option><option>ì¸ì²œ</option><option>ë¶€ì‚°</option><option>ëŒ€ì „</option>
</select></div>
<div><div class="mlbl">&nbsp;</div><button class="btn-p" onclick="checkSpRanking()" id="sp-rank-btn" style="width:100%;margin-bottom:0">ğŸ† ìˆœìœ„ ì¡°íšŒ</button></div>
</div>
</div></div>

<!-- ë‚´ ìˆœìœ„ ìš”ì•½ -->
<div id="sp-rank-summary" style="margin-top:14px">
<div class="hero-grid">
<div class="hero-card">
<div class="hero-top"><span class="hero-label">í˜„ì¬ ë‚´ ìˆœìœ„</span><span class="hero-icon views">ğŸ…</span></div>
<div class="hero-val" id="sp-my-rank" style="color:var(--ac)">â€”</div>
<div class="hero-sub" id="sp-my-rank-sub">í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ê³  ì¡°íšŒí•˜ì„¸ìš”</div>
</div>
<div class="hero-card">
<div class="hero-top"><span class="hero-label">ë™ì¼ ì§€ì—­ ì—…ì²´ ìˆ˜</span><span class="hero-icon posts">ğŸ¢</span></div>
<div class="hero-val" id="sp-total-biz">â€”</div>
<div class="hero-sub" id="sp-total-biz-sub">ê°™ì€ ì—…ì¢… ê¸°ì¤€</div>
</div>
</div>

<!-- ìˆœìœ„ í…Œì´ë¸” -->
<div class="visual-card" style="margin-bottom:14px;height:auto">
<div class="card-header"><span class="card-icon">ğŸ“Š</span>ê²€ìƒ‰ ê²°ê³¼ ìˆœìœ„ (ìƒìœ„ 10)</div>
<div style="overflow-x:auto">
<table class="kw-rank-table">
<thead><tr><th>ìˆœìœ„</th><th>ì—…ì²´ëª…</th><th>í‰ì </th><th>ë¦¬ë·°</th><th>ê°•ì </th></tr></thead>
<tbody id="sp-rank-tbody"></tbody>
</table>
</div>
</div>

<!-- AI ë¶„ì„ -->
<div id="sp-rank-analysis-box" style="display:none">
<div class="visual-card" style="height:auto">
<div class="card-header"><span class="card-icon">ğŸ’¡</span>ìˆœìœ„ ê°œì„  ì „ëµ</div>
<div id="sp-rank-analysis" style="font-size:.85em;color:var(--t2);line-height:1.7;white-space:pre-wrap"></div>
</div>
</div>

<!-- í‚¤ì›Œë“œë³„ ìˆœìœ„ ì¶”ì  -->
<div class="visual-card" style="margin-top:14px;height:auto">
<div class="card-header"><span class="card-icon">ğŸ“ˆ</span>í‚¤ì›Œë“œë³„ ìˆœìœ„ ì¶”ì </div>
<div style="overflow-x:auto">
<table class="kw-rank-table">
<thead><tr><th>í‚¤ì›Œë“œ</th><th>ì§€ì—­</th><th>í˜„ì¬ ìˆœìœ„</th><th>ë³€ë™</th><th>1ë‹¬ ì „</th><th>ëª©í‘œ</th></tr></thead>
<tbody id="sp-rank-history"></tbody>
</table>
</div>
</div>
</div>
</div>
</div>

<!-- ==================== OOH (ì˜¥ì™¸ê´‘ê³ ) TAB ==================== -->
<div class="tab-c" id="ooh-tab">
<div class="ph"><div class="pt">ğŸ“‹ ì˜¥ì™¸ê´‘ê³  ê°€ì´ë“œ</div><div class="ps">ì•¼ì™¸ì „ê´‘íŒÂ·ë²„ìŠ¤Â·íƒì‹œÂ·ì§€í•˜ì²  ë“± ì˜¥ì™¸ê´‘ê³  ì¢…í•© ë¶„ì„</div></div>
<div class="sub-pills" id="ooh-pills"><button class="sub-pill a" onclick="setOohMode('find')">ğŸ” ì˜¥ì™¸ê´‘ê³  ì°¾ê¸°</button><button class="sub-pill" onclick="setOohMode('detail')">ğŸ“Š ì„¸ë¶€ë¶„ì„í‘œ</button></div>
<div id="ooh-find"><div class="ooh-cards" id="ooh-grid"></div></div>
<div id="ooh-detail" style="display:none">
<div class="sc"><div class="sch"><div class="sct">ğŸ“Š ì˜¥ì™¸ê´‘ê³  ì „ì²´ ë¹„êµ</div></div><div class="scb"><div class="ts"><table class="dt"><thead><tr><th>ë§¤ì²´</th><th>ìœ„ì¹˜</th><th>ì˜ˆìƒë‹¨ê°€</th><th>ì›” ë…¸ì¶œ</th><th>CPM</th><th>ê°€ì„±ë¹„</th><th>ëŒ€í–‰ì‚¬</th></tr></thead><tbody id="ooh-tbody"></tbody></table></div></div></div>
<div class="sc"><div class="sch"><div class="sct">ğŸ’¡ ì˜ˆì‚°ë³„ AI ì¶”ì²œ ì¡°í•©</div></div><div class="scb">
<div class="tip-box"><b>ğŸ’¡ ì›” 500ë§Œì›:</b> ê°•ë‚¨ì—­ ì§€í•˜ì²  ìŠ¤í¬ë¦°ë„ì–´(200ë§Œ) + ë²„ìŠ¤ ë©í•‘ 2ëŒ€(160ë§Œ) + íƒì‹œ íƒ‘ë¼ì´íŠ¸ 10ëŒ€(140ë§Œ)<br>ì˜ˆìƒ ì›” 2,800ë§Œ ë…¸ì¶œ | CPM â‚©179</div>
<div class="tip-box" style="margin-top:6px"><b>ğŸ’¡ ì›” 200ë§Œì›:</b> íƒì‹œ íƒ‘ë¼ì´íŠ¸ 8ëŒ€(112ë§Œ) + í˜„ìˆ˜ë§‰ 10ê°œì†Œ(80ë§Œ)<br>ì˜ˆìƒ ì›” 650ë§Œ ë…¸ì¶œ | CPM â‚©308</div>
<div class="tip-box" style="margin-top:6px"><b>ğŸ’¡ ì›” 100ë§Œì›:</b> íƒì‹œ íƒ‘ë¼ì´íŠ¸ 5ëŒ€(70ë§Œ) + ì»¤í”¼ì°¨ 1íšŒ(30ë§Œ)<br>ì˜ˆìƒ ì›” 400ë§Œ ë…¸ì¶œ + SNS ë°”ì´ëŸ´</div>
</div></div></div>
<div id="ooh-detail-box" class="ooh-detail-box"></div>
</div>

<!-- ==================== DASHBOARD TAB ==================== -->
<div class="tab-c" id="dash-tab">
<div class="ph" style="display:flex;align-items:center;justify-content:space-between">
<div>
<div class="pt">ğŸ“Š ëŒ€ì‹œë³´ë“œ</div>
<div class="ps">SNS ì½˜í…ì¸  ì„±ê³¼ë¥¼ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</div>
</div>
<button class="btn-o" onclick="refreshDash()" id="dash-refresh-btn" style="display:flex;align-items:center;gap:4px">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
</div>

<!-- í•µì‹¬ ì§€í‘œ 2Ã—2 -->
<div class="hero-grid">
<div class="hero-card">
<div class="hero-top"><span class="hero-label">ì´ ì¡°íšŒìˆ˜</span><span class="hero-icon views">ğŸ‘</span></div>
<div class="hero-val" id="hero-views-val">12,450</div>
<div class="hero-change up" id="hero-views-change"><span class="arrow">â†‘</span> 15.3% ì „ì£¼ ëŒ€ë¹„</div>
</div>
<div class="hero-card">
<div class="hero-top"><span class="hero-label">í‰ê·  ë…¸ì¶œë¥ </span><span class="hero-icon exposure">ğŸ“Š</span></div>
<div class="hero-val" id="hero-exposure-val">8.2%</div>
<div class="hero-change up" id="hero-exposure-change"><span class="arrow">â†‘</span> 2.1% ì „ì£¼ ëŒ€ë¹„</div>
</div>
<div class="hero-card">
<div class="hero-top"><span class="hero-label">ì´ ê²Œì‹œë¬¼</span><span class="hero-icon posts">ğŸ“„</span></div>
<div class="hero-val" id="hero-posts-val">48</div>
<div class="hero-sub">ì´ë²ˆ ë‹¬</div>
</div>
<div class="hero-card">
<div class="hero-top"><span class="hero-label">í‰ê·  ì°¸ì—¬ìœ¨</span><span class="hero-icon engage">ğŸ’¬</span></div>
<div class="hero-val" id="hero-engage-val">4.7%</div>
<div class="hero-change down" id="hero-engage-change"><span class="arrow">â†“</span> 0.5% ì „ì£¼ ëŒ€ë¹„</div>
</div>
</div>

<!-- ì¡°íšŒìˆ˜ ì¶”ì´ (7ì¼) -->
<div class="trend-card">
<div class="trend-header">
<div class="trend-title"><span>ğŸ“ˆ</span> ì¡°íšŒìˆ˜ ì¶”ì´ (7ì¼)</div>
<div class="trend-tabs" id="trend-tabs">
<button class="trend-tab a" onclick="setTrendFilter('all')">ì „ì²´</button>
<button class="trend-tab" onclick="setTrendFilter('blog')">ë¸”ë¡œê·¸</button>
<button class="trend-tab" onclick="setTrendFilter('insta')">ì¸ìŠ¤íƒ€</button>
</div>
</div>
<div class="trend-chart" id="trend-chart"></div>
<div class="trend-legend">
<div class="trend-legend-item"><div class="trend-legend-dot" style="background:#3B82F6"></div>ë¸”ë¡œê·¸</div>
<div class="trend-legend-item"><div class="trend-legend-dot" style="background:var(--ac)"></div>ì¸ìŠ¤íƒ€</div>
</div>
</div>

<!-- í”Œë«í¼ë³„ ì„±ê³¼ ì¹´ë“œ -->
<div style="margin-bottom:20px">
<div style="font-size:1.05em;font-weight:600;margin-bottom:14px;display:flex;align-items:center;gap:8px">
<span>ğŸ¯</span>í”Œë«í¼ë³„ ì„±ê³¼
</div>
<div class="platform-cards" id="platform-cards"></div>
</div>

<!-- í”Œë«í¼ ë¹„êµ -->
<div class="visual-card" style="margin-bottom:16px">
<div class="card-header"><span class="card-icon">ğŸ“Š</span>í”Œë«í¼ ë¹„êµ</div>
<div id="platform-performance"></div>
</div>

<!-- ì¶”ì²œ í‚¤ì›Œë“œ & ì¸ê¸° í‚¤ì›Œë“œ -->
<div class="dash-grid">
<div class="visual-card">
<div class="card-header">
<span class="card-icon">âœ¨</span>AI ì¶”ì²œ í‚¤ì›Œë“œ
<button class="btn-o" onclick="getRecommendedKeywords()" style="margin-left:auto">ğŸ¤– AI ë¶„ì„</button>
</div>
<div class="mlbl" style="margin-bottom:6px">ìš°ë¦¬ ì—…ì¢…ì— ìµœì í™”ëœ í‚¤ì›Œë“œë¥¼ AIê°€ ë¶„ì„í•©ë‹ˆë‹¤</div>
<div class="kw-grid" id="recommended-keyword-grid"></div>
<div id="rec-kw-detail" style="display:none;margin-top:10px">
<div class="tip-box" id="rec-kw-analysis"></div>
</div>
</div>
<div class="visual-card">
<div class="card-header">
<span class="card-icon">ğŸ”¥</span>ì‹¤ì‹œê°„ ì¸ê¸° í‚¤ì›Œë“œ
<button class="btn-o" onclick="getPopularKeywords()" style="margin-left:auto">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
</div>
<div class="mlbl" style="margin-bottom:6px">ì—…ê³„ ê´€ë ¨ ì‹¤ì‹œê°„ ê²€ìƒ‰ íŠ¸ë Œë“œ</div>
<div class="kw-grid" id="popular-keyword-grid"></div>
<div id="pop-kw-detail" style="display:none;margin-top:10px">
<div class="tip-box" id="pop-kw-analysis"></div>
</div>
</div>
</div>

<!-- AI ì¸ì‚¬ì´íŠ¸ -->
<div class="insight-box">
<div class="insight-title"><span class="card-icon">ğŸ’¡</span>AI ì¸ì‚¬ì´íŠ¸</div>
<div class="insight-text" id="ai-insight">ë¶„ì„ ì¤‘...</div>
<button class="btn-p" onclick="analyzeAll()" style="margin-top:12px">ğŸ¤– ì „ì²´ ë¶„ì„ ì‹¤í–‰</button>
</div>

<!-- ê°•ì  & ì•½ì  -->
<div class="dash-grid">
<div class="visual-card">
<div class="card-header"><span class="card-icon">ğŸ’ª</span>ê°•ì </div>
<div class="strength-grid" id="strength-list"></div>
</div>
<div class="visual-card">
<div class="card-header"><span class="card-icon">âš ï¸</span>ê°œì„  í¬ì¸íŠ¸</div>
<div class="strength-grid" id="weakness-list"></div>
<div style="margin-top:12px;padding-top:12px;border-top:1px solid var(--border)">
<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
<span style="font-size:.85em;font-weight:600;color:var(--t2)">ğŸ“š ë¹„ìŠ·í•œ ê¸€ ë ˆí¼ëŸ°ìŠ¤</span>
<button class="btn-o" onclick="getReferences()" id="ref-btn">ğŸ” ë ˆí¼ëŸ°ìŠ¤ ì°¾ê¸°</button>
</div>
<div class="mlbl">ê°œì„ í•˜ê³  ì‹¶ì€ ì£¼ì œë‚˜ í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ë©´ ì°¸ê³ í•  ë§Œí•œ ì½˜í…ì¸  êµ¬ì¡°ì™€ ì „ëµì„ AIê°€ ì œì•ˆí•©ë‹ˆë‹¤</div>
<div style="display:flex;gap:6px;margin-top:6px">
<input class="mi" id="ref-keyword" placeholder="ì˜ˆ: LEDì „ê´‘íŒ ì‹œê³µì‚¬ë¡€, ì˜¥ì™¸ê´‘ê³  ì„±ê³¼" style="margin-bottom:0;flex:1">
<select class="mi" id="ref-platform" style="margin-bottom:0;width:120px">
<option value="blog">ë¸”ë¡œê·¸</option>
<option value="insta">ì¸ìŠ¤íƒ€ê·¸ë¨</option>
<option value="fb">í˜ì´ìŠ¤ë¶</option>
<option value="all">ì „ì²´</option>
</select>
</div>
<div id="ref-results" style="display:none;margin-top:10px">
<div id="ref-content"></div>
</div>
</div>
</div>
</div>

<!-- ë‚´ ì½˜í…ì¸  í‚¤ì›Œë“œ ë¶„ì„ -->
<div class="visual-card">
<div class="card-header">
<span class="card-icon">ğŸ·ï¸</span>
ë‚´ ì½˜í…ì¸  í‚¤ì›Œë“œ ë¶„ì„
<button class="btn-o" onclick="getKeywords()" style="margin-left:auto">âœ¨ AI í‚¤ì›Œë“œ ì¬ìƒì„±</button>
</div>
<div class="kw-grid" id="keyword-grid"></div>
</div>

<!-- ë‚´ ê¸€ í‚¤ì›Œë“œ ìˆœìœ„ ì¶”ì  -->
<div class="visual-card">
<div class="card-header">
<span class="card-icon">ğŸ…</span>
ë‚´ ê¸€ í‚¤ì›Œë“œ ìˆœìœ„
<div style="margin-left:auto;display:flex;gap:4px">
<button class="btn-o" onclick="checkMyRanking()">ğŸ” ìˆœìœ„ ì¡°íšŒ</button>
<button class="btn-o" onclick="addTrackKeyword()">+ í‚¤ì›Œë“œ ì¶”ê°€</button>
</div>
</div>
<div class="mlbl" style="margin-bottom:6px">ì‘ì„±í•œ ê¸€ì˜ í‚¤ì›Œë“œê°€ ê²€ìƒ‰ì—ì„œ ëª‡ ìœ„ì— ë…¸ì¶œë˜ëŠ”ì§€ ì¶”ì í•©ë‹ˆë‹¤</div>
<div style="display:flex;gap:6px;margin-bottom:10px">
<input class="mi" id="rank-kw-input" placeholder="ì¶”ì í•  í‚¤ì›Œë“œ ì…ë ¥ (ì˜ˆ: LEDì „ê´‘íŒ ì‹œê³µ)" style="margin-bottom:0;flex:1">
<select class="mi" id="rank-platform" style="margin-bottom:0;width:110px">
<option value="naver">ë„¤ì´ë²„</option>
<option value="insta">ì¸ìŠ¤íƒ€</option>
<option value="google">êµ¬ê¸€</option>
</select>
</div>
<div style="overflow-x:auto">
<table class="kw-rank-table">
<thead><tr><th>í‚¤ì›Œë“œ</th><th>í”Œë«í¼</th><th>í˜„ì¬ ìˆœìœ„</th><th>ë³€ë™</th><th>ìµœê³  ìˆœìœ„</th><th>ë…¸ì¶œ ê¸€</th></tr></thead>
<tbody id="rank-tbody"></tbody>
</table>
</div>
<div id="rank-detail" style="display:none;margin-top:10px">
<div class="tip-box" id="rank-analysis"></div>
</div>
</div>

<!-- ê²½ìŸì‚¬ ë¹„êµ -->
<div class="visual-card">
<div class="card-header"><span class="card-icon">ğŸ†</span>ê²½ìŸì‚¬ ëŒ€ë¹„ ì„±ê³¼</div>
<div id="competitor-compare"></div>
</div>

</div>

<!-- ==================== KEYWORD RESEARCH TAB ==================== -->
<div class="tab-c" id="kwresearch-tab">
<div class="ph"><div class="pt">ğŸ” í‚¤ì›Œë“œ ë¶„ì„</div><div class="ps">í‚¤ì›Œë“œë¥¼ ê²€ìƒ‰í•˜ë©´ ê²€ìƒ‰ëŸ‰Â·íŠ¸ë Œë“œÂ·ê´€ë ¨ ì½˜í…ì¸ ë¥¼ í•œëˆˆì— í™•ì¸í•©ë‹ˆë‹¤</div></div>

<!-- ê²€ìƒ‰ ë°” -->
<div class="sc"><div class="scb" style="padding:12px 14px">
<div style="display:flex;gap:6px">
<input class="mi" id="kwr-input" placeholder="ë¶„ì„í•  í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: LEDì „ê´‘íŒ ì„¤ì¹˜)" style="margin-bottom:0;flex:1;font-size:.95em" onkeydown="if(event.key==='Enter')searchKeyword()">
<button class="btn-p" onclick="searchKeyword()" id="kwr-btn" style="flex-shrink:0;padding:8px 24px">ğŸ” ë¶„ì„</button>
</div>
<div style="display:flex;gap:4px;margin-top:8px;flex-wrap:wrap" id="kwr-recent">
<span style="font-size:.82em;color:var(--t3);margin-right:4px">ìµœê·¼:</span>
</div>
</div></div>

<!-- ë¹ˆ ìƒíƒœ -->
<div id="kwr-empty" style="text-align:center;padding:50px 20px;color:var(--t3)">
<div style="font-size:3em;margin-bottom:12px">ğŸ”</div>
<div style="font-size:1em;margin-bottom:6px">í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ê³  ë¶„ì„ì„ ì‹œì‘í•˜ì„¸ìš”</div>
<div style="font-size:.88em">ê²€ìƒ‰ëŸ‰, íŠ¸ë Œë“œ, ê´€ë ¨ ê¸°ì‚¬Â·ë¸”ë¡œê·¸Â·SNS ì½˜í…ì¸ ë¥¼ AIê°€ ë¶„ì„í•©ë‹ˆë‹¤</div>
</div>

<!-- ê²°ê³¼ ì˜ì—­ -->
<div id="kwr-results" style="display:none">

<!-- ê²€ìƒ‰ëŸ‰ ì§€í‘œ -->
<div class="hero-grid" style="grid-template-columns:repeat(4,1fr)">
<div class="hero-card">
<div class="hero-top"><span class="hero-label">ì›”ê°„ ê²€ìƒ‰ëŸ‰</span><span class="hero-icon views">ğŸ“Š</span></div>
<div class="hero-val" id="kwr-volume">â€”</div>
<div class="hero-sub" id="kwr-volume-sub">ë„¤ì´ë²„+êµ¬ê¸€ í•©ì‚°</div>
</div>
<div class="hero-card">
<div class="hero-top"><span class="hero-label">ê²½ìŸ ê°•ë„</span><span class="hero-icon engage">âš”ï¸</span></div>
<div class="hero-val" id="kwr-competition">â€”</div>
<div class="hero-sub" id="kwr-comp-sub">ë†’ì„ìˆ˜ë¡ ê²½ìŸ ì¹˜ì—´</div>
</div>
<div class="hero-card">
<div class="hero-top"><span class="hero-label">ì½˜í…ì¸  ìˆ˜</span><span class="hero-icon posts">ğŸ“„</span></div>
<div class="hero-val" id="kwr-content-count">â€”</div>
<div class="hero-sub">ë¸”ë¡œê·¸+ê¸°ì‚¬+SNS</div>
</div>
<div class="hero-card">
<div class="hero-top"><span class="hero-label">íŠ¸ë Œë“œ</span><span class="hero-icon exposure">ğŸ“ˆ</span></div>
<div class="hero-val" id="kwr-trend">â€”</div>
<div class="hero-sub" id="kwr-trend-sub">ìµœê·¼ 3ê°œì›”</div>
</div>
</div>

<!-- ê²€ìƒ‰ëŸ‰ ì¶”ì´ ì°¨íŠ¸ -->
<div class="trend-card" style="margin-bottom:14px">
<div class="trend-header">
<div class="trend-title"><span>ğŸ“ˆ</span> ì›”ë³„ ê²€ìƒ‰ëŸ‰ ì¶”ì´ (12ê°œì›”)</div>
</div>
<div class="trend-chart" id="kwr-chart" style="height:160px"></div>
<div class="trend-legend">
<div class="trend-legend-item"><div class="trend-legend-dot" style="background:var(--ac)"></div>ë„¤ì´ë²„</div>
<div class="trend-legend-item"><div class="trend-legend-dot" style="background:var(--b)"></div>êµ¬ê¸€</div>
</div>
</div>

<!-- í”Œë«í¼ë³„ íƒ­ -->
<div class="sub-pills" id="kwr-plat-pills">
<button class="sub-pill a" onclick="setKwrPlat('all')">ğŸ“‹ ì „ì²´</button>
<button class="sub-pill" onclick="setKwrPlat('news')">ğŸ“° ê¸°ì‚¬Â·ë‰´ìŠ¤</button>
<button class="sub-pill" onclick="setKwrPlat('blog')">ğŸ“ ë¸”ë¡œê·¸</button>
<button class="sub-pill" onclick="setKwrPlat('sns')">ğŸ“± SNS</button>
</div>

<!-- ì½˜í…ì¸  ë¦¬ìŠ¤íŠ¸ -->
<div class="visual-card" style="height:auto;margin-bottom:14px">
<div class="card-header">
<span class="card-icon">ğŸ“‘</span>ê´€ë ¨ ì½˜í…ì¸  (<span id="kwr-list-count">0</span>ê±´)
<span id="kwr-searched-kw" style="margin-left:6px;font-size:.82em;color:var(--ac);font-weight:400"></span>
</div>
<div id="kwr-content-list"></div>
</div>

<!-- ì—°ê´€ í‚¤ì›Œë“œ -->
<div class="dash-grid">
<div class="visual-card" style="height:auto">
<div class="card-header"><span class="card-icon">ğŸ”—</span>ì—°ê´€ í‚¤ì›Œë“œ</div>
<div id="kwr-related" style="display:flex;flex-wrap:wrap;gap:6px"></div>
</div>
<div class="visual-card" style="height:auto">
<div class="card-header"><span class="card-icon">ğŸ’¡</span>AI í‚¤ì›Œë“œ ì¸ì‚¬ì´íŠ¸
<button class="btn-o" onclick="saveKw($('kwr-input').value)" style="margin-left:auto">â­ í‚¤ì›Œë“œ ì €ì¥</button>
</div>
<div id="kwr-insight" style="font-size:.88em;color:var(--t2);line-height:1.7;white-space:pre-wrap"></div>
</div>
</div>

<!-- í‚¤ì›Œë“œ ì €ì¥ -->
<div class="visual-card" style="margin-top:14px;height:auto">
<div class="card-header">
<span class="card-icon">â­</span>ì €ì¥ëœ í‚¤ì›Œë“œ (<span id="kwr-saved-count">0</span>ê°œ)
<button class="btn-o" onclick="clearSavedKw()" style="margin-left:auto">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>
</div>
<div id="kwr-saved-list"></div>
</div>

</div>
</div>

<!-- ==================== COMPARE TAB ==================== -->
<div class="tab-c" id="compare-tab">
<div class="ph"><div class="pt">âš–ï¸ ë¹„êµ ë¶„ì„</div><div class="ps">ë‚´ ì½˜í…ì¸  vs ê²½ìŸì‚¬ â€” AIê°€ ë¶„ì„</div></div>
<div class="sub-pills" id="cmp-pills">
<button class="sub-pill a" onclick="setCmpMode('dashboard')">ğŸ“Š ë¹„êµ ëŒ€ì‹œë³´ë“œ</button>
<button class="sub-pill" onclick="setCmpMode('text')">ğŸ“ ê¸€ ë¹„êµ</button>
<button class="sub-pill" onclick="setCmpMode('url')">ğŸ”— URL ë¹„êµ</button>
</div>

<!-- ë¹„êµ ëŒ€ì‹œë³´ë“œ -->
<div id="cmp-dashboard">

<!-- ë‚´ ì½˜í…ì¸  vs ê²½ìŸì‚¬ ìš”ì•½ -->
<div class="hero-grid">
<div class="hero-card">
<div class="hero-top"><span class="hero-label">ë‚´ ì½˜í…ì¸  ì ìˆ˜</span><span class="hero-icon views">ğŸ“</span></div>
<div class="hero-val" id="cmp-my-score" style="color:var(--g)">â€”</div>
<div class="hero-sub">AI ì¢…í•© í‰ê°€</div>
</div>
<div class="hero-card">
<div class="hero-top"><span class="hero-label">ê²½ìŸì‚¬ í‰ê·  ì ìˆ˜</span><span class="hero-icon engage">ğŸ¢</span></div>
<div class="hero-val" id="cmp-comp-score" style="color:var(--b)">â€”</div>
<div class="hero-sub">ì—…ê³„ í‰ê·  ê¸°ì¤€</div>
</div>
</div>

<!-- í•­ëª©ë³„ ë¹„êµ ë°” -->
<div class="visual-card" style="margin-bottom:14px;height:auto">
<div class="card-header">
<span class="card-icon">ğŸ“Š</span>í•­ëª©ë³„ ë¹„êµ
<button class="btn-o" onclick="runCmpDashboard()" style="margin-left:auto">ğŸ¤– AI ë¹„êµ ë¶„ì„</button>
</div>
<div class="mlbl" style="margin-bottom:10px">ë‚´ ì½˜í…ì¸ ì™€ ê²½ìŸì‚¬ì˜ í•­ëª©ë³„ ì ìˆ˜ë¥¼ ë¹„êµí•©ë‹ˆë‹¤. ê¸€ì„ ì…ë ¥í•˜ê³  ë¶„ì„ì„ ì‹¤í–‰í•˜ì„¸ìš”.</div>
<div id="cmp-bars"></div>
</div>

<!-- ë¹„êµ ê²°ê³¼ ìƒì„¸ -->
<div class="dash-grid">
<div class="visual-card" style="height:auto">
<div class="card-header"><span class="card-icon">ğŸ’ª</span>ìš°ì„¸ í•­ëª©</div>
<div id="cmp-strengths" style="font-size:.88em;color:var(--t2);line-height:1.7"><span style="color:var(--t3)">ë¶„ì„ ì‹¤í–‰ í›„ í‘œì‹œë©ë‹ˆë‹¤</span></div>
</div>
<div class="visual-card" style="height:auto">
<div class="card-header"><span class="card-icon">âš ï¸</span>ê°œì„  í•„ìš” í•­ëª©</div>
<div id="cmp-weaknesses" style="font-size:.88em;color:var(--t2);line-height:1.7"><span style="color:var(--t3)">ë¶„ì„ ì‹¤í–‰ í›„ í‘œì‹œë©ë‹ˆë‹¤</span></div>
</div>
</div>

<!-- AI ì „ëµ ì œì•ˆ -->
<div class="visual-card" style="margin-top:14px;height:auto">
<div class="card-header"><span class="card-icon">ğŸ’¡</span>AI ê²½ìŸ ì „ëµ ì œì•ˆ</div>
<div id="cmp-strategy" style="font-size:.88em;color:var(--t2);line-height:1.7;white-space:pre-wrap"><span style="color:var(--t3)">ë¶„ì„ ì‹¤í–‰ í›„ í‘œì‹œë©ë‹ˆë‹¤</span></div>
</div>

<!-- ë¹„êµ ì´ë ¥ -->
<div class="visual-card" style="margin-top:14px;height:auto">
<div class="card-header">
<span class="card-icon">ğŸ“š</span>ë¹„êµ ì´ë ¥ (<span id="cmp-history-count">0</span>ê±´)
<button class="btn-o" onclick="clearCmpHistory()" style="margin-left:auto">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>
</div>
<div id="cmp-history-list"><div style="text-align:center;padding:12px;color:var(--t3);font-size:.88em">ë¹„êµ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤</div></div>
</div>

</div>

<!-- ê¸€ ë¹„êµ -->
<div id="cmp-text" style="display:none">
<div class="sc"><div class="sch"><div class="sct">ë¹„êµí•  ê¸€</div></div><div class="scb">
<div class="cmp-vs"><div><div class="mlbl">ë‚´ ê¸€</div><textarea class="mi" id="cmp-a" style="min-height:120px" placeholder="ë‚´ ê¸€ ë¶™ì—¬ë„£ê¸°..."></textarea></div><div class="cmp-mid">VS</div><div><div class="mlbl">ê²½ìŸì‚¬ ê¸€</div><textarea class="mi" id="cmp-b" style="min-height:120px" placeholder="ê²½ìŸì‚¬ ê¸€..."></textarea></div></div>
<button class="btn-p full" onclick="doCompare()" id="cmp-btn" style="margin-top:10px">AI ë¹„êµ ë¶„ì„ ì‹¤í–‰</button>
</div></div>
<div class="ra" id="cmp-ra"><div class="sc"><div class="sch"><div class="sct">ğŸ¤– ë¶„ì„ ê²°ê³¼</div></div><div class="scb"><div class="rc" id="cmp-rc" style="max-height:400px"></div></div></div></div>
</div>

<!-- URL ë¹„êµ -->
<div id="cmp-url" style="display:none">
<div class="sc"><div class="sch"><div class="sct">URL ë¹„êµ</div></div><div class="scb">
<div class="cmp-vs"><div><div class="mlbl">ë‚´ ê¸€ URL</div><input class="mi" id="cmp-url-a" placeholder="https://blog.naver.com/..."><div class="mlbl">ë‚´ìš© ë¶™ì—¬ë„£ê¸°</div><textarea class="mi" id="cmp-url-at" style="min-height:80px" placeholder="ê¸€ ë‚´ìš© ë¶™ì—¬ë„£ê¸°..."></textarea></div><div class="cmp-mid">VS</div><div><div class="mlbl">ê²½ìŸì‚¬ URL</div><input class="mi" id="cmp-url-b" placeholder="https://..."><div class="mlbl">ë‚´ìš© ë¶™ì—¬ë„£ê¸°</div><textarea class="mi" id="cmp-url-bt" style="min-height:80px" placeholder="ê¸€ ë‚´ìš© ë¶™ì—¬ë„£ê¸°..."></textarea></div></div>
<button class="btn-p full" onclick="doCompare()" style="margin-top:10px">AI ë¹„êµ ë¶„ì„ ì‹¤í–‰</button>
</div></div>
<div class="ra" id="cmp-ra2"><div class="sc"><div class="sch"><div class="sct">ğŸ¤– ë¶„ì„ ê²°ê³¼</div></div><div class="scb"><div class="rc" id="cmp-rc2" style="max-height:400px"></div></div></div></div>
</div>

</div>

<!-- ==================== AD SIMULATOR TAB ==================== -->
<div class="tab-c" id="adsim-tab">
<div class="ph"><div class="pt">ğŸ“¢ ê´‘ê³  ì‹œë®¬ë ˆì´í„°</div><div class="ps">í”Œë«í¼ë³„ ì˜ˆì‚°Â·íƒ€ê²ŸÂ·ì§€ì—­ ì„¤ì • ë° ROI ì˜ˆì¸¡</div></div>
<div class="sc"><div class="sch"><div class="sct">âš™ï¸ ê´‘ê³  ì„¤ì •</div></div><div class="scb">
<div class="mlbl">ê´‘ê³ ëª…</div><input class="mi" id="ad-name" placeholder="ì˜ˆ: 2024 LED ì‹œê³µì‚¬ë¡€ ìº í˜ì¸" value="ë°©ì†¡ì¤‘ê³„ ì„œë¹„ìŠ¤ í™ë³´">
<div class="mlbl">í”Œë«í¼</div>
<div class="ad-plats" id="ad-plats"><button class="ad-plat a" onclick="setAdPlat(this,'naver')">ë„¤ì´ë²„</button><button class="ad-plat" onclick="setAdPlat(this,'insta')">ì¸ìŠ¤íƒ€</button><button class="ad-plat" onclick="setAdPlat(this,'fb')">í˜ì´ìŠ¤ë¶</button><button class="ad-plat" onclick="setAdPlat(this,'gdn')">GDN</button></div>
<div class="mlbl">ì›” ì˜ˆì‚°: <span id="ad-budget-v">â‚©1,000,000</span></div>
<input type="range" id="ad-sl" min="100000" max="10000000" step="100000" value="1000000" oninput="updateAd()" style="width:100%;accent-color:var(--ac)">
<div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:10px">
<div><div class="mlbl">íƒ€ê²Ÿ ì—°ë ¹</div><select class="mi" id="ad-age" onchange="updateAd()"><option>ì „ì²´</option><option>20~30ëŒ€</option><option>30~40ëŒ€</option><option>40~50ëŒ€</option><option>50ëŒ€ ì´ìƒ</option></select></div>
<div><div class="mlbl">íƒ€ê²Ÿ ì„±ë³„</div><select class="mi" id="ad-gender" onchange="updateAd()"><option>ì „ì²´</option><option>ë‚¨ì„±</option><option>ì—¬ì„±</option></select></div>
<div><div class="mlbl">íƒ€ê²Ÿ ì§€ì—­</div><select class="mi" id="ad-region" onchange="updateAd()"><option>ì „êµ­</option><option>ì„œìš¸</option><option>ê²½ê¸°/ì¸ì²œ</option><option>ë¶€ì‚°/ìš¸ì‚°</option><option>ëŒ€ì „/ì¶©ë‚¨</option><option>ëŒ€êµ¬/ê²½ë¶</option><option>ê´‘ì£¼/ì „ë‚¨</option></select></div>
<div><div class="mlbl">ìº í˜ì¸ ê¸°ê°„</div><select class="mi" id="ad-period" onchange="updateAd()"><option value="1">1ê°œì›”</option><option value="3" selected>3ê°œì›”</option><option value="6">6ê°œì›”</option><option value="12">12ê°œì›”</option></select></div>
</div>
<div class="mlbl" style="margin-top:8px">ì»¤ìŠ¤í…€ í‚¤ì›Œë“œ</div><input class="mi" id="ad-kw" placeholder="íƒ€ê²Ÿ í‚¤ì›Œë“œ (ì‰¼í‘œ êµ¬ë¶„)" value="ë°©ì†¡ì¤‘ê³„, LEDì„¤ì¹˜, ì „ê´‘íŒë Œíƒˆ">
</div></div>
<div class="stat-grid" id="ad-stats" style="margin-bottom:14px"></div>
<div class="sc"><div class="sch"><div class="sct">ğŸ’° ì˜ˆìƒ ë¹„ìš© ìƒì„¸</div></div><div class="scb" id="ad-cost-detail"></div></div>
<div class="sc"><div class="sch"><div class="sct">ğŸ“Š ì˜ˆìƒ CRM í¼ë„</div></div><div class="scb" id="ad-crm"></div></div>

<!-- AI ê´‘ê³  ì¶”ì²œ -->
<div class="sc"><div class="sch"><div class="sct">ğŸ¤– AI ë§ì¶¤ ê´‘ê³  ì¶”ì²œ</div><button class="btn-o" onclick="getAdRecommend()">âœ¨ ì¶”ì²œë°›ê¸°</button></div><div class="scb">
<div class="mlbl" style="margin-bottom:6px">ì—…ì¢…Â·ì˜ˆì‚°Â·íƒ€ê²Ÿì— ë§ëŠ” ìµœì ì˜ ê´‘ê³  ì „ëµì„ AIê°€ ì¶”ì²œí•©ë‹ˆë‹¤</div>
<div id="ad-rec-result">
<div style="display:grid;gap:8px" id="ad-rec-cards"></div>
</div>
</div></div>

<div class="tip-box"><b>ğŸ’¡ AI:</b> ì˜ˆì‚° 50% ë„¤ì´ë²„, 30% ì¸ìŠ¤íƒ€ ë¦´ìŠ¤, 20% ë¦¬íƒ€ê²ŸíŒ… ë°°ë¶„ ì‹œ ìµœì  ROI.</div>
</div>

<!-- ==================== STYLE TAB ==================== -->
<div class="tab-c" id="style-tab">
<div class="ph"><div class="pt">ğŸ¨ ë¬¸ì²´ í•™ìŠµ</div><div class="ps">ê¸°ì¡´ ê¸€ì—ì„œ ë¬¸ì²´ë¥¼ í•™ìŠµí•˜ì—¬ AI ìƒì„±ì— ë°˜ì˜</div></div>
<div class="sub-pills" id="style-pills">
<button class="sub-pill a" onclick="setStyleMode('dashboard')">ğŸ“Š ë¶„ì„ ëŒ€ì‹œë³´ë“œ</button>
<button class="sub-pill" onclick="setStyleMode('paste')">ğŸ“ ê¸€ ë¶™ì—¬ë„£ê¸°</button>
<button class="sub-pill" onclick="setStyleMode('url')">ğŸ”— URL ì…ë ¥</button>
<button class="sub-pill" onclick="setStyleMode('compare')">âš–ï¸ ê¸€ ë¹„êµ</button>
</div>

<!-- ë¶„ì„ ëŒ€ì‹œë³´ë“œ -->
<div id="style-dashboard">
<div id="style-dash-empty" style="text-align:center;padding:40px 20px;color:var(--t3)">
<div style="font-size:2.5em;margin-bottom:10px">ğŸ“</div>
<div style="font-size:.95em;margin-bottom:6px">ì•„ì§ í•™ìŠµëœ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤</div>
<div style="font-size:.85em">ê¸€ì„ ë¶™ì—¬ë„£ê¸°í•˜ê³  ë¶„ì„í•˜ë©´ ë¬¸ì²´ ëŒ€ì‹œë³´ë“œê°€ ìƒì„±ë©ë‹ˆë‹¤</div>
</div>
<div id="style-dash-content" style="display:none">

<!-- ë¬¸ì²´ ì§€í‘œ ì¹´ë“œ -->
<div class="hero-grid" id="style-metrics"></div>

<!-- ë¬¸ì²´ ë ˆì´ë” ì‹œê°í™” -->
<div class="dash-grid">
<div class="visual-card" style="height:auto">
<div class="card-header"><span class="card-icon">ğŸ“Š</span>ë¬¸ì²´ ì§€í‘œ ìƒì„¸</div>
<div id="style-bars"></div>
</div>
<div class="visual-card" style="height:auto">
<div class="card-header"><span class="card-icon">ğŸ’¡</span>ë¬¸ì²´ íŠ¹ì§• ìš”ì•½</div>
<div id="style-summary" style="font-size:.88em;color:var(--t2);line-height:1.7;white-space:pre-wrap"></div>
</div>
</div>

<!-- ì €ì¥ëœ ê¸€ ëª©ë¡ -->
<div class="visual-card" style="height:auto;margin-top:14px">
<div class="card-header">
<span class="card-icon">ğŸ“š</span>í•™ìŠµëœ ê¸€ ëª©ë¡ (<span id="style-count">0</span>ê°œ)
<button class="btn-o" onclick="clearStyleTexts()" style="margin-left:auto">ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ</button>
</div>
<div id="style-saved-list"></div>
</div>
</div>
</div>

<!-- ê¸€ ë¶™ì—¬ë„£ê¸° -->
<div id="style-paste" style="display:none">
<div class="sc"><div class="sch"><div class="sct">ê¸°ì¡´ ê¸€ ë¶™ì—¬ë„£ê¸°</div></div><div class="scb">
<div class="mlbl">ê¸€ ì œëª© (ì„ íƒ)</div>
<input class="mi" id="style-title" placeholder="ì˜ˆ: ì½”ì—‘ìŠ¤ LED ì„¤ì¹˜ í›„ê¸°">
<textarea class="mi" id="style-ta" style="min-height:140px" placeholder="í‰ì†Œ ì‘ì„±í•˜ëŠ” ë¸”ë¡œê·¸ ê¸€ì´ë‚˜ SNS ê¸€ì„ ë¶™ì—¬ë„£ê¸°..."></textarea>
<button class="btn-p full" onclick="learnStyle('paste')" id="style-btn">ğŸ¤– ë¬¸ì²´ í•™ìŠµ & ì €ì¥</button>
</div></div></div>
<div id="style-url" style="display:none">
<div class="sc"><div class="sch"><div class="sct">URLë¡œ í•™ìŠµ</div></div><div class="scb">
<div class="mlbl">ë¸”ë¡œê·¸/SNS URL</div><input class="mi" id="style-url-in" placeholder="https://blog.naver.com/...">
<div class="mlbl">ê¸€ ë‚´ìš© (URLì—ì„œ ë³µì‚¬)</div><textarea class="mi" id="style-url-content" style="min-height:100px" placeholder="URLì˜ ê¸€ ë‚´ìš©ì„ ë¶™ì—¬ë„£ì–´ì£¼ì„¸ìš”..."></textarea>
<button class="btn-p full" onclick="learnStyle('url')">ğŸ¤– URL ê¸€ í•™ìŠµ & ì €ì¥</button>
</div></div></div>
<div id="style-compare" style="display:none">
<div class="sc"><div class="sch"><div class="sct">âš–ï¸ ê¸€ ë¹„êµ ë¶„ì„</div></div><div class="scb">
<div class="cmp-vs"><div><div class="mlbl">ê¸€ A</div><textarea class="mi" id="style-cmp-a" style="min-height:100px" placeholder="ì²« ë²ˆì§¸ ê¸€..."></textarea></div><div class="cmp-mid">VS</div><div><div class="mlbl">ê¸€ B</div><textarea class="mi" id="style-cmp-b" style="min-height:100px" placeholder="ë‘ ë²ˆì§¸ ê¸€..."></textarea></div></div>
<button class="btn-p full" onclick="compareStyles()">ë¬¸ì²´ ë¹„êµ ë¶„ì„</button>
</div></div></div>
<div class="ra" id="style-ra"><div class="sc"><div class="sch"><div class="sct">ğŸ¨ í•™ìŠµ ê²°ê³¼</div></div><div class="scb"><div class="rc" id="style-rc"></div></div></div></div>
</div>

<!-- ==================== MODALS ==================== -->
<div class="modal" id="m-api"><div class="modal-c">
<div class="modal-t">ğŸ”‘ API í‚¤ ì„¤ì •</div>
<input class="mi" id="api-in" type="password" placeholder="sk-ant-...">
<div class="md"><a href="https://console.anthropic.com/" target="_blank" style="color:var(--ac)">console.anthropic.com</a>ì—ì„œ ë°œê¸‰</div>
<div class="bg" style="margin-top:10px"><button class="btn-p" onclick="saveKey()">ì €ì¥</button><button class="btn-o" onclick="closeM('m-api')">ë‹«ê¸°</button></div>
<div id="api-cost-est" style="margin-top:10px;font-size:.75em;color:var(--t2)"></div>
</div></div>
<div class="modal" id="m-myinfo"><div class="modal-c">
<div class="modal-t">ğŸ‘¤ ë‚´ ì •ë³´</div>
<div class="mlbl">ë¸”ë¡œê·¸ URL</div><input class="mi" id="info-blog" placeholder="https://blog.naver.com/...">
<div class="mlbl">ì¸ìŠ¤íƒ€ê·¸ë¨</div><input class="mi" id="info-insta" placeholder="@ê³„ì •ëª…">
<div class="mlbl">í˜ì´ìŠ¤ë¶</div><input class="mi" id="info-fb" placeholder="https://facebook.com/...">
<div class="mlbl">í™ˆí˜ì´ì§€</div><input class="mi" id="info-hp" placeholder="https://...">
<div class="mlbl">ìŠ¤ë§ˆíŠ¸í”Œë ˆì´ìŠ¤</div><input class="mi" id="info-sp" placeholder="https://naver.me/...">
<div class="bg" style="margin-top:10px"><button class="btn-p" onclick="saveInfo()">ì €ì¥</button><button class="btn-o" onclick="closeM('m-myinfo')">ë‹«ê¸°</button></div>
</div></div>

</div></div>
<div class="toast" id="toast"></div>
<script>
const $=id=>document.getElementById(id);
const LS=(k,v)=>{if(v!==undefined){localStorage.setItem(k,JSON.stringify(v));return v}try{return JSON.parse(localStorage.getItem(k))}catch{return null}};

// === TABS ===
const tabs=['blog','insta','fb','sp','ooh','dash','kwresearch','compare','adsim','style'];
const tabN={blog:'ë¸”ë¡œê·¸',insta:'ì¸ìŠ¤íƒ€',fb:'í˜ì´ìŠ¤ë¶',sp:'í”Œë ˆì´ìŠ¤',ooh:'ì˜¥ì™¸ê´‘ê³ ',dash:'ëŒ€ì‹œë³´ë“œ',kwresearch:'í‚¤ì›Œë“œ',compare:'ë¹„êµ',adsim:'ê´‘ê³ ',style:'ë¬¸ì²´'};
function go(t){tabs.forEach(x=>{const el=$(x+'-tab');if(el){el.classList.remove('a');if(x===t)el.classList.add('a')}});
document.querySelectorAll('.nav-i[data-t]').forEach(b=>{b.classList.remove('a');if(b.dataset.t===t)b.classList.add('a')});
document.querySelectorAll('.mnav button').forEach(b=>{b.classList.remove('a');if(b.dataset.t===t)b.classList.add('a')});
if(t==='adsim')updateAd();if(t==='style')renderStyleDash();if(t==='compare')renderCmpHistory();}
function initMnav(){$('mnav').innerHTML=tabs.map(t=>'<button data-t="'+t+'" '+(t==='blog'?'class="a"':'')+' onclick="go(\''+t+'\')">'+tabN[t]+'</button>').join('')}

// === STEPS ===
function setSt(pre,n,total){for(let i=0;i<total;i++){const s=document.querySelectorAll('#'+pre+'-steps .step')[i];const c=$(pre.charAt(0)+'s'+i);if(!s||!c)continue;s.classList.remove('a','done');c.classList.remove('a');if(i<n)s.classList.add('done');if(i===n){s.classList.add('a');c.classList.add('a')}}}
function bst(n){setSt('blog',n,5);
if(n===3){syncEditorToTextarea();$('blog-final').textContent=getEditorText()}
if(n===4){renderBlogPreview()}}

// === ë¦¬ì¹˜ ì—ë””í„° ì‹œìŠ¤í…œ ===
// ì—ë””í„° â†” textarea ë™ê¸°í™”
function syncEditorToTextarea(){
const editor=$('blog-editor');
$('blog-edit-ta').value=getEditorText();
}
function getEditorText(){
const editor=$('blog-editor');
let text='';
editor.childNodes.forEach(node=>{
if(node.nodeType===3){text+=node.textContent;}
else if(node.tagName==='BR'){text+='\n';}
else if(node.tagName==='IMG'){text+='\n[ğŸ“· ì´ë¯¸ì§€]\n';}
else if(node.tagName==='DIV'||node.tagName==='P'){
if(node.querySelector('img')){text+='\n[ğŸ“· ì´ë¯¸ì§€]\n';}
else{text+='\n'+node.textContent;}
}else{text+=node.textContent;}
});
return text.trim();
}

// A/Bì•ˆ ì„ íƒ ì‹œ ì—ë””í„°ì— ë¡œë“œ
function loadToEditor(text){
const editor=$('blog-editor');
const lines=text.split('\n');
editor.innerHTML=lines.map(line=>{
if(!line.trim())return '<p><br></p>';
return '<p>'+line.replace(/</g,'&lt;').replace(/>/g,'&gt;')+'</p>';
}).join('');
}

// ì´ë¯¸ì§€ ì‚½ì…
function editorInsertImage(){
$('blog-inline-file').click();
}
function handleEditorImg(input){
const file=input.files[0];
if(!file)return;
const reader=new FileReader();
reader.onload=function(e){
const editor=$('blog-editor');
editor.focus();
const img=document.createElement('img');
img.src=e.target.result;
img.style.maxWidth='100%';
img.style.borderRadius='6px';
img.style.margin='10px 0';
img.style.display='block';
img.onclick=function(){
document.querySelectorAll('#blog-editor img').forEach(i=>i.classList.remove('selected'));
this.classList.toggle('selected');
};
// ì»¤ì„œ ìœ„ì¹˜ì— ì‚½ì…
const sel=window.getSelection();
if(sel.rangeCount>0&&editor.contains(sel.anchorNode)){
const range=sel.getRangeAt(0);
range.collapse(false);
const wrapper=document.createElement('div');
wrapper.appendChild(img);
wrapper.appendChild(document.createElement('br'));
range.insertNode(wrapper);
range.setStartAfter(wrapper);
range.collapse(true);
sel.removeAllRanges();
sel.addRange(range);
}else{
const wrapper=document.createElement('div');
wrapper.appendChild(img);
wrapper.appendChild(document.createElement('br'));
editor.appendChild(wrapper);
}
toast('ğŸ“· ì´ë¯¸ì§€ ì‚½ì…ë¨');
};
reader.readAsDataURL(file);
input.value='';
}

// íƒœê·¸ ì‚½ì…
function editorInsertTag(){
const editor=$('blog-editor');
editor.focus();
const tag=document.createElement('p');
tag.textContent='#ë°©ì†¡ì¤‘ê³„ #LEDì‹œìŠ¤í…œ';
tag.style.color='#03C75A';
editor.appendChild(tag);
}

// Deleteí‚¤ë¡œ ì„ íƒëœ ì´ë¯¸ì§€ ì‚­ì œ
document.addEventListener('keydown',function(e){
if(e.key==='Delete'||e.key==='Backspace'){
const sel=document.querySelector('#blog-editor img.selected');
if(sel){e.preventDefault();sel.parentElement.tagName==='DIV'?sel.parentElement.remove():sel.remove();toast('ğŸ—‘ï¸ ì´ë¯¸ì§€ ì‚­ì œë¨');}
}
});

// ë¯¸ë¦¬ë³´ê¸° ë Œë”
function renderBlogPreview(){
const editor=$('blog-editor');
const raw=getEditorText();
if(!raw){$('blog-preview-card').innerHTML='<div style="padding:40px;text-align:center;color:#aaa">ê¸€ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ê¸€ì„ ìƒì„±í•´ì£¼ì„¸ìš”.</div>';return}

// ì—ë””í„° HTMLì—ì„œ ì§ì ‘ ë¯¸ë¦¬ë³´ê¸° ìƒì„±
let previewBody='';
editor.childNodes.forEach(node=>{
if(node.nodeType===3&&node.textContent.trim()){
previewBody+='<p>'+node.textContent+'</p>';
}else if(node.tagName==='IMG'){
previewBody+='<div style="margin:16px 0"><img src="'+node.src+'" style="width:100%;border-radius:6px;display:block"></div>';
}else if(node.tagName==='DIV'||node.tagName==='P'){
const img=node.querySelector('img');
if(img){
previewBody+='<div style="margin:16px 0"><img src="'+img.src+'" style="width:100%;border-radius:6px;display:block"></div>';
}else{
const txt=node.textContent.trim();
if(!txt)return;
if(txt.match(/^#\S/))return;
if(txt.match(/^[â– â—†â–¶â—ã€]/)||txt.match(/^\d+[\.\)]/)){
const clean=txt.replace(/^[â– â—†â–¶â—]+\s*/,'').replace(/^ã€|ã€‘$/g,'');
previewBody+='<p style="font-weight:700;font-size:1.05em;color:#222;margin-top:18px;margin-bottom:8px;border-left:3px solid #03C75A;padding-left:10px">'+clean+'</p>';
}else{
previewBody+='<p>'+txt+'</p>';
}
}
}
});

// ì œëª© = ì²« í…ìŠ¤íŠ¸ ë…¸ë“œ
const lines=raw.split('\n').filter(l=>l.trim()&&!l.match(/^\[ğŸ“·/));
let title=(lines[0]||'ì œëª© ì—†ìŒ').replace(/^[\[ã€\(]?ì œëª©[\]ã€‘\)]?\s*[:ï¼š]?\s*/,'').replace(/^#\s*/,'').trim();
const tags=raw.match(/#[^\s#]+/g)||[];
const tagsHTML=tags.map(t=>'<span class="bp-tag">'+t+'</span>').join(' ');

const coverImg=document.querySelector('#blog-imgs .isl.filled img');
let coverHTML=coverImg?'<div style="max-height:300px;overflow:hidden"><img src="'+coverImg.src+'" style="width:100%;display:block"></div>':'';

const today=new Date();
const dateStr=today.getFullYear()+'.'+(today.getMonth()+1)+'.'+today.getDate()+'. '+today.getHours()+':'+String(today.getMinutes()).padStart(2,'0');
const blogName=$('info-blog').value?$('info-blog').value.split('/').pop()||'ë‚´ ë¸”ë¡œê·¸':'ë‚´ ë¸”ë¡œê·¸';

$('blog-preview-card').innerHTML=`
${coverHTML}
<div class="bp-header"><div class="bp-profile"><div class="bp-avatar">N</div><div><div class="bp-author">${blogName}</div><div class="bp-date">${dateStr}</div></div></div></div>
<div class="bp-title">${title}</div>
<div class="bp-body">${previewBody}</div>
${tags.length?'<div class="bp-tags">'+tagsHTML+'</div>':''}
<div class="bp-footer"><span>â¤ï¸ ì¢‹ì•„ìš” 0</span><span>ğŸ’¬ ëŒ“ê¸€ 0</span><span>ğŸ”— ê³µìœ </span><span>ğŸ“Œ ì €ì¥</span></div>`;
}
function ist(n){setSt('insta',n,3)}
function fst(n){setSt('fb',n,3)}

// === API ===
let apiKey=localStorage.getItem('anthropic_api_key')||'';
let totalCredits=parseFloat(localStorage.getItem('total_credits')||'0');
function updCredit(id,cost){totalCredits+=cost;localStorage.setItem('total_credits',totalCredits.toFixed(4));const e1=$(id+'-credit'),e2=$(id+'-credit-total');if(e1)e1.textContent='$'+cost.toFixed(4);if(e2)e2.textContent='$'+totalCredits.toFixed(4)}
function showM(id){$(id).classList.add('show');if(id==='m-api'){$('api-in').value=apiKey;updateApiCostEst()}if(id==='m-myinfo'){const info=LS('myinfo')||{};$('info-blog').value=info.blog||'';$('info-insta').value=info.insta||'';$('info-fb').value=info.fb||'';$('info-hp').value=info.hp||'';$('info-sp').value=info.sp||''}}
function closeM(id){$(id).classList.remove('show')}
function saveKey(){const k=$('api-in').value.trim();if(k){apiKey=k;localStorage.setItem('anthropic_api_key',k);toast('âœ… ì €ì¥ë¨');closeM('m-api')}else toast('âš ï¸ ì…ë ¥')}
function saveInfo(){const info={blog:$('info-blog').value.trim(),insta:$('info-insta').value.trim(),fb:$('info-fb').value.trim(),hp:$('info-hp').value.trim(),sp:$('info-sp').value.trim()};LS('myinfo',info);toast('âœ… ë‚´ ì •ë³´ ì €ì¥ë¨');closeM('m-myinfo')}
function toast(m){const t=$('toast');t.textContent=m;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2300)}
function updateApiCostEst(){$('api-cost-est').innerHTML='<b>ì˜ˆìƒ ë¹„ìš©:</b> A/B 1íšŒ ìƒì„± â‰ˆ $0.01 | ì›” 100íšŒ â‰ˆ $1.00<br>ëˆ„ì  ì‚¬ìš©: <b style="color:var(--ac)">$'+totalCredits.toFixed(4)+'</b>'}

// === AI CALL ===
async function callAI(prompt,img64){if(!apiKey){toast('âš ï¸ API í‚¤ ì„¤ì •');showM('m-api');return null}
const content=[];if(img64)content.push({type:'image',source:{type:'base64',media_type:'image/jpeg',data:img64}});content.push({type:'text',text:prompt});
const r=await fetch('https://api.anthropic.com/v1/messages',{method:'POST',headers:{'Content-Type':'application/json','x-api-key':apiKey,'anthropic-version':'2023-06-01','anthropic-dangerous-direct-browser-access':'true'},body:JSON.stringify({model:'claude-sonnet-4-20250514',max_tokens:2000,messages:[{role:'user',content}]})});
const d=await r.json();if(d.content&&d.content[0])return d.content[0].text;if(d.error)throw new Error(d.error.message);throw new Error('ì‘ë‹µ ì˜¤ë¥˜')}
function getStyleHint(){const p=LS('style_profile');return p?'\n\n[ì‘ì„±ì ë¬¸ì²´]\n'+p+'\nì´ ë¬¸ì²´ë¥¼ ë°˜ì˜í•˜ì—¬ ì‘ì„±.':''}

// === A/B GENERATION ===
async function genBlog(){const btn=$('blog-gen-btn');btn.disabled=true;btn.innerHTML='<span class="spinner"></span>A/Bì•ˆ ìƒì„± ì¤‘...';
const ra=$('blog-ra');ra.classList.add('show');$('blog-rc-a').textContent='Aì•ˆ ìƒì„± ì¤‘...';$('blog-rc-b').textContent='Bì•ˆ ëŒ€ê¸°...';$('blog-ab-diff').textContent='';
try{let img64=null;const fi=document.querySelector('#blog-imgs .isl.filled img');if(fi)img64=fi.src.split(',')[1];
const base='ë°©ì†¡ì¤‘ê³„Â·LEDì‹œìŠ¤í…œ ì „ë¬¸ ê¸°ì—… ë¸”ë¡œê·¸.\nëª©ì : '+$('b-purpose').value+'\ní–‰ì‚¬: '+($('b-event').value||'(ë¯¸ì…ë ¥)')+'\në‚´ìš©: '+($('b-detail').value||'(ë¯¸ì…ë ¥)')+'\nê°•ì¡°: '+($('b-highlight').value||'(ë¯¸ì…ë ¥)')+'\nSEOì œëª©, ì„œë¡ , ë³¸ë¬¸3-4ë‹¨ë½([ğŸ“· ì´ë¯¸ì§€ N]íƒœê·¸), ê²°ë¡ , í•´ì‹œíƒœê·¸7-10ê°œ'+getStyleHint();
let cost=0;
const a=await callAI(base+'\n\n[Aì•ˆ: ì „ë¬¸ì Â·ì‹ ë¢°ê° ìˆëŠ” í†¤. ë°ì´í„°ì™€ ìˆ˜ì¹˜ ì¤‘ì‹¬. ì—…ê³„ ì „ë¬¸ìš©ì–´ í™œìš©.]',img64);
$('blog-rc-a').textContent=a||'';cost+=0.004;$('blog-rc-b').textContent='Bì•ˆ ìƒì„± ì¤‘...';
const b=await callAI(base+'\n\n[Bì•ˆ: ì¹œê·¼í•˜ê³  ìƒë™ê° ìˆëŠ” í†¤. ìŠ¤í† ë¦¬í…”ë§ê³¼ í˜„ì¥ê° ì¤‘ì‹¬. ê³µê° ìœ ë„.]',img64);
$('blog-rc-b').textContent=b||'';cost+=0.004;$('blog-ab-diff').textContent='ë¹„êµ ë¶„ì„ ì¤‘...';
const diff=await callAI('ë‘ ë¸”ë¡œê·¸ ê¸€ ë¹„êµ ë¶„ì„:\n\n[Aì•ˆ]\n'+(a||'').substring(0,600)+'\n\n[Bì•ˆ]\n'+(b||'').substring(0,600)+'\n\nì•„ë˜ í˜•ì‹ìœ¼ë¡œ ë¹„êµ:\n1) SEO íš¨ê³¼ - ì–´ëŠ ì•ˆì´ ë” ë†’ì€ì§€\n2) ê°€ë…ì„± - ì–´ëŠ ìª½ì´ ì½ê¸° ì‰¬ìš´ì§€\n3) ì°¸ì—¬ ìœ ë„ë ¥ - ëŒ“ê¸€/ê³µìœ  ìœ ë„\n4) ìµœì¢… ì¶”ì²œ - A or Bì™€ ì´ìœ \n5ì¤„ ì´ë‚´.');
$('blog-ab-diff').textContent=diff||'';cost+=0.002;updCredit('blog',cost);toast('âœ… A/B ì™„ë£Œ');
}catch(e){$('blog-rc-a').textContent='ì˜¤ë¥˜: '+e.message;toast('âŒ '+e.message)}finally{btn.disabled=false;btn.innerHTML='A/B ë‘ ê°€ì§€ ì•ˆ ìƒì„±í•˜ê¸°'}}

async function genInsta(){const btn=$('insta-gen-btn');btn.disabled=true;btn.innerHTML='<span class="spinner"></span>A/B ìƒì„± ì¤‘...';
const ra=$('insta-ra');ra.classList.add('show');$('insta-rc-a').textContent='Aì•ˆ ìƒì„± ì¤‘...';$('insta-rc-b').textContent='Bì•ˆ ëŒ€ê¸°...';$('insta-ab-diff').textContent='';
try{let tags='';document.querySelectorAll('#i-htag .ad-plat.a').forEach(c=>{if(c.dataset.tags)tags+=' '+c.dataset.tags});
let img64=null;const fi=document.querySelector('#insta-imgs .isl.filled img');if(fi)img64=fi.src.split(',')[1];
const base='ì¸ìŠ¤íƒ€ê·¸ë¨ ìº¡ì…˜. ë°©ì†¡ì¤‘ê³„Â·LED ì „ë¬¸.\në„ì…: '+$('i-intro').value+'\në§ˆë¬´ë¦¬: '+$('i-outro').value+'\në‚´ìš©: '+($('i-content').value||'(ì¼ë°˜)')+'\ní•´ì‹œíƒœê·¸: '+tags+getStyleHint();
let cost=0;
const a=await callAI(base+'\n\n[Aì•ˆ: ì •ë³´í˜• - í•µì‹¬ ê°•ì¡°, ì „ë¬¸ì , ëª…í™•í•œ ì •ë³´ ì „ë‹¬. í•´ì‹œíƒœê·¸ 15-20ê°œ.]');
$('insta-rc-a').textContent=a||'';cost+=0.003;$('insta-rc-b').textContent='Bì•ˆ ìƒì„± ì¤‘...';
const b=await callAI(base+'\n\n[Bì•ˆ: ê°ì„±í˜• - ìŠ¤í† ë¦¬í…”ë§, ì´ëª¨ì§€ í’ë¶€, ê³µê° ìœ ë„. í•´ì‹œíƒœê·¸ 15-20ê°œ.]');
$('insta-rc-b').textContent=b||'';cost+=0.003;
const diff=await callAI('ì¸ìŠ¤íƒ€ ìº¡ì…˜ A/B ë¹„êµ:\n[A]'+(a||'').substring(0,400)+'\n[B]'+(b||'').substring(0,400)+'\nì°¸ì—¬ìœ¨Â·ë„ë‹¬ë¥ Â·ê°ì„± ë¹„êµ. ì–´ëŠ ìª½ì´ íš¨ìœ¨ì´ ë” ë†’ì€ì§€. 3ì¤„.');
$('insta-ab-diff').textContent=diff||'';cost+=0.001;updCredit('insta',cost);toast('âœ… ì™„ë£Œ');
}catch(e){$('insta-rc-a').textContent='ì˜¤ë¥˜: '+e.message}finally{btn.disabled=false;btn.innerHTML='A/B ìº¡ì…˜ ìƒì„±'}}

async function genFB(){const btn=$('fb-gen-btn');btn.disabled=true;btn.innerHTML='<span class="spinner"></span>A/B ìƒì„± ì¤‘...';
const ra=$('fb-ra');ra.classList.add('show');$('fb-rc-a').textContent='Aì•ˆ ìƒì„± ì¤‘...';$('fb-rc-b').textContent='Bì•ˆ ëŒ€ê¸°...';$('fb-ab-diff').textContent='';
try{let img64=null;const fi=document.querySelector('#fb-imgs .isl.filled img');if(fi)img64=fi.src.split(',')[1];
const base='í˜ì´ìŠ¤ë¶ ê²Œì‹œë¬¼. ë°©ì†¡ì¤‘ê³„Â·LED ì „ë¬¸.\në„ì…: '+$('f-intro').value+'\në§ˆë¬´ë¦¬: '+$('f-outro').value+'\në‚´ìš©: '+($('f-content').value||'(ì¼ë°˜)')+getStyleHint();
let cost=0;
const a=await callAI(base+'\n\n[Aì•ˆ: ì •ë³´í˜• + ê³µìœ ìœ ë„. ì „ë¬¸ì  í†¤. í•´ì‹œíƒœê·¸ 5-8ê°œ.]');
$('fb-rc-a').textContent=a||'';cost+=0.003;$('fb-rc-b').textContent='Bì•ˆ ìƒì„± ì¤‘...';
const b=await callAI(base+'\n\n[Bì•ˆ: ì¹œê·¼í˜• + ì°¸ì—¬ìœ ë„ ì§ˆë¬¸í˜•. ê³µê° ì¤‘ì‹¬. í•´ì‹œíƒœê·¸ 5-8ê°œ.]');
$('fb-rc-b').textContent=b||'';cost+=0.003;
const diff=await callAI('FB A/Bë¹„êµ:\n[A]'+(a||'').substring(0,400)+'\n[B]'+(b||'').substring(0,400)+'\nê³µìœ ìœ¨Â·ë„ë‹¬Â·ì°¸ì—¬ ë¹„êµ. 3ì¤„.');
$('fb-ab-diff').textContent=diff||'';cost+=0.001;updCredit('fb',cost);toast('âœ… ì™„ë£Œ');
}catch(e){$('fb-rc-a').textContent='ì˜¤ë¥˜: '+e.message}finally{btn.disabled=false;btn.innerHTML='A/B ê²Œì‹œë¬¼ ìƒì„±'}}

function pickAB(platform,choice){const src=$(platform+'-rc-'+choice).textContent;const taMap={blog:'blog-edit-ta',insta:'insta-edit-ta',fb:'fb-edit-ta'};$(taMap[platform]).value=src;if(platform==='blog'){loadToEditor(src);bst(2)}else if(platform==='insta')ist(2);else fst(2);toast('âœ… '+choice.toUpperCase()+'ì•ˆ ì„ íƒë¨')}

// === TEXT CHECK ===
async function aiCheck(taId,mode){
if(taId==='blog-edit-ta')syncEditorToTextarea();
const ta=$(taId);if(!ta.value.trim()){toast('âš ï¸ í…ìŠ¤íŠ¸ ì…ë ¥');return}
const labels={spell:'ì˜¤íƒˆì ê²€ì‚¬',sensitive:'ì˜ˆë¯¼í‘œí˜„ ê²€ì‚¬',improve:'ë‹¤ë“¬ê¸°'};toast('ğŸ” '+labels[mode]+'...');
const prompts={spell:'ì˜¤íƒˆìì™€ ë¬¸ë²• ì˜¤ë¥˜ë¥¼ ì°¾ì•„ ìˆ˜ì •í•´ì¤˜. ì›ë¬¸ ìœ ì§€í•˜ê³  ìˆ˜ì •ëœ ë¶€ë¶„ë§Œ í‘œì‹œ.',sensitive:'ì˜ˆë¯¼í•˜ê±°ë‚˜ ë…¼ë€ ì†Œì§€ í‘œí˜„ì„ ì°¾ì•„ ëŒ€ì•ˆ ì œì‹œ.',improve:'ì „ì²´ì ìœ¼ë¡œ ê°€ë…ì„±ê³¼ í’ˆì§ˆì„ ë†’ì—¬ ë‹¤ë“¬ì–´ì¤˜. ì›ë˜ ì˜ë¯¸ ìœ ì§€.'};
try{const r=await callAI(prompts[mode]+'\n\n'+ta.value);if(r){ta.value=r;if(taId==='blog-edit-ta')loadToEditor(r)}toast('âœ… ì™„ë£Œ')}catch(e){toast('âŒ '+e.message)}}
function ins(taId,text){const ta=$(taId);const s=ta.selectionStart;ta.value=ta.value.substring(0,s)+text+ta.value.substring(ta.selectionEnd);ta.selectionStart=ta.selectionEnd=s+text.length;ta.focus()}

// === COMPARE ===
let cmpHistory=LS('cmp_history')||[];

function setCmpMode(mode){
document.querySelectorAll('#cmp-pills .sub-pill').forEach(p=>p.classList.remove('a'));
event.target.classList.add('a');
$('cmp-dashboard').style.display=mode==='dashboard'?'block':'none';
$('cmp-text').style.display=mode==='text'?'block':'none';
$('cmp-url').style.display=mode==='url'?'block':'none';
}

async function doCompare(){const btn=$('cmp-btn');if(btn){btn.disabled=true;btn.innerHTML='<span class="spinner"></span>ë¶„ì„ ì¤‘...';}
const isUrl=$('cmp-url').style.display!=='none';
let textA,textB;
if(isUrl){textA=($('cmp-url-at').value||'')+'(URL: '+($('cmp-url-a').value||'')+')';textB=($('cmp-url-bt').value||'')+'(URL: '+($('cmp-url-b').value||'')+')';}else{textA=$('cmp-a').value;textB=$('cmp-b').value}
if(!textA&&!textB){toast('âš ï¸ ë‚´ìš© ì…ë ¥');if(btn){btn.disabled=false;btn.innerHTML='AI ë¹„êµ ë¶„ì„ ì‹¤í–‰';}return}
try{const r=await callAI('ì½˜í…ì¸  ë¹„êµ ë¶„ì„:\n\n[ë‚´ ê¸€]\n'+textA.substring(0,1000)+'\n\n[ê²½ìŸì‚¬]\n'+textB.substring(0,1000)+'\n\në¶„ì„: 1)í‚¤ì›Œë“œ ì „ëµ 2)ê°€ë…ì„± 3)CTA ê°•ë„ 4)SEOìµœì í™” 5)ê°œì„  ì œì•ˆ. í‘œ í˜•ì‹.');
if(isUrl&&$('cmp-rc2')){$('cmp-rc2').textContent=r;$('cmp-ra2').classList.add('show');}
else{$('cmp-rc').textContent=r;$('cmp-ra').classList.add('show');}
// ì´ë ¥ ì €ì¥
cmpHistory.unshift({date:new Date().toLocaleDateString('ko-KR'),myText:textA.substring(0,50),compText:textB.substring(0,50),result:r.substring(0,200)});
if(cmpHistory.length>10)cmpHistory=cmpHistory.slice(0,10);
LS('cmp_history',cmpHistory);
toast('âœ… ì™„ë£Œ')}catch(e){toast('âŒ '+e.message)}finally{if(btn){btn.disabled=false;btn.innerHTML='AI ë¹„êµ ë¶„ì„ ì‹¤í–‰';}}}

// ë¹„êµ ëŒ€ì‹œë³´ë“œ AI ë¶„ì„
async function runCmpDashboard(){
const myText=$('cmp-a').value||'';
const compText=$('cmp-b').value||'';
if(!myText&&!compText){toast('âš ï¸ ë¨¼ì € "ê¸€ ë¹„êµ" íƒ­ì—ì„œ ë‚´ ê¸€ê³¼ ê²½ìŸì‚¬ ê¸€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');return}
if(!apiKey){toast('âš ï¸ API í‚¤ í•„ìš”');showM('m-api');return}
toast('ğŸ¤– ë¹„êµ ë¶„ì„ ì¤‘...');
try{
const r=await callAI(`ë‚´ ê¸€ê³¼ ê²½ìŸì‚¬ ê¸€ì„ ì •ëŸ‰ì ìœ¼ë¡œ ë¹„êµ ë¶„ì„í•´ì¤˜.

[ë‚´ ê¸€]
${myText.substring(0,800)}

[ê²½ìŸì‚¬ ê¸€]
${compText.substring(0,800)}

ë°˜ë“œì‹œ ì•„ë˜ í˜•ì‹ìœ¼ë¡œ ì ìˆ˜(1~10)ë¥¼ ë‹µí•´ì¤˜:

ì¢…í•©ì ìˆ˜_ë‚´ê¸€: [ì ìˆ˜]/10
ì¢…í•©ì ìˆ˜_ê²½ìŸì‚¬: [ì ìˆ˜]/10
í‚¤ì›Œë“œìµœì í™”_ë‚´ê¸€: [ì ìˆ˜]/10
í‚¤ì›Œë“œìµœì í™”_ê²½ìŸì‚¬: [ì ìˆ˜]/10
ê°€ë…ì„±_ë‚´ê¸€: [ì ìˆ˜]/10
ê°€ë…ì„±_ê²½ìŸì‚¬: [ì ìˆ˜]/10
CTAê°•ë„_ë‚´ê¸€: [ì ìˆ˜]/10
CTAê°•ë„_ê²½ìŸì‚¬: [ì ìˆ˜]/10
SEOìµœì í™”_ë‚´ê¸€: [ì ìˆ˜]/10
SEOìµœì í™”_ê²½ìŸì‚¬: [ì ìˆ˜]/10
ë…ì°½ì„±_ë‚´ê¸€: [ì ìˆ˜]/10
ë…ì°½ì„±_ê²½ìŸì‚¬: [ì ìˆ˜]/10

---ìš°ì„¸í•­ëª©---
(ë‚´ê°€ ê²½ìŸì‚¬ë³´ë‹¤ ì˜í•œ ì  3ê°€ì§€, ê° 1ì¤„)

---ê°œì„ í•­ëª©---
(ë‚´ê°€ ê²½ìŸì‚¬ë³´ë‹¤ ë¶€ì¡±í•œ ì  3ê°€ì§€, ê° 1ì¤„)

---ì „ëµì œì•ˆ---
(ê²½ìŸì‚¬ë¥¼ ì´ê¸¸ ìˆ˜ ìˆëŠ” êµ¬ì²´ì ì¸ ì „ëµ 3ê°€ì§€, ê° 2ì¤„)`);

// ì ìˆ˜ íŒŒì‹±
const items=['í‚¤ì›Œë“œìµœì í™”','ê°€ë…ì„±','CTAê°•ë„','SEOìµœì í™”','ë…ì°½ì„±'];
const myScores={},compScores={};
let myTotal=0,compTotal=0;
const totalMatch1=r.match(/ì¢…í•©ì ìˆ˜_ë‚´ê¸€[:\s]*(\d+)/);
const totalMatch2=r.match(/ì¢…í•©ì ìˆ˜_ê²½ìŸì‚¬[:\s]*(\d+)/);
if(totalMatch1)myTotal=parseInt(totalMatch1[1]);
if(totalMatch2)compTotal=parseInt(totalMatch2[1]);

items.forEach(item=>{
const m1=r.match(new RegExp(item+'_ë‚´ê¸€[:\\s]*(\\d+)'));
const m2=r.match(new RegExp(item+'_ê²½ìŸì‚¬[:\\s]*(\\d+)'));
myScores[item]=m1?parseInt(m1[1]):5;
compScores[item]=m2?parseInt(m2[1]):5;
});

if(!myTotal)myTotal=Math.round(Object.values(myScores).reduce((a,b)=>a+b,0)/items.length);
if(!compTotal)compTotal=Math.round(Object.values(compScores).reduce((a,b)=>a+b,0)/items.length);

$('cmp-my-score').textContent=myTotal+'/10';
$('cmp-my-score').style.color=myTotal>=compTotal?'var(--g)':'var(--r)';
$('cmp-comp-score').textContent=compTotal+'/10';

// ë°” ì°¨íŠ¸
$('cmp-bars').innerHTML=items.map(item=>{
const my=myScores[item]||5;
const comp=compScores[item]||5;
const myW=my*10;const compW=comp*10;
const myColor=my>=comp?'var(--g)':'var(--r)';
return `<div style="margin-bottom:14px">
<div style="font-size:.88em;font-weight:600;color:var(--t1);margin-bottom:6px">${item}</div>
<div style="display:flex;align-items:center;gap:8px;margin-bottom:3px">
<span style="width:40px;font-size:.78em;color:var(--t3);text-align:right">ë‚´ ê¸€</span>
<div style="flex:1;background:var(--bg1);height:10px;border-radius:6px;overflow:hidden">
<div style="background:${myColor};height:100%;width:${myW}%;border-radius:6px;transition:width .6s"></div>
</div>
<span style="width:32px;font-size:.85em;font-weight:600;color:${myColor}">${my}</span>
</div>
<div style="display:flex;align-items:center;gap:8px">
<span style="width:40px;font-size:.78em;color:var(--t3);text-align:right">ê²½ìŸì‚¬</span>
<div style="flex:1;background:var(--bg1);height:10px;border-radius:6px;overflow:hidden">
<div style="background:var(--b);height:100%;width:${compW}%;border-radius:6px;transition:width .6s"></div>
</div>
<span style="width:32px;font-size:.85em;font-weight:600;color:var(--b)">${comp}</span>
</div>
</div>`;
}).join('');

// í…ìŠ¤íŠ¸ ì„¹ì…˜ íŒŒì‹±
const strengthPart=(r.split('---ìš°ì„¸í•­ëª©---')[1]||'').split('---')[0].trim();
const weakPart=(r.split('---ê°œì„ í•­ëª©---')[1]||'').split('---')[0].trim();
const strategyPart=(r.split('---ì „ëµì œì•ˆ---')[1]||'').trim();

$('cmp-strengths').innerHTML=strengthPart?strengthPart.split('\n').filter(l=>l.trim()).map(l=>
'<div style="padding:8px;background:rgba(52,211,153,.08);border-left:3px solid var(--g);border-radius:var(--r1);margin-bottom:4px">âœ… '+l.replace(/^\d+[\.\)]\s*/,'').trim()+'</div>'
).join(''):'<span style="color:var(--t3)">ë°ì´í„° ì—†ìŒ</span>';

$('cmp-weaknesses').innerHTML=weakPart?weakPart.split('\n').filter(l=>l.trim()).map(l=>
'<div style="padding:8px;background:rgba(248,113,113,.08);border-left:3px solid var(--r);border-radius:var(--r1);margin-bottom:4px">âš ï¸ '+l.replace(/^\d+[\.\)]\s*/,'').trim()+'</div>'
).join(''):'<span style="color:var(--t3)">ë°ì´í„° ì—†ìŒ</span>';

$('cmp-strategy').textContent=strategyPart||'ì „ëµ ì œì•ˆì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.';

// ì´ë ¥ ì €ì¥
cmpHistory.unshift({date:new Date().toLocaleDateString('ko-KR'),myScore:myTotal,compScore:compTotal,myText:myText.substring(0,40),compText:compText.substring(0,40)});
if(cmpHistory.length>10)cmpHistory=cmpHistory.slice(0,10);
LS('cmp_history',cmpHistory);
renderCmpHistory();
toast('âœ… ë¹„êµ ë¶„ì„ ì™„ë£Œ');
}catch(e){toast('âŒ '+e.message)}}

function renderCmpHistory(){
$('cmp-history-count').textContent=cmpHistory.length;
if(!cmpHistory.length){$('cmp-history-list').innerHTML='<div style="text-align:center;padding:12px;color:var(--t3);font-size:.88em">ë¹„êµ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤</div>';return}
$('cmp-history-list').innerHTML=cmpHistory.map((h,i)=>{
const myC=h.myScore>=h.compScore?'var(--g)':'var(--r)';
return `<div style="display:flex;align-items:center;gap:10px;padding:8px;background:var(--bg4);border-radius:var(--r1);margin-bottom:4px">
<span style="font-size:.78em;color:var(--t3);width:70px;flex-shrink:0">${h.date}</span>
<div style="flex:1;min-width:0">
<div style="font-size:.82em;color:var(--t2);overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${h.myText||'ë‚´ ê¸€'}... vs ${h.compText||'ê²½ìŸì‚¬'}...</div>
</div>
${h.myScore?`<span style="font-weight:600;color:${myC};font-size:.88em">${h.myScore}</span><span style="color:var(--t3);font-size:.78em">vs</span><span style="font-weight:600;color:var(--b);font-size:.88em">${h.compScore}</span>`:''}
</div>`;
}).join('');
}

function clearCmpHistory(){
cmpHistory=[];LS('cmp_history',[]);renderCmpHistory();toast('ğŸ—‘ï¸ ì´ë ¥ ì´ˆê¸°í™”');
}

// === OOH DATA ===
const OOH=[
{id:'led',icon:'ğŸ–¥ï¸',name:'ì•¼ì™¸ ì „ê´‘íŒ(LED)',loc:'ê°•ë‚¨ì—­, ì½”ì—‘ìŠ¤, ëª…ë™, íƒ€ì„ìŠ¤í€˜ì–´',price:'300~2,000ë§Œ/ì›”',cpm:'â‚©120~350',reach:'ì›” 500ë§Œ~3,000ë§Œ',score:4.2,agency:'ì œì¼ê¸°íš, HSì• ë“œ, ë‚˜ìŠ¤ë¯¸ë””ì–´',effect:'24ì‹œê°„ ë…¸ì¶œ, ì˜ìƒì†Œì¬, ëŒ€í˜• ì„íŒ©íŠ¸',detail:'ê°•ë‚¨ì—­ ì‚¬ê±°ë¦¬ ì›” 1,500ë§Œì› ê¸°ì¤€ ì¼ ìœ ë™ì¸êµ¬ 30ë§Œ. 15ì´ˆ/30ì´ˆ ìŠ¬ë¡¯ ìš´ì˜.'},
{id:'bus',icon:'ğŸšŒ',name:'ë²„ìŠ¤ ì™¸ë¶€ ë©í•‘',loc:'ì„œìš¸ ì‹œë‚´ë²„ìŠ¤ ì£¼ìš” ë…¸ì„ ',price:'80~180ë§Œ/ëŒ€/ì›”',cpm:'â‚©85~200',reach:'ì›” 120ë§Œ~300ë§Œ/ëŒ€',score:4.5,agency:'ëŒ€í™ê¸°íš, ì´ë…¸ì…˜, ë²„ìŠ¤ë¯¸ë””ì–´',effect:'ì´ë™í˜• ê´‘ê³ , ë„“ì€ ì»¤ë²„ë¦¬ì§€',detail:'2~3ëŒ€ ìš´ì˜ ì‹œ ë…¸ì¶œ ê·¹ëŒ€í™”. 6ê°œì›” ì´ìƒ ê³„ì•½ 20% í• ì¸.'},
{id:'taxi',icon:'ğŸš•',name:'íƒì‹œ íƒ‘ë¼ì´íŠ¸',loc:'ì„œìš¸Â·ìˆ˜ë„ê¶Œ ì „ì—­',price:'12~18ë§Œ/ëŒ€/ì›”',cpm:'â‚©50~120',reach:'ì›” 80ë§Œ~150ë§Œ/ëŒ€',score:4.8,agency:'ëª¨ë¹Œì•„ì´, íƒì‹œë¯¸ë””ì–´, T-ad',effect:'ê°€ì„±ë¹„ ìµœê³ , GPS íƒ€ê²ŸíŒ…',detail:'10ëŒ€+ ìš´ì˜ ì‹œ ë‹¨ê°€â†“. ì•¼ê°„ LED ë°œê´‘ íš¨ê³¼ ìš°ìˆ˜.'},
{id:'banner',icon:'ğŸ³ï¸',name:'í˜„ìˆ˜ë§‰',loc:'ë„ë¡œë³€, ì•„íŒŒíŠ¸ ë‹¨ì§€, ìƒê°€',price:'5~15ë§Œ/ê°œ/ì›”',cpm:'â‚©30~80',reach:'ì›” 10ë§Œ~50ë§Œ/ê°œ',score:3.8,agency:'ì§€ì—­ êµ¬ì²­ ì‹ ì²­, í˜„ìˆ˜ë§‰114',effect:'ìµœì €ê°€, ì§€ì—­ íƒ€ê²ŸíŒ… ìµœì ',detail:'ì„¤ì¹˜ ê·œì œ ì§€ì—­ë³„ ìƒì´. í’ìˆ˜í•´ íŒŒì† ë¦¬ìŠ¤í¬.'},
{id:'train',icon:'ğŸš„',name:'ê¸°ì°¨ì—­(KTX)',loc:'ì„œìš¸ì—­, ìš©ì‚°, ìˆ˜ì„œ, ëŒ€ì „ì—­',price:'200~800ë§Œ/ì›”',cpm:'â‚©150~400',reach:'ì›” 200ë§Œ~800ë§Œ',score:3.9,agency:'ì½”ë ˆì¼ìœ í†µ, ë©”íŠ¸ë¡œAD',effect:'ë¹„ì¦ˆë‹ˆìŠ¤ íƒ€ê²Ÿ, ê³ ì†Œë“ì¸µ',detail:'ì„œìš¸ì—­ ì¤‘ì•™í™€ ì›” 500ë§Œ. ì¼ ìœ ë™ 25ë§Œëª…. ì¥ê¸°ê³„ì•½ í• ì¸.'},
{id:'subway',icon:'ğŸš‡',name:'ì§€í•˜ì²  ìŠ¤í¬ë¦°ë„ì–´',loc:'2í˜¸ì„  ê°•ë‚¨Â·ì ì‹¤Â·í™ëŒ€',price:'150~500ë§Œ/ì›”',cpm:'â‚©100~250',reach:'ì›” 300ë§Œ~1,200ë§Œ',score:4.3,agency:'ì„œìš¸ë©”íŠ¸ë¡œAD, ë©”íŠ¸ë¡œë¯¸ë””ì–´',effect:'ì¶œí‡´ê·¼ ì§‘ì¤‘ ë…¸ì¶œ, ì˜ìƒ ê°€ëŠ¥',detail:'ìŠ¤í¬ë¦°ë„ì–´ LED ì˜ìƒí˜• ì›” 300ë§Œ~. 2í˜¸ì„  ê°•ë‚¨ì—­ ì›” ìœ ë™ 500ë§Œëª….'},
{id:'dooh',icon:'ğŸ“º',name:'DOOH(ë””ì§€í„¸OOH)',loc:'ì‡¼í•‘ëª°, ì—˜ë¦¬ë² ì´í„°, í¸ì˜ì ',price:'50~300ë§Œ/ì›”',cpm:'â‚©80~200',reach:'ì›” 100ë§Œ~500ë§Œ',score:4.1,agency:'í¬ì»¤ìŠ¤ë¯¸ë””ì–´, ë‚˜ìŠ¤ë¯¸ë””ì–´',effect:'ì •ë°€ íƒ€ê²ŸíŒ…, ë°˜ë³µ ë…¸ì¶œ',detail:'ì—˜ë¦¬ë² ì´í„° ìŠ¤í¬ë¦°(ì•„íŒŒíŠ¸/ì˜¤í”¼ìŠ¤) ì›” 50ë§Œ~. í¸ì˜ì  ì‚¬ì´ë‹ˆì§€ ì›” 80ë§Œ~.'},
{id:'coffee',icon:'â˜•',name:'ì»¤í”¼ì°¨(ì´ë™í˜•)',loc:'í–‰ì‚¬ì¥, ì´¬ì˜ì¥, ì˜¤í”¼ìŠ¤ ì•',price:'30~80ë§Œ/íšŒ',cpm:'â‚©500~1,500',reach:'íšŒë‹¹ 500~2,000ëª…',score:3.5,agency:'ì»¤í”¼ì°¨114, ì´ë²¤íŠ¸ì»¤í”¼',effect:'ë¸Œëœë“œ ê²½í—˜, SNS ë°”ì´ëŸ´',detail:'1íšŒì„±ì´ë‚˜ ë°”ì´ëŸ´ íš¨ê³¼. ë¡œê³  ì»µ+ë°°ë„ˆ+ì‹œìŒ íŒ¨í‚¤ì§€.'}
];
function rOOH(){let h='';OOH.forEach(o=>{h+='<div class="ooh-card" onclick="showOoh(\''+o.id+'\')"><div class="ooh-icon">'+o.icon+'</div><div class="ooh-name">'+o.name+'</div><div class="ooh-price">ğŸ’° '+o.price+'</div><div class="ooh-info">ğŸ“ '+o.loc+'<br>ğŸ‘ '+o.reach+'<br>ğŸ“Š CPM: '+o.cpm+'<br>â­ '+o.score+'/5<br>ğŸ¢ '+o.agency.split(',')[0]+'</div></div>'});$('ooh-grid').innerHTML=h}
function rOOHT(){let h='';OOH.forEach(o=>{const sc=o.score>=4.5?'green':o.score>=4?'yellow':'blue';h+='<tr onclick="showOoh(\''+o.id+'\')" style="cursor:pointer"><td>'+o.icon+' '+o.name+'</td><td>'+o.loc+'</td><td style="color:var(--ac)">'+o.price+'</td><td>'+o.reach+'</td><td>'+o.cpm+'</td><td><span class="badge '+sc+'">'+o.score+'/5</span></td><td style="font-size:.72em">'+o.agency+'</td></tr>'});$('ooh-tbody').innerHTML=h}
function showOoh(id){const o=OOH.find(x=>x.id===id);if(!o)return;const box=$('ooh-detail-box');box.classList.add('show');box.innerHTML='<div style="display:flex;align-items:center;gap:10px;margin-bottom:10px"><span style="font-size:2em">'+o.icon+'</span><div><div style="font-weight:700;font-size:1.05em">'+o.name+'</div><div style="font-size:.78em;color:var(--t2)">'+o.effect+'</div></div></div><div class="stat-grid" style="margin-bottom:10px"><div class="stat-card"><div class="stat-v">'+o.price+'</div><div class="stat-l">ì˜ˆìƒ ë‹¨ê°€</div></div><div class="stat-card"><div class="stat-v">'+o.reach+'</div><div class="stat-l">ì›” ë…¸ì¶œ</div></div><div class="stat-card"><div class="stat-v">'+o.cpm+'</div><div class="stat-l">CPM</div></div><div class="stat-card"><div class="stat-v" style="color:var(--g)">'+o.score+'/5</div><div class="stat-l">ê°€ì„±ë¹„</div></div></div><div class="tip-box"><b>ğŸ¢ ëŒ€í–‰ì‚¬:</b> '+o.agency+'<br><b>ğŸ“ ìƒì„¸:</b> '+o.detail+'</div>';box.scrollIntoView({behavior:'smooth',block:'nearest'})}
function setOohMode(mode){document.querySelectorAll('#ooh-pills .sub-pill').forEach(p=>p.classList.remove('a'));event.target.classList.add('a');$('ooh-find').style.display=mode==='find'?'block':'none';$('ooh-detail').style.display=mode==='detail'?'block':'none'}

// === AD SIMULATOR ===
let adPlat='naver';
function setAdPlat(el,p){document.querySelectorAll('#ad-plats .ad-plat').forEach(b=>b.classList.remove('a'));el.classList.add('a');adPlat=p;updateAd()}
function updateAd(){const v=parseInt($('ad-sl').value);const period=parseInt($('ad-period').value);const age=$('ad-age').value;const gender=$('ad-gender').value;const region=$('ad-region').value;const name=$('ad-name').value;
$('ad-budget-v').textContent='â‚©'+v.toLocaleString();
const P={naver:{name:'ë„¤ì´ë²„ ê²€ìƒ‰ê´‘ê³ ',cpc:850,ctr:0.035,conv:0.03},insta:{name:'ì¸ìŠ¤íƒ€ê·¸ë¨ ë¦´ìŠ¤',cpm:5500,ctr:0.02,conv:0.008},fb:{name:'í˜ì´ìŠ¤ë¶ í”¼ë“œ',cpm:4800,ctr:0.018,conv:0.007},gdn:{name:'êµ¬ê¸€ GDN',cpm:2800,ctr:0.008,conv:0.005}};
const p=P[adPlat];const regionMult=region==='ì„œìš¸'?1.3:region==='ì „êµ­'?1:0.85;
let clicks=p.cpc?Math.round(v/p.cpc*regionMult):Math.round(v/p.cpm*1000*p.ctr*regionMult);
let leads=Math.max(1,Math.round(clicks*p.conv));let cpl=Math.round(v/leads);let totalBudget=v*period;
$('ad-stats').innerHTML=['<div class="stat-card"><div class="stat-v">'+name.substring(0,12)+'</div><div class="stat-l">ê´‘ê³ ëª…</div></div>','<div class="stat-card"><div class="stat-v">â‚©'+(totalBudget/10000).toFixed(0)+'ë§Œ</div><div class="stat-l">ì´ì˜ˆì‚°('+period+'ê°œì›”)</div></div>','<div class="stat-card"><div class="stat-v">'+clicks.toLocaleString()+'</div><div class="stat-l">ì˜ˆìƒ í´ë¦­/ì›”</div></div>','<div class="stat-card"><div class="stat-v" style="color:var(--g)">'+leads+'ê±´</div><div class="stat-l">ì˜ˆìƒ ë¬¸ì˜/ì›”</div></div>'].join('');
// Cost detail
let cdH='<div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;font-size:.78em;color:var(--t2)"><div>ğŸ’° ì›”ì˜ˆì‚°<br><b style="color:var(--ac)">â‚©'+v.toLocaleString()+'</b></div><div>ğŸ–±ï¸ ì˜ˆìƒ í´ë¦­<br><b style="color:var(--b)">'+clicks.toLocaleString()+'íšŒ</b></div><div>ğŸ“ ì˜ˆìƒ ë¬¸ì˜<br><b style="color:var(--g)">'+leads+'ê±´</b></div><div>ğŸ’µ ë¬¸ì˜ë‹¹ ë¹„ìš©<br><b>â‚©'+cpl.toLocaleString()+'</b></div><div>ğŸ¯ íƒ€ê²Ÿ<br><b>'+age+' / '+gender+'</b></div><div>ğŸ“ ì§€ì—­<br><b>'+region+'</b></div></div>';
cdH+='<div class="tip-box" style="margin-top:8px"><b>ğŸ’¡ '+p.name+'</b> | '+name+'<br>'+period+'ê°œì›” ì´ â‚©'+(totalBudget/10000).toFixed(0)+'ë§Œ íˆ¬ì ì‹œ ë¬¸ì˜ ì•½ <b style="color:var(--g)">'+(leads*period)+'ê±´</b> ì˜ˆìƒ<br>ë¬¸ì˜ë‹¹ ë¹„ìš© â‚©'+cpl.toLocaleString()+' | ì˜ˆìƒ ROI <b>'+Math.round(leads*500000/v*100)+'%</b></div>';
$('ad-cost-detail').innerHTML=cdH;
// CRM Funnel
const imp=p.cpc?clicks*28:Math.round(v/p.cpm*1000);
let crm='<div style="font-size:.78em">';
const stages=[{n:'ë…¸ì¶œ',v:imp,c:'var(--t2)'},{n:'í´ë¦­',v:clicks,c:'var(--b)'},{n:'ê´€ì‹¬(í˜ì´ì§€ë·°)',v:Math.round(clicks*0.6),c:'var(--ac)'},{n:'ë¬¸ì˜',v:leads,c:'var(--g)'},{n:'ê²¬ì ìš”ì²­',v:Math.max(1,Math.round(leads*0.5)),c:'var(--g)'},{n:'ê³„ì•½',v:Math.max(1,Math.round(leads*0.15)),c:'#a855f7'}];
stages.forEach((s,i)=>{const w=Math.max(20,Math.round(s.v/imp*100));crm+='<div style="display:flex;align-items:center;gap:8px;margin-bottom:4px"><div style="width:80px;text-align:right;color:var(--t2)">'+s.n+'</div><div style="background:'+s.c+';height:22px;width:'+w+'%;border-radius:4px;opacity:0.7"></div><b style="color:'+s.c+'">'+s.v.toLocaleString()+'</b></div>'});
crm+='</div>';$('ad-crm').innerHTML=crm}

// AI ê´‘ê³  ì¶”ì²œ
async function getAdRecommend(){
if(!apiKey){toast('âš ï¸ API í‚¤ í•„ìš”');showM('m-api');return}
const budget=parseInt($('ad-sl').value);
const age=$('ad-age').value;
const gender=$('ad-gender').value;
const region=$('ad-region').value;
const kw=$('ad-kw').value||'LEDì „ê´‘íŒ, ë°©ì†¡ì¤‘ê³„';
const name=$('ad-name').value||'';
toast('ğŸ¤– ë§ì¶¤ ê´‘ê³  ë¶„ì„ ì¤‘...');
try{
const r=await callAI(`LEDì „ê´‘íŒ/ë°©ì†¡ì¤‘ê³„/ì˜ìƒì¥ë¹„ ì—…ì¢…ì˜ ê´‘ê³  ì „ëµì„ ì¶”ì²œí•´ì¤˜.

ì¡°ê±´:
- ì›” ì˜ˆì‚°: â‚©${budget.toLocaleString()}
- íƒ€ê²Ÿ: ${age} / ${gender} / ${region}
- í‚¤ì›Œë“œ: ${kw}
- ìº í˜ì¸: ${name}

ì •í™•íˆ 4ê°œì˜ ê´‘ê³ ë¥¼ ì¶”ì²œí•´ì¤˜. ê° ê´‘ê³ ëŠ” ì´ í˜•ì‹ìœ¼ë¡œ:
ê´‘ê³ ìœ í˜• | í”Œë«í¼ | ì¶”ì²œì˜ˆì‚°ë¹„ìœ¨(%) | ì˜ˆìƒ íš¨ê³¼ | ì¶”ì²œ ì´ìœ  í•œì¤„

ì˜ˆ: ê²€ìƒ‰ê´‘ê³  | ë„¤ì´ë²„ | 40% | ì›” ë¬¸ì˜ 15ê±´ ì˜ˆìƒ | êµ¬ë§¤ ì˜ë„ ë†’ì€ í‚¤ì›Œë“œ íƒ€ê²Ÿ

ë§ˆì§€ë§‰ì— "ğŸ’¡ ì¢…í•©ì „ëµ:" ìœ¼ë¡œ ì „ì²´ ì˜ˆì‚° ë°°ë¶„ ì „ëµ 2ì¤„.`);

const lines=r.split('\n').filter(l=>l.trim());
let cardsHTML='';
let strategy='';
const icons={'ê²€ìƒ‰':'ğŸ”','ë¸”ë¡œê·¸':'ğŸ“','ì¸ìŠ¤íƒ€':'ğŸ“¸','SNS':'ğŸ“±','GDN':'ğŸŒ','ë°°ë„ˆ':'ğŸ–¼ï¸','ë¦¬íƒ€ê²Ÿ':'ğŸ¯','ë¸Œëœë“œ':'â­','ì˜ìƒ':'ğŸ¬','ìœ íŠœë¸Œ':'â–¶ï¸','ì¹´ì¹´ì˜¤':'ğŸ’¬','í˜ì´ìŠ¤':'ğŸ‘¥','ë„¤ì´ë²„':'ğŸŸ¢','êµ¬ê¸€':'ğŸ”µ'};

lines.forEach(line=>{
if(line.includes('ì¢…í•©ì „ëµ')||line.includes('ğŸ’¡')){
strategy+=line.trim()+'\n';
return;
}
const p=line.split('|');
if(p.length>=4){
const type=p[0].trim().replace(/^\d+[\.\)]\s*/,'');
const platform=p[1].trim();
const budgetPct=p[2].trim();
const effect=p[3].trim();
const reason=p[4]?p[4].trim():'';
const budgetNum=parseInt(budgetPct)||25;
const budgetAmt=Math.round(budget*budgetNum/100);
let icon='ğŸ“¢';
for(const[k,v]of Object.entries(icons)){if(type.includes(k)||platform.includes(k)){icon=v;break;}}
const color=budgetNum>=40?'var(--ac)':budgetNum>=25?'var(--b)':'var(--g)';
cardsHTML+=`<div style="padding:14px;background:var(--bg4);border-radius:var(--r2);border-left:3px solid ${color}">
<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:6px">
<div style="display:flex;align-items:center;gap:6px">
<span style="font-size:1.2em">${icon}</span>
<span style="font-weight:700;color:var(--t1)">${type}</span>
<span style="font-size:.78em;color:var(--t3)">${platform}</span>
</div>
<span style="padding:2px 10px;border-radius:10px;font-size:.82em;font-weight:600;background:${color}22;color:${color}">${budgetPct}</span>
</div>
<div style="font-size:.85em;color:var(--t2);margin-bottom:4px">â‚©${budgetAmt.toLocaleString()}/ì›” Â· ${effect}</div>
${reason?`<div style="font-size:.82em;color:var(--t3)">â†’ ${reason}</div>`:''}
</div>`;
}
});

$('ad-rec-cards').innerHTML=cardsHTML||'<div style="color:var(--t3);text-align:center;padding:12px">ì¶”ì²œ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤</div>';
if(strategy.trim()){
$('ad-rec-cards').innerHTML+=`<div class="tip-box" style="margin-top:4px"><b>${strategy.trim().replace(/\n/g,'<br>')}</b></div>`;
}
toast('âœ… ê´‘ê³  ì¶”ì²œ ì™„ë£Œ');
}catch(e){toast('âŒ '+e.message)}}

// === KEYWORD RESEARCH ===
let kwrSaved=LS('kwr_saved')||[];
let kwrRecent=LS('kwr_recent')||[];
let kwrContentData=[];
let kwrCurrentPlat='all';

function renderKwrRecent(){
const el=$('kwr-recent');
if(!kwrRecent.length){el.innerHTML='<span style="font-size:.82em;color:var(--t3)">ìµœê·¼ ê²€ìƒ‰ ì—†ìŒ</span>';return}
el.innerHTML='<span style="font-size:.82em;color:var(--t3);margin-right:4px">ìµœê·¼:</span>'+kwrRecent.slice(0,5).map(k=>
`<button class="ebtn" onclick="$('kwr-input').value='${k.replace(/'/g,"\\'")}';searchKeyword()">${k}</button>`
).join('');
}

async function searchKeyword(){
const kw=$('kwr-input').value.trim();
if(!kw){toast('âš ï¸ í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');return}
if(!apiKey){toast('âš ï¸ API í‚¤ í•„ìš”');showM('m-api');return}

// ìµœê·¼ ê²€ìƒ‰ ì €ì¥
kwrRecent=kwrRecent.filter(k=>k!==kw);
kwrRecent.unshift(kw);
if(kwrRecent.length>10)kwrRecent=kwrRecent.slice(0,10);
LS('kwr_recent',kwrRecent);
renderKwrRecent();

const btn=$('kwr-btn');
btn.disabled=true;btn.innerHTML='<span class="spinner"></span>ë¶„ì„ ì¤‘...';
toast('ğŸ” "'+kw+'" í‚¤ì›Œë“œ ë¶„ì„ ì¤‘...');

try{
// 1ì°¨: ê²€ìƒ‰ëŸ‰ + íŠ¸ë Œë“œ + ì—°ê´€í‚¤ì›Œë“œ
const r1=await callAI(`"${kw}" í‚¤ì›Œë“œë¥¼ ë¶„ì„í•´ì¤˜. ì‹¤ì œì ìœ¼ë¡œ ì‹œë®¬ë ˆì´ì…˜í•´ì„œ ë‹µí•´.

ë°˜ë“œì‹œ ì•„ë˜ í˜•ì‹ ê·¸ëŒ€ë¡œ ë‹µí•´ì¤˜:

ì›”ê°„ê²€ìƒ‰ëŸ‰_ë„¤ì´ë²„: [ìˆ«ì]
ì›”ê°„ê²€ìƒ‰ëŸ‰_êµ¬ê¸€: [ìˆ«ì]
ê²½ìŸê°•ë„: [ìƒ/ì¤‘ìƒ/ì¤‘/ì¤‘í•˜/í•˜]
íŠ¸ë Œë“œ: [ìƒìŠ¹/ìœ ì§€/í•˜ë½]
íŠ¸ë Œë“œë³€í™”ìœ¨: [+/-ìˆ«ì]%

ì›”ë³„ê²€ìƒ‰ëŸ‰(ìµœê·¼12ê°œì›”,ë„¤ì´ë²„): [ìˆ«ì12ê°œ ì‰¼í‘œêµ¬ë¶„]
ì›”ë³„ê²€ìƒ‰ëŸ‰(ìµœê·¼12ê°œì›”,êµ¬ê¸€): [ìˆ«ì12ê°œ ì‰¼í‘œêµ¬ë¶„]

ì—°ê´€í‚¤ì›Œë“œ(10ê°œ): [í‚¤ì›Œë“œ|ì›”ê²€ìƒ‰ëŸ‰|ê²½ìŸë„] í˜•ì‹, í•œì¤„ì— í•˜ë‚˜

---ì¸ì‚¬ì´íŠ¸---
1) ì´ í‚¤ì›Œë“œì˜ ê²€ìƒ‰ ì˜ë„ ë¶„ì„ (ì •ë³´íƒìƒ‰/êµ¬ë§¤ì˜ë„/ë¹„êµ ë“±)
2) ì½˜í…ì¸  ì œì‘ ì‹œ ê³µëµ í¬ì¸íŠ¸
3) ì¶”ì²œ ë¡±í…Œì¼ í‚¤ì›Œë“œ 3ê°œ
4) ì‹œì¦Œë³„ íŠ¹ì´ì‚¬í•­
ê° 2ì¤„ ì´ë‚´.`);

// íŒŒì‹±
const naverVol=parseInt((r1.match(/ì›”ê°„ê²€ìƒ‰ëŸ‰_ë„¤ì´ë²„[:\s]*([\d,]+)/)||[])[1]?.replace(/,/g,''))||3200;
const googleVol=parseInt((r1.match(/ì›”ê°„ê²€ìƒ‰ëŸ‰_êµ¬ê¸€[:\s]*([\d,]+)/)||[])[1]?.replace(/,/g,''))||1800;
const totalVol=naverVol+googleVol;
const comp=(r1.match(/ê²½ìŸê°•ë„[:\s]*(ìƒ|ì¤‘ìƒ|ì¤‘|ì¤‘í•˜|í•˜)/)||[])[1]||'ì¤‘';
const trend=(r1.match(/íŠ¸ë Œë“œ[:\s]*(ìƒìŠ¹|ìœ ì§€|í•˜ë½)/)||[])[1]||'ìœ ì§€';
const trendPct=(r1.match(/íŠ¸ë Œë“œë³€í™”ìœ¨[:\s]*([+\-]?\d+)/)||[])[1]||'+5';

// ì›”ë³„ ë°ì´í„°
const naverMonths=(r1.match(/ì›”ë³„ê²€ìƒ‰ëŸ‰\(ìµœê·¼12ê°œì›”,ë„¤ì´ë²„\)[:\s]*([\d,\s]+)/)||[])[1];
const googleMonths=(r1.match(/ì›”ë³„ê²€ìƒ‰ëŸ‰\(ìµœê·¼12ê°œì›”,êµ¬ê¸€\)[:\s]*([\d,\s]+)/)||[])[1];
const nArr=naverMonths?naverMonths.split(',').map(n=>parseInt(n.trim())||0):Array.from({length:12},()=>Math.round(naverVol*(0.7+Math.random()*0.6)));
const gArr=googleMonths?googleMonths.split(',').map(n=>parseInt(n.trim())||0):Array.from({length:12},()=>Math.round(googleVol*(0.7+Math.random()*0.6)));

// ì—°ê´€ í‚¤ì›Œë“œ
const relLines=r1.split('\n').filter(l=>l.includes('|')&&!l.includes('ì›”ê°„')&&!l.includes('ì›”ë³„'));
const relKws=relLines.map(l=>{
const p=l.split('|');
if(p.length>=2){
const k=p[0].trim().replace(/^\d+[\.\)]\s*/,'');
const v=p[1].trim();
const c=p[2]?p[2].trim():'ì¤‘';
return {kw:k,vol:v,comp:c};
}
return null;
}).filter(Boolean).slice(0,10);

// ì¸ì‚¬ì´íŠ¸
const insightPart=(r1.split('---ì¸ì‚¬ì´íŠ¸---')[1]||r1.split('\n').slice(-8).join('\n')).trim();

// ì§€í‘œ ì¹´ë“œ ì—…ë°ì´íŠ¸
$('kwr-volume').textContent=totalVol.toLocaleString();
$('kwr-volume-sub').textContent='ë„¤ì´ë²„ '+naverVol.toLocaleString()+' + êµ¬ê¸€ '+googleVol.toLocaleString();
const compColor=comp.includes('ìƒ')?'var(--r)':comp==='ì¤‘'?'var(--ac)':'var(--g)';
$('kwr-competition').innerHTML='<span style="color:'+compColor+'">'+comp+'</span>';
$('kwr-trend').textContent=trend;
$('kwr-trend').style.color=trend==='ìƒìŠ¹'?'var(--g)':trend==='í•˜ë½'?'var(--r)':'var(--ac)';
$('kwr-trend-sub').textContent=trendPct+'% ë³€í™”';

// ì°¨íŠ¸
const months=['1ì›”','2ì›”','3ì›”','4ì›”','5ì›”','6ì›”','7ì›”','8ì›”','9ì›”','10ì›”','11ì›”','12ì›”'];
const now=new Date();
const startMonth=now.getMonth()+1;
const maxVal=Math.max(...nArr,...gArr);
$('kwr-chart').innerHTML=nArr.map((n,i)=>{
const g=gArr[i]||0;
const nH=Math.max(4,Math.round(n/maxVal*140));
const gH=Math.max(4,Math.round(g/maxVal*140));
const mIdx=(startMonth-12+i+12)%12;
return `<div style="flex:1;display:flex;flex-direction:column;align-items:center">
<div class="trend-bar-group">
<div class="trend-bar" style="height:${gH}px;background:var(--b)" title="êµ¬ê¸€ ${g.toLocaleString()}"></div>
<div class="trend-bar" style="height:${nH}px;background:var(--ac)" title="ë„¤ì´ë²„ ${n.toLocaleString()}"></div>
</div>
<div class="trend-day-label">${months[mIdx]}</div>
</div>`;
}).join('');

// ì—°ê´€ í‚¤ì›Œë“œ
$('kwr-related').innerHTML=relKws.map(r=>{
const cColor=r.comp.includes('ìƒ')?'var(--r)':r.comp.includes('í•˜')?'var(--g)':'var(--ac)';
return `<div style="padding:6px 12px;background:var(--bg4);border:1px solid var(--border);border-radius:20px;cursor:pointer;transition:.2s;display:flex;align-items:center;gap:6px" onclick="$('kwr-input').value='${r.kw.replace(/'/g,"\\'")}';searchKeyword()">
<span style="font-size:.88em;color:var(--t1);font-weight:500">${r.kw}</span>
<span style="font-size:.75em;color:var(--t3)">${r.vol}</span>
<span style="font-size:.65em;padding:1px 5px;border-radius:6px;background:${cColor}18;color:${cColor}">${r.comp}</span>
</div>`;
}).join('');

$('kwr-insight').textContent=insightPart;

// 2ì°¨: ê´€ë ¨ ì½˜í…ì¸ 
const r2=await callAI(`"${kw}" í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í–ˆì„ ë•Œ ë‚˜ì˜¤ëŠ” ì½˜í…ì¸ ë¥¼ ì‹œë®¬ë ˆì´ì…˜í•´ì¤˜.

ê¸°ì‚¬ 5ê°œ, ë¸”ë¡œê·¸ 5ê°œ, SNS(ì¸ìŠ¤íƒ€/í˜ì´ìŠ¤ë¶) 5ê°œ ì´ 15ê°œ.
í˜•ì‹ (í•œì¤„ì— í•˜ë‚˜):
íƒ€ì…(ê¸°ì‚¬/ë¸”ë¡œê·¸/SNS) | ì œëª© | ì¶œì²˜(ë§¤ì²´ëª…) | ì¡°íšŒìˆ˜ | ë‚ ì§œ(YYYY.MM.DD) | ìš”ì•½(20ìì´ë‚´)

ìµœì‹ ìˆœ ì •ë ¬. ì‹¤ì œì ìœ¼ë¡œ ê·¸ëŸ´ë“¯í•˜ê²Œ.`);

const contentLines=r2.split('\n').filter(l=>l.includes('|'));
kwrContentData=contentLines.map((line,i)=>{
const p=line.split('|').map(s=>s.trim());
if(p.length>=5){
const type=p[0].replace(/^\d+[\.\)]\s*/,'');
return{
type:type.includes('ê¸°ì‚¬')||type.includes('ë‰´ìŠ¤')?'news':type.includes('ë¸”ë¡œê·¸')?'blog':'sns',
title:p[1]||'',
source:p[2]||'',
views:p[3]||'',
date:p[4]||'',
desc:p[5]||''
};
}
return null;
}).filter(Boolean);

const totalContent=kwrContentData.length;
$('kwr-content-count').textContent=totalContent;
$('kwr-searched-kw').textContent='"'+kw+'"';
kwrCurrentPlat='all';
document.querySelectorAll('#kwr-plat-pills .sub-pill').forEach(p=>p.classList.remove('a'));
document.querySelectorAll('#kwr-plat-pills .sub-pill')[0].classList.add('a');
renderKwrContent();

$('kwr-empty').style.display='none';
$('kwr-results').style.display='block';
toast('âœ… "'+kw+'" ë¶„ì„ ì™„ë£Œ');
}catch(e){toast('âŒ '+e.message)}finally{
btn.disabled=false;btn.innerHTML='ğŸ” ë¶„ì„';
}}

function setKwrPlat(plat){
kwrCurrentPlat=plat;
document.querySelectorAll('#kwr-plat-pills .sub-pill').forEach(p=>p.classList.remove('a'));
event.target.classList.add('a');
renderKwrContent();
}

function renderKwrContent(){
const filtered=kwrCurrentPlat==='all'?kwrContentData:kwrContentData.filter(c=>c.type===kwrCurrentPlat);
$('kwr-list-count').textContent=filtered.length;
if(!filtered.length){$('kwr-content-list').innerHTML='<div style="text-align:center;padding:16px;color:var(--t3);font-size:.88em">ì½˜í…ì¸ ê°€ ì—†ìŠµë‹ˆë‹¤</div>';return}

const typeIcon={news:'ğŸ“°',blog:'ğŸ“',sns:'ğŸ“±'};
const typeLabel={news:'ê¸°ì‚¬',blog:'ë¸”ë¡œê·¸',sns:'SNS'};
const typeColor={news:'var(--b)',blog:'var(--g)',sns:'#a855f7'};

$('kwr-content-list').innerHTML=filtered.map((c,i)=>{
return `<div style="display:flex;align-items:center;gap:10px;padding:10px;background:var(--bg4);border-radius:var(--r2);margin-bottom:4px;border-left:3px solid ${typeColor[c.type]}">
<span style="font-size:1.2em;flex-shrink:0">${typeIcon[c.type]}</span>
<div style="flex:1;min-width:0">
<div style="display:flex;align-items:center;gap:6px;margin-bottom:2px">
<span style="font-size:.7em;padding:1px 6px;border-radius:4px;background:${typeColor[c.type]}18;color:${typeColor[c.type]};font-weight:600">${typeLabel[c.type]}</span>
<span style="font-size:.78em;color:var(--t3)">${c.source}</span>
<span style="font-size:.75em;color:var(--t3);margin-left:auto;flex-shrink:0">${c.date}</span>
</div>
<div style="font-weight:600;font-size:.88em;color:var(--t1);overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${c.title}</div>
${c.desc?'<div style="font-size:.78em;color:var(--t3);margin-top:2px">'+c.desc+'</div>':''}
</div>
<div style="text-align:right;flex-shrink:0">
<div style="font-size:.88em;font-weight:600;color:var(--ac);font-family:var(--fm)">${c.views}</div>
<div style="font-size:.7em;color:var(--t3)">ì¡°íšŒìˆ˜</div>
</div>
</div>`;
}).join('');
}

// í‚¤ì›Œë“œ ì €ì¥
function saveKw(kw){
if(kwrSaved.find(k=>k.kw===kw))return toast('ì´ë¯¸ ì €ì¥ë¨');
kwrSaved.push({kw,date:new Date().toLocaleDateString('ko-KR'),vol:$('kwr-volume').textContent});
LS('kwr_saved',kwrSaved);
renderKwrSaved();
toast('â­ ì €ì¥ë¨');
}

function renderKwrSaved(){
$('kwr-saved-count').textContent=kwrSaved.length;
if(!kwrSaved.length){$('kwr-saved-list').innerHTML='<div style="text-align:center;padding:12px;color:var(--t3);font-size:.88em">ì €ì¥ëœ í‚¤ì›Œë“œê°€ ì—†ìŠµë‹ˆë‹¤</div>';return}
$('kwr-saved-list').innerHTML=kwrSaved.map(k=>
`<div style="display:flex;align-items:center;gap:8px;padding:8px;background:var(--bg4);border-radius:var(--r1);margin-bottom:4px">
<span style="font-size:.88em;font-weight:600;color:var(--t1);flex:1;cursor:pointer" onclick="$('kwr-input').value='${k.kw.replace(/'/g,"\\'")}';searchKeyword()">${k.kw}</span>
<span style="font-size:.78em;color:var(--t3)">${k.vol||''}</span>
<span style="font-size:.78em;color:var(--t3)">${k.date}</span>
<button class="ebtn" onclick="kwrSaved=kwrSaved.filter(x=>x.kw!=='${k.kw.replace(/'/g,"\\'")}');LS('kwr_saved',kwrSaved);renderKwrSaved()" style="color:var(--r)">ì‚­ì œ</button>
</div>`
).join('');
}

function clearSavedKw(){
kwrSaved=[];LS('kwr_saved',[]);renderKwrSaved();toast('ğŸ—‘ï¸ ì´ˆê¸°í™”');
}

// === STYLE LEARNING ===
function setStyleMode(mode){
document.querySelectorAll('#style-pills .sub-pill').forEach(p=>p.classList.remove('a'));
event.target.classList.add('a');
$('style-dashboard').style.display=mode==='dashboard'?'block':'none';
$('style-paste').style.display=mode==='paste'?'block':'none';
$('style-url').style.display=mode==='url'?'block':'none';
$('style-compare').style.display=mode==='compare'?'block':'none';
if(mode==='dashboard')renderStyleDash();
}

// ì €ì¥ëœ ê¸€ & ë¶„ì„ ë°ì´í„°
let styleTexts=LS('style_texts')||[];
let styleAnalysis=LS('style_analysis')||null;

function saveStyleText(title,text,source){
const item={
id:Date.now(),
title:title||('ê¸€ '+(styleTexts.length+1)),
text:text.substring(0,2000),
source:source,
date:new Date().toLocaleDateString('ko-KR'),
charCount:text.length,
sentCount:(text.match(/[.!?ã€‚]\s/g)||[]).length+1,
wordCount:text.split(/\s+/).filter(w=>w).length
};
styleTexts.push(item);
LS('style_texts',styleTexts);
}

async function learnStyle(mode){
let text='',title='';
if(mode==='paste'){text=$('style-ta').value;title=$('style-title').value;}
else{text=$('style-url-content').value;title=$('style-url-in').value;}
if(!text.trim()){toast('âš ï¸ í…ìŠ¤íŠ¸ ì…ë ¥');return}
toast('ğŸ¨ í•™ìŠµ ì¤‘...');
try{
const r=await callAI(`ì´ ê¸€ì˜ ë¬¸ì²´ë¥¼ ì •ëŸ‰ì ìœ¼ë¡œ ë¶„ì„í•´ì¤˜:

${text.substring(0,1500)}

ë°˜ë“œì‹œ ì•„ë˜ í˜•ì‹ìœ¼ë¡œ ì ìˆ˜(1~10)ë¥¼ ë¨¼ì € ë‹µí•˜ê³ , ê·¸ ì•„ë˜ì— ë¶„ì„ ì„¤ëª…:

í†¤(ê²©ì‹ë„): [ì ìˆ˜]/10
ë¬¸ì¥ê¸¸ì´: [ì ìˆ˜]/10
ì´ëª¨ì§€ì‚¬ìš©: [ì ìˆ˜]/10
ì „ë¬¸ìš©ì–´: [ì ìˆ˜]/10
ì¹œê·¼ê°: [ì ìˆ˜]/10
ì„¤ë“ë ¥: [ì ìˆ˜]/10

---
1) í†¤: (ê²©ì‹/ë¹„ê²©ì‹ ì„¤ëª…)
2) ë¬¸ì¥ êµ¬ì¡° íŠ¹ì§•
3) ìì£¼ ì“°ëŠ” í‘œí˜„ íŒ¨í„´
4) ë…ì í˜¸ì¹­ ë°©ì‹
5) ì „ì²´ ë¬¸ì²´ í•œì¤„ ìš”ì•½`);

// ê¸€ ì €ì¥
saveStyleText(title,text,mode==='paste'?'ë¶™ì—¬ë„£ê¸°':'URL');

// ë¶„ì„ ê²°ê³¼ íŒŒì‹± & ì €ì¥
const scores={};
const scoreLines=r.split('\n').filter(l=>l.match(/[:\ï¼š]\s*\d/));
const labels=['í†¤(ê²©ì‹ë„)','ë¬¸ì¥ê¸¸ì´','ì´ëª¨ì§€ì‚¬ìš©','ì „ë¬¸ìš©ì–´','ì¹œê·¼ê°','ì„¤ë“ë ¥'];
const keys=['formality','sentLen','emoji','jargon','friendly','persuasion'];
scoreLines.forEach(line=>{
keys.forEach((k,i)=>{
if(line.includes(labels[i])||line.toLowerCase().includes(k)){
const m=line.match(/(\d+)\s*\/\s*10/);
if(m)scores[k]=parseInt(m[1]);
}
});
});
// ê¸°ë³¸ê°’ ì±„ìš°ê¸°
keys.forEach(k=>{if(!scores[k])scores[k]=5+Math.floor(Math.random()*3)});

const descPart=r.split('---')[1]||r.split('\n').slice(6).join('\n');
styleAnalysis={scores,desc:descPart.trim(),raw:r,date:new Date().toLocaleDateString('ko-KR'),textCount:styleTexts.length};
LS('style_analysis',styleAnalysis);
LS('style_profile',r);

$('style-rc').textContent=r||'';
$('style-ra').classList.add('show');
toast('âœ… ë¬¸ì²´ í•™ìŠµ ì™„ë£Œ & ì €ì¥ë¨');

// ì…ë ¥ ì´ˆê¸°í™”
if(mode==='paste'){$('style-ta').value='';$('style-title').value='';}
}catch(e){toast('âŒ '+e.message)}}

async function compareStyles(){const a=$('style-cmp-a').value,b=$('style-cmp-b').value;
if(!a||!b){toast('âš ï¸ ë‘ ê¸€ ëª¨ë‘ ì…ë ¥');return}toast('âš–ï¸ ë¹„êµ ì¤‘...');
try{const r=await callAI('ë‘ ê¸€ì˜ ë¬¸ì²´ë¥¼ ë¹„êµ ë¶„ì„:\n\n[ê¸€ A]\n'+a.substring(0,500)+'\n\n[ê¸€ B]\n'+b.substring(0,500)+'\n\në¹„êµ: 1)í†¤ ì°¨ì´ 2)ë¬¸ì¥ êµ¬ì¡° 3)ë‹¨ì–´ ì„ íƒ 4)ë…ì ì ‘ê·¼ì„± 5)ì–´ëŠ ìª½ì´ ë” íš¨ê³¼ì ì¸ì§€ì™€ ì´ìœ . í‘œ í˜•ì‹.');
$('style-rc').textContent=r||'';$('style-ra').classList.add('show');toast('âœ… ë¹„êµ ì™„ë£Œ')}catch(e){toast('âŒ '+e.message)}}

// ëŒ€ì‹œë³´ë“œ ë Œë”ë§
function renderStyleDash(){
if(!styleAnalysis||styleTexts.length===0){
$('style-dash-empty').style.display='block';
$('style-dash-content').style.display='none';
return;
}
$('style-dash-empty').style.display='none';
$('style-dash-content').style.display='block';

const s=styleAnalysis.scores;
const avgChars=styleTexts.length?Math.round(styleTexts.reduce((a,t)=>a+t.charCount,0)/styleTexts.length):0;
const avgWords=styleTexts.length?Math.round(styleTexts.reduce((a,t)=>a+t.wordCount,0)/styleTexts.length):0;
const avgSents=styleTexts.length?Math.round(styleTexts.reduce((a,t)=>a+t.sentCount,0)/styleTexts.length):0;

// ì§€í‘œ ì¹´ë“œ
$('style-metrics').innerHTML=`
<div class="hero-card">
<div class="hero-top"><span class="hero-label">í•™ìŠµëœ ê¸€</span><span class="hero-icon views">ğŸ“š</span></div>
<div class="hero-val">${styleTexts.length}í¸</div>
<div class="hero-sub">ë§ˆì§€ë§‰ í•™ìŠµ: ${styleAnalysis.date}</div>
</div>
<div class="hero-card">
<div class="hero-top"><span class="hero-label">í‰ê·  ê¸€ ê¸¸ì´</span><span class="hero-icon posts">ğŸ“</span></div>
<div class="hero-val">${avgChars.toLocaleString()}ì</div>
<div class="hero-sub">í‰ê·  ${avgSents}ë¬¸ì¥ Â· ${avgWords}ë‹¨ì–´</div>
</div>
`;

// ë°” ì°¨íŠ¸ ì§€í‘œ
const barData=[
{label:'ê²©ì‹ë„',key:'formality',color:'var(--b)',desc:'ë†’ì„ìˆ˜ë¡ ê²©ì‹ì²´'},
{label:'ë¬¸ì¥ ê¸¸ì´',key:'sentLen',color:'var(--ac)',desc:'ë†’ì„ìˆ˜ë¡ ê¸´ ë¬¸ì¥'},
{label:'ì´ëª¨ì§€ í™œìš©',key:'emoji',color:'#facc15',desc:'ë†’ì„ìˆ˜ë¡ ì´ëª¨ì§€ ë§ìŒ'},
{label:'ì „ë¬¸ ìš©ì–´',key:'jargon',color:'var(--r)',desc:'ë†’ì„ìˆ˜ë¡ ì „ë¬¸ì '},
{label:'ì¹œê·¼ê°',key:'friendly',color:'var(--g)',desc:'ë†’ì„ìˆ˜ë¡ ì¹œê·¼'},
{label:'ì„¤ë“ë ¥',key:'persuasion',color:'#a855f7',desc:'ë†’ì„ìˆ˜ë¡ ì„¤ë“ì '}
];
$('style-bars').innerHTML=barData.map(b=>{
const val=s[b.key]||5;
const pct=val*10;
return `<div style="margin-bottom:10px">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:4px">
<span style="font-size:.88em;font-weight:600;color:var(--t1)">${b.label}</span>
<span style="font-size:.82em;color:var(--t3)">${val}/10 Â· ${b.desc}</span>
</div>
<div style="background:var(--bg1);height:10px;border-radius:6px;overflow:hidden">
<div style="background:${b.color};height:100%;width:${pct}%;border-radius:6px;transition:width .6s"></div>
</div>
</div>`;
}).join('');

// ë¬¸ì²´ ìš”ì•½
$('style-summary').textContent=styleAnalysis.desc||'ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.';

// ì €ì¥ëœ ê¸€ ëª©ë¡
$('style-count').textContent=styleTexts.length;
$('style-saved-list').innerHTML=styleTexts.length?styleTexts.slice().reverse().map(t=>`
<div style="display:flex;align-items:center;gap:10px;padding:10px;background:var(--bg4);border-radius:var(--r2);margin-bottom:6px;border-left:3px solid var(--ac)">
<div style="flex:1;min-width:0">
<div style="font-weight:600;font-size:.88em;color:var(--t1);overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${t.title}</div>
<div style="font-size:.8em;color:var(--t3);margin-top:2px">${t.date} Â· ${t.source} Â· ${t.charCount.toLocaleString()}ì Â· ${t.sentCount}ë¬¸ì¥</div>
</div>
<button class="ebtn" onclick="viewStyleText(${t.id})">ë³´ê¸°</button>
<button class="ebtn" onclick="deleteStyleText(${t.id})" style="color:var(--r)">ì‚­ì œ</button>
</div>
`).join(''):'<div style="text-align:center;padding:16px;color:var(--t3);font-size:.88em">ì €ì¥ëœ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤</div>';
}

function viewStyleText(id){
const t=styleTexts.find(x=>x.id===id);
if(!t)return;
$('style-ta').value=t.text;
$('style-title').value=t.title;
setStyleMode('paste');
document.querySelectorAll('#style-pills .sub-pill').forEach(p=>p.classList.remove('a'));
document.querySelectorAll('#style-pills .sub-pill')[1].classList.add('a');
toast('ğŸ“„ "'+t.title+'" ë¶ˆëŸ¬ì˜´');
}

function deleteStyleText(id){
styleTexts=styleTexts.filter(x=>x.id!==id);
LS('style_texts',styleTexts);
renderStyleDash();
toast('ğŸ—‘ï¸ ì‚­ì œë¨');
}

function clearStyleTexts(){
if(!confirm('ëª¨ë“  í•™ìŠµ ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?'))return;
styleTexts=[];
styleAnalysis=null;
LS('style_texts',[]);
LS('style_analysis',null);
renderStyleDash();
toast('ğŸ—‘ï¸ ì „ì²´ ì‚­ì œë¨');
}

// === IMAGE ===
function addI(input,containerId){const file=input.files[0];if(!file)return;const reader=new FileReader();reader.onload=function(e){const slot=input.closest('.isl');slot.innerHTML='<img src="'+e.target.result+'">'; slot.classList.add('filled')};reader.readAsDataURL(file)}
function addIS(containerId){const c=$(containerId);const slot=document.createElement('div');slot.className='isl';slot.onclick=function(){this.querySelector('input').click()};slot.innerHTML='<span style="color:var(--t3);font-size:1.4em">+</span><input type="file" accept="image/*" style="display:none" onchange="addI(this,\''+containerId+'\')">';c.appendChild(slot)}

// === COPY ===
function copyF(platform){let text='';if(platform==='blog')text=$('blog-final').textContent||getEditorText();else if(platform==='insta')text=$('insta-edit-ta').value;else text=$('fb-edit-ta').value;
if(text)navigator.clipboard.writeText(text).then(()=>toast('ğŸ“‹ ë³µì‚¬ë¨')).catch(()=>toast('âŒ ë³µì‚¬ ì‹¤íŒ¨'))}

// === HELPERS ===
function togFP(btn){btn.classList.toggle('a');const panel=btn.nextElementSibling;panel.classList.toggle('show')}

// === DASHBOARD ===
// 7ì¼ íŠ¸ë Œë“œ ë°ì´í„°
const trendData=[
{day:'ì›”',blog:1800,insta:1400},
{day:'í™”',blog:2200,insta:1900},
{day:'ìˆ˜',blog:1500,insta:1100},
{day:'ëª©',blog:2800,insta:2300},
{day:'ê¸ˆ',blog:2100,insta:1700},
{day:'í† ',blog:800,insta:600},
{day:'ì¼',blog:1200,insta:900}
];
let trendFilter='all';

function setTrendFilter(mode){
trendFilter=mode;
document.querySelectorAll('#trend-tabs .trend-tab').forEach(t=>t.classList.remove('a'));
event.target.classList.add('a');
renderTrend();
}

function renderTrend(){
const maxVal=Math.max(...trendData.map(d=>trendFilter==='blog'?d.blog:trendFilter==='insta'?d.insta:(d.blog+d.insta)));
const chart=$('trend-chart');
chart.innerHTML=trendData.map(d=>{
const blogH=Math.max(8,Math.round(d.blog/maxVal*140));
const instaH=Math.max(8,Math.round(d.insta/maxVal*140));
if(trendFilter==='blog'){
return `<div style="flex:1;display:flex;flex-direction:column;align-items:center">
<div style="flex:1;display:flex;align-items:flex-end;width:100%">
<div class="trend-bar naver" style="height:${blogH}px;width:100%;border-radius:4px 4px 0 0" title="ë¸”ë¡œê·¸ ${d.blog.toLocaleString()}"></div>
</div>
<div class="trend-day-label">${d.day}</div>
</div>`;
}else if(trendFilter==='insta'){
return `<div style="flex:1;display:flex;flex-direction:column;align-items:center">
<div style="flex:1;display:flex;align-items:flex-end;width:100%">
<div class="trend-bar insta" style="height:${instaH}px;width:100%;border-radius:4px 4px 0 0" title="ì¸ìŠ¤íƒ€ ${d.insta.toLocaleString()}"></div>
</div>
<div class="trend-day-label">${d.day}</div>
</div>`;
}else{
return `<div style="flex:1;display:flex;flex-direction:column;align-items:center">
<div class="trend-bar-group">
<div class="trend-bar naver" style="height:${blogH}px" title="ë¸”ë¡œê·¸ ${d.blog.toLocaleString()}"></div>
<div class="trend-bar insta" style="height:${instaH}px" title="ì¸ìŠ¤íƒ€ ${d.insta.toLocaleString()}"></div>
</div>
<div class="trend-day-label">${d.day}</div>
</div>`;
}
}).join('');
}

function rDash(){
// í•µì‹¬ ì§€í‘œ (ì´ë¯¸ HTMLì— ê¸°ë³¸ê°’ ì„¸íŒ…)
const totalViews=trendData.reduce((s,d)=>s+d.blog+d.insta,0);
$('hero-views-val').textContent=totalViews.toLocaleString();
$('hero-posts-val').textContent='48';

// íŠ¸ë Œë“œ ì°¨íŠ¸ ë Œë”
renderTrend();

// í”Œë«í¼ë³„ ì„±ê³¼ ì¹´ë“œ
const platformData=[
{
id:'naver',
name:'ë„¤ì´ë²„ ë¸”ë¡œê·¸',
logo:'<span class="p-logo naver"></span>',
views:12400,
reach:15800,
engage:15.2,
ctr:4.2,
credits:85,
posts:42
},
{
id:'insta',
name:'ì¸ìŠ¤íƒ€ê·¸ë¨',
logo:'<span class="p-logo ig"></span>',
views:8300,
reach:11200,
engage:18.7,
ctr:3.1,
credits:62,
posts:38
},
{
id:'facebook',
name:'í˜ì´ìŠ¤ë¶',
logo:'<span class="p-logo fbk"></span>',
views:4100,
reach:5900,
engage:9.4,
ctr:2.8,
credits:45,
posts:28
},
{
id:'homepage',
name:'í™ˆí˜ì´ì§€',
logo:'ğŸ ',
views:3200,
reach:4100,
engage:8.6,
ctr:5.2,
credits:28,
posts:18
}
];

let cardsHTML='';
platformData.forEach(p=>{
// í¬ë ˆë”§ íš¨ìœ¨: 1í¬ë ˆë”§ë‹¹ ë¹„ìš© (ì´ APIë¹„ìš©/ê¸€ ìˆ˜) â†’ ê¸€ 1ê°œë‹¹ ì•½ â‚©12 ê¸°ì¤€
const costPerPost=Math.round(p.credits*12/p.posts);
const costPerView=Math.round(p.credits*12/p.views*1000);
const roi=Math.round(p.views/p.posts);
// ë“±ê¸‰ ì‚°ì •: ê²Œì‹œë¬¼ë‹¹ ì¡°íšŒìˆ˜ ê¸°ì¤€
const grade=roi>=300?'S':roi>=200?'A':roi>=130?'B':'C';
const gradeLabel=roi>=300?'ìµœê³ ':roi>=200?'ìš°ìˆ˜':roi>=130?'ë³´í†µ':'ê°œì„ í•„ìš”';
cardsHTML+=`<div class="platform-card ${p.id}">
<div class="pc-header">
<div class="pc-title"><div class="pc-logo">${p.logo}</div><span>${p.name}</span></div>
<span class="badge ${p.engage>12?'good':'neutral'}" style="font-size:.65em">${p.posts}ê°œ</span>
</div>
<div class="pc-row"><span class="pc-row-label">ì¡°íšŒìˆ˜</span><span class="pc-row-val accent">${(p.views/1000).toFixed(1)}K</span></div>
<div class="pc-row"><span class="pc-row-label">ì°¸ì—¬ìœ¨</span><span class="pc-row-val">${p.engage}%</span></div>
<div class="pc-row"><span class="pc-row-label">í´ë¦­ë¥ </span><span class="pc-row-val">${p.ctr}%</span></div>
<div class="pc-row"><span class="pc-row-label">ë„ë‹¬ìˆ˜</span><span class="pc-row-val">${(p.reach/1000).toFixed(1)}K</span></div>
<div class="pc-eff-bar">
<div class="pc-eff-row">
<span class="pc-grade ${grade.toLowerCase()}">${grade}</span>
<div>
<div style="font-size:.78em;font-weight:600;color:var(--t1)">ê¸€ë‹¹ ${roi}íšŒ ì¡°íšŒ</div>
<div class="pc-cost">â‚©${costPerView}/1Kë·° Â· ê¸€ë‹¹ â‚©${costPerPost}</div>
</div>
</div>
</div>
</div>`;
});
$('platform-cards').innerHTML=cardsHTML;

// í”Œë«í¼ ë¹„êµ ì°¨íŠ¸
let platHTML='';
platformData.forEach(p=>{
const viewPct=Math.round(p.views/280);
platHTML+=`<div class="progress-row">
<div class="progress-label">
<div style="display:flex;align-items:center;gap:8px">
<div style="width:10px;height:10px;border-radius:50%;background:${p.id==='naver'?'#03C75A':p.id==='insta'?'#E4405F':p.id==='facebook'?'#1877F2':'var(--ac)'}"></div>
<b>${p.name}</b>
</div>
<span style="color:var(--ac);font-weight:600">${p.views.toLocaleString()}</span>
</div>
<div class="progress-bar">
<div class="progress-fill" style="width:${viewPct}%;background:${p.id==='naver'?'#03C75A':p.id==='insta'?'#E4405F':p.id==='facebook'?'#1877F2':'var(--ac)'}"></div>
</div>
</div>`;
});
$('platform-performance').innerHTML=platHTML;

// AI ì¸ì‚¬ì´íŠ¸
$('ai-insight').innerHTML='í˜„ì¬ <b style="color:#03C75A">ë„¤ì´ë²„ ë¸”ë¡œê·¸</b>ê°€ ê°€ì¥ ë†’ì€ í¬ë ˆë”§ íš¨ìœ¨(146 ì¡°íšŒ/í¬ë ˆë”§)ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. <b style="color:var(--ac)">ì¶”ì²œ í‚¤ì›Œë“œ</b>ë¥¼ ì½˜í…ì¸ ì— ì ê·¹ í™œìš©í•˜ë©´ <b style="color:var(--g)">+45%</b> ì°¸ì—¬ìœ¨ í–¥ìƒì´ ì˜ˆìƒë©ë‹ˆë‹¤. í™ˆí˜ì´ì§€ì˜ CTRì´ 5.2%ë¡œ ë†’ì•„ ëœë”© í˜ì´ì§€ ìµœì í™”ê°€ ì˜ ë˜ì–´ìˆìœ¼ë©°, ê°œì„  í¬ì¸íŠ¸ì˜ ë ˆí¼ëŸ°ìŠ¤ ê¸°ëŠ¥ì„ í™œìš©í•˜ì—¬ ì•½ì ì„ ë³´ì™„í•˜ì„¸ìš”.';

// ê°•ì 
const strengths=[
'ë„¤ì´ë²„ ë¸”ë¡œê·¸ íš¨ìœ¨ ìµœê³  (146 ì¡°íšŒ/í¬ë ˆë”§)',
'ì¸ìŠ¤íƒ€ê·¸ë¨ ì°¸ì—¬ìœ¨ ìš°ìˆ˜ (18.7%)',
'ì¼ê´€ëœ ê²Œì‹œ ì£¼ê¸° (ì£¼ 3-4íšŒ)',
'í™ˆí˜ì´ì§€ CTR ë†’ìŒ (5.2%)'
];
$('strength-list').innerHTML=strengths.map(s=>`<div class="strength-item">${s}</div>`).join('');

// ì•½ì 
const weaknesses=[
'í˜ì´ìŠ¤ë¶ ì°¸ì—¬ìœ¨ ë‚®ìŒ (9.4%)',
'ì£¼ë§ í™œë™ ë¶€ì¡± (í† ì¼ 50% ê°ì†Œ)',
'í™ˆí˜ì´ì§€ ì¡°íšŒìˆ˜ ê°œì„  í•„ìš”',
'ì „ì²´ ë„ë‹¬ë¥  í–¥ìƒ í•„ìš”'
];
$('weakness-list').innerHTML=weaknesses.map(w=>`<div class="strength-item weak">${w}</div>`).join('');

// í‚¤ì›Œë“œ
const keywords=[
{kw:'LEDì „ê´‘íŒ',score:95,trend:'ìƒìŠ¹'},
{kw:'ì˜¥ì™¸ê´‘ê³ ',score:92,trend:'ìƒìŠ¹'},
{kw:'ë””ì§€í„¸ì‚¬ì´ë‹ˆì§€',score:88,trend:'ìœ ì§€'},
{kw:'ì „ê´‘íŒì„¤ì¹˜',score:85,trend:'ìƒìŠ¹'},
{kw:'ê´‘ê³ íš¨ê³¼',score:82,trend:'ìœ ì§€'},
{kw:'ë¸Œëœë”©',score:78,trend:'í•˜ë½'},
{kw:'ë°©ì†¡ì¤‘ê³„',score:75,trend:'ìƒìŠ¹'},
{kw:'ì´ë²¤íŠ¸',score:72,trend:'ìœ ì§€'}
];
$('keyword-grid').innerHTML=keywords.map(k=>{
const emoji=k.trend==='ìƒìŠ¹'?'ğŸ“ˆ':k.trend==='í•˜ë½'?'ğŸ“‰':'â¡ï¸';
return `<div class="kw-pill">
<span>${k.kw}</span>
<span class="kw-score">${k.score}</span>
<span>${emoji}</span>
</div>`;
}).join('');

// ì¶”ì²œ í‚¤ì›Œë“œ ì´ˆê¸°í™”
const recKeywords=[
{kw:'LEDì „ê´‘íŒ ì‹œê³µ',score:97,reason:'ê²€ìƒ‰ëŸ‰ ë†’ê³  ê²½ìŸ ë‚®ìŒ',type:'í•µì‹¬'},
{kw:'ì „ê´‘íŒ ë Œíƒˆ ê°€ê²©',score:93,reason:'êµ¬ë§¤ ì˜ë„ í‚¤ì›Œë“œ',type:'ì „í™˜'},
{kw:'ì˜¥ì™¸ê´‘ê³  íš¨ê³¼',score:90,reason:'ì •ë³´ íƒìƒ‰ ë‹¨ê³„ ìœ ì…',type:'ìœ ì…'},
{kw:'ë””ì§€í„¸ ì‚¬ì´ë‹ˆì§€ ì„¤ì¹˜',score:87,reason:'B2B íƒ€ê²Ÿ ì •í™•',type:'í•µì‹¬'},
{kw:'LEDìŠ¤í¬ë¦° ë Œíƒˆ',score:84,reason:'ì´ë²¤íŠ¸ ì‹œì¦Œ ìˆ˜ìš”â†‘',type:'ì‹œì¦Œ'},
{kw:'ë°©ì†¡ì¤‘ê³„ ì¥ë¹„',score:81,reason:'ì „ë¬¸ì„± ì–´í•„ í‚¤ì›Œë“œ',type:'ë¸Œëœë”©'}
];
$('recommended-keyword-grid').innerHTML=recKeywords.map(k=>{
const typeColor=k.type==='í•µì‹¬'?'var(--ac)':k.type==='ì „í™˜'?'var(--g)':k.type==='ìœ ì…'?'var(--b)':k.type==='ì‹œì¦Œ'?'#facc15':'var(--t2)';
return `<div class="kw-pill" onclick="useKeyword('${k.kw}')" title="${k.reason}">
<span style="font-size:.65em;padding:2px 6px;border-radius:8px;background:${typeColor}22;color:${typeColor};font-weight:600">${k.type}</span>
<span>${k.kw}</span>
<span class="kw-score">${k.score}</span>
</div>`;
}).join('');

// ì¸ê¸° í‚¤ì›Œë“œ ì´ˆê¸°í™”
const popKeywords=[
{kw:'LEDì „ê´‘íŒ',score:95,trend:'ìƒìŠ¹',vol:'12,400'},
{kw:'ì˜¥ì™¸ê´‘ê³ ',score:92,trend:'ìƒìŠ¹',vol:'8,700'},
{kw:'ë””ì§€í„¸ì‚¬ì´ë‹ˆì§€',score:88,trend:'ìœ ì§€',vol:'5,200'},
{kw:'ì „ê´‘íŒì„¤ì¹˜',score:85,trend:'ìƒìŠ¹',vol:'4,800'},
{kw:'ê´‘ê³ íš¨ê³¼ë¶„ì„',score:82,trend:'ìƒìŠ¹',vol:'3,600'},
{kw:'ë¸Œëœë”©ì „ëµ',score:78,trend:'í•˜ë½',vol:'6,100'},
{kw:'ë°©ì†¡ì¤‘ê³„ì„œë¹„ìŠ¤',score:75,trend:'ìƒìŠ¹',vol:'2,900'},
{kw:'ì´ë²¤íŠ¸ì˜ìƒ',score:72,trend:'ìœ ì§€',vol:'3,400'}
];
$('popular-keyword-grid').innerHTML=popKeywords.map(k=>{
const emoji=k.trend==='ìƒìŠ¹'?'ğŸ“ˆ':k.trend==='í•˜ë½'?'ğŸ“‰':'â¡ï¸';
return `<div class="kw-pill" onclick="useKeyword('${k.kw}')" title="ì›”ê°„ ê²€ìƒ‰ëŸ‰: ${k.vol}">
<span>${k.kw}</span>
<span class="kw-score">${k.score}</span>
<span>${emoji}</span>
<span style="font-size:.65em;color:var(--t3)">${k.vol}</span>
</div>`;
}).join('');

// ë‚´ ê¸€ í‚¤ì›Œë“œ ìˆœìœ„ ì´ˆê¸°í™”
const rankData=[
{kw:'LEDì „ê´‘íŒ ì‹œê³µ',platform:'naver',rank:3,prev:5,best:2,post:'2024 ì½”ì—‘ìŠ¤ ì‹œê³µì‚¬ë¡€'},
{kw:'ë°©ì†¡ì¤‘ê³„ ì¥ë¹„',platform:'naver',rank:7,prev:8,best:5,post:'ë°©ì†¡ì¤‘ê³„ ì‹œìŠ¤í…œ ì†Œê°œ'},
{kw:'ì „ê´‘íŒ ë Œíƒˆ',platform:'naver',rank:12,prev:10,best:8,post:'ì „ê´‘íŒ ë Œíƒˆ ê°€ì´ë“œ'},
{kw:'ì˜¥ì™¸ê´‘ê³  íš¨ê³¼',platform:'google',rank:18,prev:22,best:15,post:'ì˜¥ì™¸ê´‘ê³  ROI ë¶„ì„'},
{kw:'LEDì „ê´‘íŒ',platform:'insta',rank:5,prev:5,best:3,post:'í˜„ì¥ ì‹œê³µ ë¦´ìŠ¤'},
{kw:'ë””ì§€í„¸ì‚¬ì´ë‹ˆì§€',platform:'naver',rank:24,prev:20,best:18,post:'ë””ì§€í„¸ì‚¬ì´ë‹ˆì§€ íŠ¸ë Œë“œ'}
];
function renderRankTable(data){
$('rank-tbody').innerHTML=(data||rankData).map(r=>{
const diff=r.prev-r.rank;
const changeClass=diff>0?'up':diff<0?'down':'same';
const changeText=diff>0?'â–²'+diff:diff<0?'â–¼'+Math.abs(diff):'-';
const rankClass=r.rank<=5?'top':r.rank<=15?'mid':'low';
const platIcon=r.platform==='naver'?'<span class="p-logo naver" style="width:16px;height:16px;border-radius:4px;font-size:9px"></span>':r.platform==='insta'?'<span class="p-logo ig" style="width:16px;height:16px;border-radius:4px"></span>':'<span style="font-size:.8em">ğŸ”</span>';
return `<tr>
<td style="font-weight:600;color:var(--t1)">${r.kw}</td>
<td>${platIcon}</td>
<td><span class="rank-num ${rankClass}">${r.rank}ìœ„</span></td>
<td><span class="rank-change ${changeClass}">${changeText}</span></td>
<td style="color:var(--t3)">${r.best}ìœ„</td>
<td style="font-size:.72em;color:var(--t3);max-width:120px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap" title="${r.post}">${r.post}</td>
</tr>`;
}).join('');
}
renderRankTable();

// í‚¤ì›Œë“œ ì¶”ê°€
function addTrackKeyword(){
const kw=$('rank-kw-input').value.trim();
const plat=$('rank-platform').value;
if(!kw){toast('âš ï¸ í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”');$('rank-kw-input').focus();return}
rankData.push({kw:kw,platform:plat,rank:'â€”',prev:'â€”',best:'â€”',post:'(ì¡°íšŒ í•„ìš”)'});
renderRankTable();
$('rank-kw-input').value='';
toast('âœ… "'+kw+'" ì¶”ì  ëª©ë¡ì— ì¶”ê°€ë¨');
}

// AI ìˆœìœ„ ì¡°íšŒ
async function checkMyRanking(){
if(!apiKey){toast('âš ï¸ API í‚¤ í•„ìš”');showM('m-api');return}
toast('ğŸ” í‚¤ì›Œë“œ ìˆœìœ„ ë¶„ì„ ì¤‘...');
try{
const kwList=rankData.map(r=>r.kw).join(', ');
const r=await callAI(`LEDì „ê´‘íŒ/ì˜¥ì™¸ê´‘ê³ /ë°©ì†¡ì¤‘ê³„ ì—…ì²´ì˜ ë¸”ë¡œê·¸ í‚¤ì›Œë“œ ìˆœìœ„ë¥¼ ë¶„ì„í•´ì¤˜.

ì¶”ì  í‚¤ì›Œë“œ: ${kwList}

ê° í‚¤ì›Œë“œë³„ë¡œ ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ë‹µí•´ì¤˜:
í‚¤ì›Œë“œ | ì˜ˆìƒìˆœìœ„(1-50) | ìˆœìœ„ë³€ë™(ìƒìŠ¹/í•˜ë½/ìœ ì§€, ëª‡ë‹¨ê³„) | ìˆœìœ„ ì˜¬ë¦¬ê¸° íŒ í•œì¤„

ë§ˆì§€ë§‰ì— "ğŸ’¡ ì¢…í•©:" ìœ¼ë¡œ ê°€ì¥ ì‹œê¸‰í•œ ê°œì„ ì´ í•„ìš”í•œ í‚¤ì›Œë“œì™€ ì „ëµ 2ì¤„.`);
const lines=r.split('\n').filter(l=>l.trim());
let analysisText='';
lines.forEach(line=>{
const parts=line.split('|');
if(parts.length>=3){
const kw=parts[0].trim();
const match=rankData.find(d=>kw.includes(d.kw)||d.kw.includes(kw));
if(match){
const newRank=parseInt(parts[1].trim())||match.rank;
match.prev=match.rank!=='â€”'?match.rank:newRank;
match.rank=newRank;
if(match.best==='â€”'||newRank<match.best)match.best=newRank;
}
}else if(line.includes('ì¢…í•©')||line.includes('ğŸ’¡')){
analysisText+=line.trim()+'\n';
}
});
renderRankTable();
if(analysisText.trim()){
$('rank-analysis').innerHTML='<b>'+analysisText.trim().replace(/\n/g,'<br>')+'</b>';
$('rank-detail').style.display='block';
}
toast('âœ… ìˆœìœ„ ë¶„ì„ ì™„ë£Œ');
}catch(e){toast('âŒ '+e.message)}}

// ê²½ìŸì‚¬ ë¹„êµ
const comparisons=[
{metric:'í‰ê·  ì¡°íšŒìˆ˜',ours:189,theirs:168,good:true},
{metric:'ì°¸ì—¬ìœ¨',ours:12.3,theirs:8.9,good:true},
{metric:'ê²Œì‹œ ë¹ˆë„',ours:3.5,theirs:2.3,good:true},
{metric:'ë™ì˜ìƒ ë¹„ìœ¨',ours:18,theirs:42,good:false}
];
$('competitor-compare').innerHTML=comparisons.map(c=>{
const diff=Math.round((c.ours-c.theirs)/c.theirs*100);
const badge=c.good?(diff>0?'good':'bad'):(diff<0?'good':'bad');
return `<div class="compare-row">
<div class="compare-label">${c.metric}</div>
<div class="compare-values">
<span class="compare-theirs">ê²½ìŸì‚¬: ${c.theirs}</span>
<span class="compare-ours">ìš°ë¦¬: ${c.ours}</span>
<span class="badge ${badge}">${diff>0?'+':''}${diff}%</span>
</div>
</div>`;
}).join('');
}

// ëŒ€ì‹œë³´ë“œ ìƒˆë¡œê³ ì¹¨
function refreshDash(){
const btn=$('dash-refresh-btn');
btn.disabled=true;btn.innerHTML='<span class="spinner"></span>ê°±ì‹  ì¤‘...';
// ì•½ê°„ì˜ ëœë¤ ë³€ë™ìœ¼ë¡œ ì‹¤ì‹œê°„ ëŠë‚Œ
trendData.forEach(d=>{
d.blog=Math.max(500,d.blog+Math.round((Math.random()-.4)*300));
d.insta=Math.max(300,d.insta+Math.round((Math.random()-.4)*250));
});
setTimeout(()=>{
rDash();
btn.disabled=false;btn.innerHTML='ğŸ”„ ìƒˆë¡œê³ ì¹¨';
toast('âœ… ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
},800);
}

// AI ì „ì²´ ë¶„ì„
async function analyzeAll(){
if(!apiKey){toast('âš ï¸ API í‚¤ í•„ìš”');showM('m-api');return}
toast('ğŸ¤– ì¢…í•© ë¶„ì„ ì¤‘...');
try{
const r=await callAI('SNS ì½˜í…ì¸  ì„±ê³¼ ë°ì´í„°ë¥¼ ë³´ê³  3ê°€ì§€ í•µì‹¬ ì¸ì‚¬ì´íŠ¸ì™€ êµ¬ì²´ì ì¸ ì‹¤í–‰ ë°©ì•ˆì„ ì œì‹œ. í”Œë«í¼: ë„¤ì´ë²„ë¸”ë¡œê·¸/ì¸ìŠ¤íƒ€/í˜ë¶/í™ˆí˜ì´ì§€. ì—…ê³„: LEDì „ê´‘íŒ/ì˜¥ì™¸ê´‘ê³ . ê°•ì : ë„¤ì´ë²„ íš¨ìœ¨ ì¢‹ìŒ, ì¸ìŠ¤íƒ€ ì°¸ì—¬ìœ¨ ë†’ìŒ. ì•½ì : í˜ë¶ ì €ì¡°, ì£¼ë§ ë¶€ì¡±. ê°„ê²°í•˜ê²Œ 3-4ë¬¸ì¥.');
$('ai-insight').innerHTML=r||'ë¶„ì„ ì™„ë£Œ';
toast('âœ… ë¶„ì„ ì™„ë£Œ')
}catch(e){toast('âŒ '+e.message)}}

// AI í‚¤ì›Œë“œ ì¶”ì²œ
async function getKeywords(){
if(!apiKey){toast('âš ï¸ API í‚¤ í•„ìš”');showM('m-api');return}
toast('âœ¨ í‚¤ì›Œë“œ ìƒì„± ì¤‘...');
try{
const r=await callAI('LEDì „ê´‘íŒ/ì˜¥ì™¸ê´‘ê³  ì—…ê³„ ì¶”ì²œ í‚¤ì›Œë“œ 8ê°œë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ (ì ìˆ˜ 90-70). ê° ì¤„ë§ˆë‹¤ "í‚¤ì›Œë“œ | ì ìˆ˜ | íŠ¸ë Œë“œ(ìƒìŠ¹/í•˜ë½/ìœ ì§€)" í˜•ì‹. ì˜ˆ: LEDì „ê´‘íŒ | 95 | ìƒìŠ¹');
const lines=r.split('\n').filter(l=>l.trim());
let kwHTML='';
lines.forEach(line=>{
const parts=line.split('|');
if(parts.length>=3){
const kw=parts[0].trim();
const score=parts[1].trim();
const trend=parts[2].trim();
const emoji=trend.includes('ìƒìŠ¹')?'ğŸ“ˆ':trend.includes('í•˜ë½')?'ğŸ“‰':'â¡ï¸';
kwHTML+=`<div class="kw-pill"><span>${kw}</span><span class="kw-score">${score}</span><span>${emoji}</span></div>`;
}
});
if(kwHTML)$('keyword-grid').innerHTML=kwHTML;
toast('âœ… ìƒì„± ì™„ë£Œ')
}catch(e){toast('âŒ '+e.message)}}

// AI ì¶”ì²œ í‚¤ì›Œë“œ ë¶„ì„
async function getRecommendedKeywords(){
if(!apiKey){toast('âš ï¸ API í‚¤ í•„ìš”');showM('m-api');return}
toast('ğŸ¤– í‚¤ì›Œë“œ ë¶„ì„ ì¤‘...');
try{
const r=await callAI('LEDì „ê´‘íŒ/ì˜¥ì™¸ê´‘ê³ /ë°©ì†¡ì¤‘ê³„ ì—…ê³„ì˜ SNS ì½˜í…ì¸  í‚¤ì›Œë“œ ì „ëµì„ ë¶„ì„í•´ì¤˜.\n\në‹¤ìŒì„ í¬í•¨:\n1) í˜„ì¬ ìš°ë¦¬ê°€ ì‚¬ìš©í•´ì•¼ í•  í•µì‹¬ í‚¤ì›Œë“œ 6ê°œ (ê°ê° íƒ€ì…: í•µì‹¬/ì „í™˜/ìœ ì…/ì‹œì¦Œ/ë¸Œëœë”© ì¤‘ í•˜ë‚˜, ì ìˆ˜ 70-100, ì¶”ì²œ ì´ìœ  í•œ ì¤„)\ní˜•ì‹: "í‚¤ì›Œë“œ | ì ìˆ˜ | íƒ€ì… | ì´ìœ "\nì˜ˆ: LEDì „ê´‘íŒ ì‹œê³µ | 97 | í•µì‹¬ | ê²€ìƒ‰ëŸ‰ ë†’ê³  ê²½ìŸ ë‚®ìŒ\n\n2) í‚¤ì›Œë“œ ì¡°í•© ì „ëµ í•œ ë‹¨ë½ (ì–´ë–¤ í‚¤ì›Œë“œë¥¼ ì–´ë–¤ í”Œë«í¼ì—ì„œ ì“°ë©´ ì¢‹ì€ì§€)');
const lines=r.split('\n').filter(l=>l.trim());
let kwHTML='';let analysisText='';let inAnalysis=false;
lines.forEach(line=>{
const parts=line.split('|');
if(parts.length>=4){
const kw=parts[0].trim();const score=parts[1].trim();const type=parts[2].trim();const reason=parts[3].trim();
const typeColor=type.includes('í•µì‹¬')?'var(--ac)':type.includes('ì „í™˜')?'var(--g)':type.includes('ìœ ì…')?'var(--b)':type.includes('ì‹œì¦Œ')?'#facc15':'var(--t2)';
kwHTML+=`<div class="kw-pill" onclick="useKeyword('${kw}')" title="${reason}">
<span style="font-size:.65em;padding:2px 6px;border-radius:8px;background:${typeColor}22;color:${typeColor};font-weight:600">${type}</span>
<span>${kw}</span>
<span class="kw-score">${score}</span>
</div>`;
}else if(!line.includes('|')){analysisText+=line+'\n';inAnalysis=true}
});
if(kwHTML)$('recommended-keyword-grid').innerHTML=kwHTML;
if(analysisText.trim()){$('rec-kw-analysis').innerHTML='<b>ğŸ’¡ í‚¤ì›Œë“œ ì „ëµ:</b><br>'+analysisText.trim();$('rec-kw-detail').style.display='block'}
toast('âœ… AI ë¶„ì„ ì™„ë£Œ')
}catch(e){toast('âŒ '+e.message)}}

// ì¸ê¸° í‚¤ì›Œë“œ ìƒˆë¡œê³ ì¹¨
async function getPopularKeywords(){
if(!apiKey){toast('âš ï¸ API í‚¤ í•„ìš”');showM('m-api');return}
toast('ğŸ”„ ì¸ê¸° í‚¤ì›Œë“œ ì¡°íšŒ ì¤‘...');
try{
const r=await callAI('LEDì „ê´‘íŒ/ì˜¥ì™¸ê´‘ê³ /ë°©ì†¡ì¤‘ê³„ ê´€ë ¨ í˜„ì¬ ì¸ê¸° ê²€ìƒ‰ í‚¤ì›Œë“œ 8ê°œë¥¼ ì•Œë ¤ì¤˜.\ní˜•ì‹: "í‚¤ì›Œë“œ | ì¸ê¸°ì ìˆ˜(100ì  ë§Œì ) | íŠ¸ë Œë“œ(ìƒìŠ¹/í•˜ë½/ìœ ì§€) | ì›”ê°„ ì˜ˆìƒ ê²€ìƒ‰ëŸ‰"\nì˜ˆ: LEDì „ê´‘íŒ | 95 | ìƒìŠ¹ | 12,400\n\nì¶”ê°€ë¡œ í•œ ì¤„ë¡œ í˜„ì¬ íŠ¸ë Œë“œ ìš”ì•½í•´ì¤˜.');
const lines=r.split('\n').filter(l=>l.trim());
let kwHTML='';let summaryText='';
lines.forEach(line=>{
const parts=line.split('|');
if(parts.length>=4){
const kw=parts[0].trim();const score=parts[1].trim();const trend=parts[2].trim();const vol=parts[3].trim();
const emoji=trend.includes('ìƒìŠ¹')?'ğŸ“ˆ':trend.includes('í•˜ë½')?'ğŸ“‰':'â¡ï¸';
kwHTML+=`<div class="kw-pill" onclick="useKeyword('${kw}')" title="ì›”ê°„ ê²€ìƒ‰ëŸ‰: ${vol}">
<span>${kw}</span>
<span class="kw-score">${score}</span>
<span>${emoji}</span>
<span style="font-size:.65em;color:var(--t3)">${vol}</span>
</div>`;
}else if(!line.includes('|')&&line.trim().length>5){summaryText=line.trim()}
});
if(kwHTML)$('popular-keyword-grid').innerHTML=kwHTML;
if(summaryText){$('pop-kw-analysis').innerHTML='<b>ğŸ“Š íŠ¸ë Œë“œ ìš”ì•½:</b> '+summaryText;$('pop-kw-detail').style.display='block'}
toast('âœ… ì—…ë°ì´íŠ¸ ì™„ë£Œ')
}catch(e){toast('âŒ '+e.message)}}

// í‚¤ì›Œë“œ í™œìš© (í´ë¦­ ì‹œ)
function useKeyword(kw){
const activeTab=document.querySelector('.tab-c.a');
if(activeTab&&activeTab.id==='dash-tab'){
navigator.clipboard.writeText(kw).then(()=>toast('ğŸ“‹ "'+kw+'" ë³µì‚¬ë¨ â€” ì½˜í…ì¸ ì— í™œìš©í•˜ì„¸ìš”!')).catch(()=>toast('í‚¤ì›Œë“œ: '+kw))
}}

// ë ˆí¼ëŸ°ìŠ¤ ì°¾ê¸°
async function getReferences(){
if(!apiKey){toast('âš ï¸ API í‚¤ í•„ìš”');showM('m-api');return}
const keyword=$('ref-keyword').value.trim();
const platform=$('ref-platform').value;
const platNames={blog:'ë„¤ì´ë²„ ë¸”ë¡œê·¸',insta:'ì¸ìŠ¤íƒ€ê·¸ë¨',fb:'í˜ì´ìŠ¤ë¶',all:'ì „ì²´ í”Œë«í¼'};
if(!keyword){toast('âš ï¸ í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');$('ref-keyword').focus();return}
const btn=$('ref-btn');btn.disabled=true;btn.innerHTML='<span class="spinner"></span>ë¶„ì„ ì¤‘...';
toast('ğŸ“š ë ˆí¼ëŸ°ìŠ¤ ë¶„ì„ ì¤‘...');
try{
const prompt=`LEDì „ê´‘íŒ/ì˜¥ì™¸ê´‘ê³ /ë°©ì†¡ì¤‘ê³„ ì—…ê³„ì—ì„œ "${keyword}" ì£¼ì œë¡œ ${platNames[platform]}ì— ì˜¬ë¦´ ì½˜í…ì¸ ë¥¼ ìœ„í•œ ë ˆí¼ëŸ°ìŠ¤ë¥¼ ì œê³µí•´ì¤˜.

ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ 3ê°œì˜ ë ˆí¼ëŸ°ìŠ¤ ì½˜í…ì¸  êµ¬ì¡°ë¥¼ ì œì•ˆí•´ì¤˜:

[ë ˆí¼ëŸ°ìŠ¤ 1]
ì œëª©: (ì˜ˆì‹œ ì œëª©)
êµ¬ì¡°: (ê¸€ì˜ íë¦„/êµ¬ì„± ìš”ì•½)
í•µì‹¬ ì „ëµ: (ì™œ ì´ êµ¬ì¡°ê°€ íš¨ê³¼ì ì¸ì§€)
ì¶”ì²œ í‚¤ì›Œë“œ: (ì´ ê¸€ì— ë…¹ì¼ í‚¤ì›Œë“œ 3-5ê°œ)
ì˜ˆìƒ ì„±ê³¼: (ì´ëŸ° ìœ í˜•ì˜ ê¸€ì´ ë³´í†µ ì–´ë–¤ ë°˜ì‘ì„ ì–»ëŠ”ì§€)

[ë ˆí¼ëŸ°ìŠ¤ 2]
...

[ë ˆí¼ëŸ°ìŠ¤ 3]
...

ë§ˆì§€ë§‰ì— "ğŸ’¡ ì¢…í•© ì œì•ˆ:" ìœ¼ë¡œ 3ê°œ ë ˆí¼ëŸ°ìŠ¤ ì¤‘ ê°€ì¥ ì¶”ì²œí•˜ëŠ” ê²ƒê³¼ ì´ìœ ë¥¼ 2ì¤„ë¡œ.`;
const r=await callAI(prompt);

// Parse and display references as cards
let html='';
const refs=r.split(/\[ë ˆí¼ëŸ°ìŠ¤\s*\d+\]/g).filter(s=>s.trim());
if(refs.length>0){
html+='<div style="display:grid;gap:10px">';
refs.forEach((ref,i)=>{
const lines=ref.trim().split('\n').filter(l=>l.trim());
if(lines.length<2)return;
// Check if this is the summary line
const isSummary=ref.includes('ì¢…í•© ì œì•ˆ');
if(isSummary){
html+=`<div class="tip-box" style="margin-top:4px">${ref.trim().replace(/\n/g,'<br>')}</div>`;
return;
}
html+=`<div style="background:var(--bg4);border:1px solid var(--border);border-radius:var(--r2);padding:14px;border-left:3px solid ${i===0?'var(--ac)':i===1?'var(--b)':'var(--g)'}">
<div style="font-size:.78em;color:var(--t3);margin-bottom:4px">ë ˆí¼ëŸ°ìŠ¤ ${i+1}</div>
<div style="font-size:.85em;color:var(--t2);line-height:1.7;white-space:pre-wrap">${ref.trim()}</div>
<div style="margin-top:8px;display:flex;gap:4px">
<button class="ebtn" onclick="applyReference(${i},'${keyword}')">ğŸ“ ì´ êµ¬ì¡°ë¡œ ê¸€ì“°ê¸°</button>
<button class="ebtn" onclick="navigator.clipboard.writeText(this.closest('div[style]').querySelector('div[style*=pre-wrap]').textContent).then(()=>toast('ğŸ“‹ ë³µì‚¬ë¨'))">ğŸ“‹ ë³µì‚¬</button>
</div>
</div>`;
});
html+='</div>';
}else{
html=`<div style="font-size:.85em;color:var(--t2);line-height:1.7;white-space:pre-wrap;padding:10px;background:var(--bg4);border-radius:var(--r2)">${r}</div>`;
}
$('ref-content').innerHTML=html;
$('ref-results').style.display='block';
toast('âœ… ë ˆí¼ëŸ°ìŠ¤ ë¶„ì„ ì™„ë£Œ')
}catch(e){toast('âŒ '+e.message)}finally{btn.disabled=false;btn.innerHTML='ğŸ” ë ˆí¼ëŸ°ìŠ¤ ì°¾ê¸°'}}

// ë ˆí¼ëŸ°ìŠ¤ êµ¬ì¡°ë¥¼ ì½˜í…ì¸  íƒ­ì— ì ìš©
function applyReference(idx,keyword){
const activeNav=document.querySelector('.nav-i.a');
const currentTab=activeNav?activeNav.dataset.t:'blog';
if(currentTab==='blog'||currentTab==='dash'){
go('blog');
$('b-event').value=keyword;
toast('âœ… ë¸”ë¡œê·¸ íƒ­ì— í‚¤ì›Œë“œ ì ìš©ë¨ â€” ìƒì„¸ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”');
}else if(currentTab==='insta'){
$('i-content').value=keyword+' ê´€ë ¨ ì½˜í…ì¸ ';
toast('âœ… ì¸ìŠ¤íƒ€ íƒ­ì— í‚¤ì›Œë“œ ì ìš©ë¨');
}else if(currentTab==='fb'){
$('f-content').value=keyword+' ê´€ë ¨ ì½˜í…ì¸ ';
toast('âœ… í˜ì´ìŠ¤ë¶ íƒ­ì— í‚¤ì›Œë“œ ì ìš©ë¨');
}}


// === SMART PLACE ===
function setSpMode(mode){
document.querySelectorAll('#sp-pills .sub-pill').forEach(p=>p.classList.remove('a'));
event.target.classList.add('a');
$('sp-dashboard').style.display=mode==='dashboard'?'block':'none';
$('sp-myplace').style.display=mode==='myplace'?'block':'none';
$('sp-keyword').style.display=mode==='keyword'?'block':'none';
$('sp-ranking').style.display=mode==='ranking'?'block':'none';
if(mode==='myplace')updatePlacePreview();
}

// ìœ ì… ê²€ìƒ‰ì–´ ë°ì´í„°
const spSearchData=[
{rank:1,kw:'LEDì „ê´‘íŒ ì„¤ì¹˜',visits:342,pct:28.5,conv:12.3,trend:'up'},
{rank:2,kw:'ì „ê´‘íŒ ë Œíƒˆ',visits:218,pct:18.2,conv:9.8,trend:'up'},
{rank:3,kw:'ë°©ì†¡ì¤‘ê³„ ì—…ì²´',visits:187,pct:15.6,conv:15.2,trend:'same'},
{rank:4,kw:'ì˜¥ì™¸ ì „ê´‘íŒ',visits:124,pct:10.3,conv:7.4,trend:'down'},
{rank:5,kw:'LEDìŠ¤í¬ë¦° ëŒ€ì—¬',visits:98,pct:8.2,conv:11.1,trend:'up'},
{rank:6,kw:'í–‰ì‚¬ ì˜ìƒì¥ë¹„',visits:72,pct:6.0,conv:8.9,trend:'same'},
{rank:7,kw:'ì „ê´‘íŒ ê°€ê²©',visits:56,pct:4.7,conv:5.2,trend:'up'},
{rank:8,kw:'ê°•ë‚¨ LEDì„¤ì¹˜',visits:41,pct:3.4,conv:14.6,trend:'up'},
{rank:9,kw:'ë°©ì†¡ì¥ë¹„ ë Œíƒˆ',visits:34,pct:2.8,conv:6.7,trend:'down'},
{rank:10,kw:'ì˜ìƒì¤‘ê³„ ì„œë¹„ìŠ¤',visits:28,pct:2.3,conv:10.5,trend:'same'}
];

function renderSpSearch(){
$('sp-search-tbody').innerHTML=spSearchData.map(s=>{
const trendIcon=s.trend==='up'?'<span class="rank-change up">â–²</span>':s.trend==='down'?'<span class="rank-change down">â–¼</span>':'<span class="rank-change same">-</span>';
const barW=Math.max(20,Math.round(s.pct/30*100));
return `<tr>
<td style="font-weight:600;color:var(--t3)">${s.rank}</td>
<td style="font-weight:600;color:var(--t1)">${s.kw}</td>
<td><span style="color:var(--ac);font-weight:600;font-family:var(--fm)">${s.visits}</span></td>
<td><div style="display:flex;align-items:center;gap:6px"><div style="background:linear-gradient(90deg,#03C75A,#03C75A88);height:6px;width:${barW}%;border-radius:3px;min-width:15px"></div><span style="font-size:.8em">${s.pct}%</span></div></td>
<td style="color:${s.conv>=10?'var(--g)':'var(--t2)'};font-weight:${s.conv>=10?'600':'400'}">${s.conv}%</td>
<td>${trendIcon}</td>
</tr>`;
}).join('');
}

// ì£¼ê°„ í–‰ë™ íŠ¸ë Œë“œ
const spTrendData={
views:[{day:'ì›”',cur:320,prev:280},{day:'í™”',cur:380,prev:350},{day:'ìˆ˜',cur:290,prev:310},{day:'ëª©',cur:420,prev:370},{day:'ê¸ˆ',cur:360,prev:340},{day:'í† ',cur:280,prev:250},{day:'ì¼',cur:290,prev:260}],
calls:[{day:'ì›”',cur:5,prev:4},{day:'í™”',cur:7,prev:5},{day:'ìˆ˜',cur:4,prev:6},{day:'ëª©',cur:8,prev:5},{day:'ê¸ˆ',cur:6,prev:7},{day:'í† ',cur:4,prev:3},{day:'ì¼',cur:4,prev:3}]
};
let spTrendMode='views';

function setSpTrend(mode){
spTrendMode=mode;
document.querySelectorAll('#sp-trend-tabs .trend-tab').forEach(t=>t.classList.remove('a'));
event.target.classList.add('a');
renderSpTrend();
}

function renderSpTrend(){
const data=spTrendData[spTrendMode];
const maxVal=Math.max(...data.map(d=>Math.max(d.cur,d.prev)));
$('sp-trend-chart').innerHTML=data.map(d=>{
const curH=Math.max(8,Math.round(d.cur/maxVal*140));
const prevH=Math.max(8,Math.round(d.prev/maxVal*140));
return `<div style="flex:1;display:flex;flex-direction:column;align-items:center">
<div class="trend-bar-group">
<div class="trend-bar" style="height:${prevH}px;background:var(--bg4);border:1px solid var(--border)" title="ì§€ë‚œì£¼ ${d.prev}"></div>
<div class="trend-bar" style="height:${curH}px;background:#03C75A" title="ì´ë²ˆì£¼ ${d.cur}"></div>
</div>
<div class="trend-day-label">${d.day}</div>
</div>`;
}).join('');
}

// ì „í™˜ í¼ë„
function renderSpFunnel(){
const funnel=[
{name:'ê²€ìƒ‰ ë…¸ì¶œ',val:12400,color:'var(--t2)'},
{name:'í”Œë ˆì´ìŠ¤ í´ë¦­',val:2340,color:'#03C75A'},
{name:'ìƒì„¸ ì •ë³´ í™•ì¸',val:1560,color:'var(--b)'},
{name:'ì „í™” ì—°ê²°',val:105,color:'var(--ac)'},
{name:'ì‹¤ì œ ë°©ë¬¸ (ì¶”ì •)',val:42,color:'var(--g)'}
];
const maxVal=funnel[0].val;
$('sp-funnel').innerHTML=funnel.map((f,i)=>{
const w=Math.max(25,Math.round(f.val/maxVal*100));
const convRate=i>0?((f.val/funnel[i-1].val)*100).toFixed(1)+'%':'â€”';
return `<div style="display:flex;align-items:center;gap:10px;margin-bottom:6px">
<div style="width:100px;text-align:right;font-size:.78em;color:var(--t2);flex-shrink:0">${f.name}</div>
<div style="flex:1;position:relative">
<div style="background:${f.color};height:28px;width:${w}%;border-radius:6px;opacity:.75;display:flex;align-items:center;padding-left:10px">
<span style="font-size:.78em;font-weight:600;color:#fff">${f.val.toLocaleString()}</span>
</div>
</div>
<div style="width:45px;text-align:right;font-size:.72em;color:var(--t3);flex-shrink:0">${convRate}</div>
</div>`;
}).join('')+'<div style="text-align:right;font-size:.7em;color:var(--t3);margin-top:4px">â† ë‹¨ê³„ë³„ ì „í™˜ìœ¨</div>';
}

function rSP(){
renderSpSearch();
renderSpTrend();
renderSpFunnel();
updatePlacePreview();
}

// ìŠ¤ë§ˆíŠ¸í”Œë ˆì´ìŠ¤ ëŒ€ì‹œë³´ë“œ ìƒˆë¡œê³ ì¹¨
function refreshSpDash(){
const btn=$('sp-refresh-btn');
btn.disabled=true;btn.innerHTML='<span class="spinner"></span>ê°±ì‹  ì¤‘...';
// ë°ì´í„° ë³€ë™
spSearchData.forEach(s=>{
s.visits=Math.max(10,s.visits+Math.round((Math.random()-.4)*30));
s.conv=Math.max(1,parseFloat((s.conv+(Math.random()-.4)*2).toFixed(1)));
});
const totalVisits=spSearchData.reduce((a,b)=>a+b.visits,0);
spSearchData.forEach(s=>s.pct=parseFloat((s.visits/totalVisits*100).toFixed(1)));
Object.values(spTrendData).forEach(arr=>{
arr.forEach(d=>{d.prev=d.cur;d.cur=Math.max(1,d.cur+Math.round((Math.random()-.4)*d.cur*0.15));});
});
const newViews=Math.round(2340+(Math.random()-.3)*400);
const newCalls=Math.round(38+(Math.random()-.3)*10);
setTimeout(()=>{
$('sp-views').textContent=newViews.toLocaleString();
$('sp-calls').textContent=newCalls;
renderSpSearch();
renderSpTrend();
renderSpFunnel();
btn.disabled=false;btn.innerHTML='ğŸ”„ ìƒˆë¡œê³ ì¹¨';
toast('âœ… í”Œë ˆì´ìŠ¤ ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
},800);
}

// í”Œë ˆì´ìŠ¤ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
function updatePlacePreview(){
const name=$('mp-name').value||'ì—…ì²´ëª… ë¯¸ì…ë ¥';
const cat=$('mp-category').value;
const phone=$('mp-phone').value||'â€”';
const hours=$('mp-hours').value||'â€”';
const addr=$('mp-addr').value||'â€”';
const url=$('mp-url').value||'â€”';
const desc=$('mp-desc').value||'ì†Œê°œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”';
const services=$('mp-services').value;
const tags=$('mp-tags').value;

$('mp-prev-name').textContent=name;
$('mp-prev-cat').textContent=cat;
$('mp-prev-phone').textContent=phone;
$('mp-prev-hours').textContent=hours;
$('mp-prev-addr').textContent=addr;
$('mp-prev-url').textContent=url.replace(/^https?:\/\//,'');
$('mp-prev-desc').textContent=desc;

// ì„œë¹„ìŠ¤ íƒœê·¸
if(services.trim()){
$('mp-prev-services').innerHTML=services.split(',').map(s=>s.trim()).filter(s=>s).map(s=>
`<span style="padding:4px 10px;background:var(--bg4);border:1px solid var(--border);border-radius:6px;font-size:.75em;color:var(--t1)">${s}</span>`
).join('');
}else{$('mp-prev-services').innerHTML='<span style="font-size:.75em;color:var(--t3)">ì„œë¹„ìŠ¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</span>'}

// í‚¤ì›Œë“œ íƒœê·¸
if(tags.trim()){
$('mp-prev-tags').innerHTML=tags.split(',').map(t=>t.trim()).filter(t=>t).map(t=>
`<span style="padding:3px 8px;background:rgba(3,199,90,.08);border:1px solid rgba(3,199,90,.2);border-radius:12px;font-size:.7em;color:#03C75A">#${t}</span>`
).join('');
}else{$('mp-prev-tags').innerHTML='<span style="font-size:.75em;color:var(--t3)">í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</span>'}

// ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
const filledImg=document.querySelector('#mp-imgs .isl.filled img');
if(filledImg){
$('mp-prev-img').innerHTML='<img src="'+filledImg.src+'" style="width:100%;height:100%;object-fit:cover">';
}
}

// AI í”Œë ˆì´ìŠ¤ í”„ë¡œí•„ ì§„ë‹¨
async function diagnosePlaceProfile(){
if(!apiKey){toast('âš ï¸ API í‚¤ í•„ìš”');showM('m-api');return}
const btn=$('mp-diag-btn');btn.disabled=true;btn.innerHTML='<span class="spinner"></span>ì§„ë‹¨ ì¤‘...';
const name=$('mp-name').value||'(ë¯¸ì…ë ¥)';
const cat=$('mp-category').value;
const desc=$('mp-desc').value||'(ë¯¸ì…ë ¥)';
const services=$('mp-services').value||'(ë¯¸ì…ë ¥)';
const tags=$('mp-tags').value||'(ë¯¸ì…ë ¥)';
const addr=$('mp-addr').value||'(ë¯¸ì…ë ¥)';
const strength=$('mp-desc').value||'';
toast('ğŸ¤– í”„ë¡œí•„ ì§„ë‹¨ ì¤‘...');
try{
const r=await callAI(`ë„¤ì´ë²„ ìŠ¤ë§ˆíŠ¸í”Œë ˆì´ìŠ¤(í”Œë ˆì´ìŠ¤) í”„ë¡œí•„ì„ ì§„ë‹¨í•´ì¤˜.

ì—…ì²´ ì •ë³´:
- ì—…ì²´ëª…: ${name}
- ì—…ì¢…: ${cat}
- ì£¼ì†Œ: ${addr}
- ì†Œê°œê¸€: ${desc}
- ì„œë¹„ìŠ¤: ${services}
- í‚¤ì›Œë“œ íƒœê·¸: ${tags}

ë‹¤ìŒì„ ë¶„ì„í•´ì¤˜:
1) í”„ë¡œí•„ ì™„ì„±ë„ (100ì  ë§Œì , ì ìˆ˜ì™€ ë¶€ì¡±í•œ ë¶€ë¶„)
2) ì†Œê°œê¸€ ê°œì„ ì•ˆ (ê²€ìƒ‰ ìµœì í™”ëœ ë²„ì „ìœ¼ë¡œ ë‹¤ì‹œ ì‘ì„±)
3) í‚¤ì›Œë“œ íƒœê·¸ ì§„ë‹¨ (ë¹ ì§„ í•„ìˆ˜ í‚¤ì›Œë“œ, ë¶ˆí•„ìš”í•œ í‚¤ì›Œë“œ)
4) ì„œë¹„ìŠ¤/ë©”ë‰´ ë“±ë¡ ê°œì„ ì•ˆ
5) ê²½ìŸì—…ì²´ ëŒ€ë¹„ ì°¨ë³„ì ì„ ë¶€ê°ì‹œí‚¬ ìˆ˜ ìˆëŠ” íŒ 2ê°€ì§€

ê° í•­ëª© 2-3ì¤„ì”© ê°„ê²°í•˜ê²Œ.`);
$('mp-diag-content').innerHTML='<b>ğŸ¤– AI í”„ë¡œí•„ ì§„ë‹¨ ê²°ê³¼</b><br><br>'+r.replace(/\n/g,'<br>');
$('mp-diag-result').style.display='block';
toast('âœ… ì§„ë‹¨ ì™„ë£Œ');
}catch(e){toast('âŒ '+e.message)}finally{
btn.disabled=false;btn.innerHTML='ğŸ¤– AI í”Œë ˆì´ìŠ¤ í”„ë¡œí•„ ì§„ë‹¨';
}}

// í‚¤ì›Œë“œ ìµœì í™” AI ë¶„ì„
async function analyzeSpKeywords(){
if(!apiKey){toast('âš ï¸ API í‚¤ í•„ìš”');showM('m-api');return}
const btn=$('sp-kw-btn');btn.disabled=true;btn.innerHTML='<span class="spinner"></span>AI ë¶„ì„ ì¤‘...';
const bizType=$('sp-biz-type').value;
const area=$('sp-biz-area').value;
const name=$('sp-biz-name').value||'(ë¯¸ì…ë ¥)';
const service=$('sp-biz-service').value||'(ë¯¸ì…ë ¥)';
const currentKw=$('sp-biz-current-kw').value||'(ë¯¸ë“±ë¡)';
const strength=$('sp-biz-strength').value||'(ë¯¸ì…ë ¥)';
toast('ğŸ¤– í‚¤ì›Œë“œ ìµœì í™” ë¶„ì„ ì¤‘...');
try{
// 1) ì¶”ì²œ í‚¤ì›Œë“œ
const r1=await callAI(`ë„¤ì´ë²„ í”Œë ˆì´ìŠ¤(ìŠ¤ë§ˆíŠ¸í”Œë ˆì´ìŠ¤) í‚¤ì›Œë“œ ìµœì í™” ë¶„ì„ì„ í•´ì¤˜.

ì—…ì²´ ì •ë³´:
- ì—…ì¢…: ${bizType}
- ì§€ì—­: ${area}
- ì—…ì²´ëª…: ${name}
- ì£¼ìš” ì„œë¹„ìŠ¤: ${service}
- í˜„ì¬ ë“±ë¡ í‚¤ì›Œë“œ: ${currentKw}
- ê°•ì : ${strength}

1) í”Œë ˆì´ìŠ¤ì— ë°˜ë“œì‹œ ì¶”ê°€í•´ì•¼ í•  ì¶”ì²œ í‚¤ì›Œë“œ 10ê°œë¥¼ ì•Œë ¤ì¤˜.
í˜•ì‹: "í‚¤ì›Œë“œ | ìš°ì„ ìˆœìœ„(í•„ìˆ˜/ì¶”ì²œ/ë³´ì¡°) | ì˜ˆìƒ ì›” ê²€ìƒ‰ëŸ‰ | ì¶”ì²œ ì´ìœ "
ì˜ˆ: LEDì „ê´‘íŒ ì„¤ì¹˜ | í•„ìˆ˜ | 3,200 | í•µì‹¬ ì„œë¹„ìŠ¤ í‚¤ì›Œë“œ

2) í˜„ì¬ í‚¤ì›Œë“œ(${currentKw}) ì§„ë‹¨: ë¹ ì§„ í‚¤ì›Œë“œ, ë¶ˆí•„ìš”í•œ í‚¤ì›Œë“œ, ê°œì„ ì ì„ 3ì¤„ë¡œ.

êµ¬ë¶„ì "---" ë¡œ 1)ê³¼ 2)ë¥¼ ë‚˜ëˆ ì¤˜.`);

const parts=r1.split('---');
const kwPart=parts[0]||r1;
const diagPart=parts[1]||'';

// ì¶”ì²œ í‚¤ì›Œë“œ íŒŒì‹±
const kwLines=kwPart.split('\n').filter(l=>l.includes('|'));
let kwHTML='<div style="display:grid;gap:6px">';
kwLines.forEach(line=>{
const p=line.split('|');
if(p.length>=3){
const kw=p[0].trim().replace(/^\d+[\.\)]\s*/,'');
const priority=p[1].trim();
const vol=p[2].trim();
const reason=p[3]?p[3].trim():'';
const pColor=priority.includes('í•„ìˆ˜')?'var(--ac)':priority.includes('ì¶”ì²œ')?'var(--g)':'var(--b)';
const pBg=priority.includes('í•„ìˆ˜')?'rgba(249,115,22,.12)':priority.includes('ì¶”ì²œ')?'rgba(52,211,153,.12)':'rgba(96,165,250,.12)';
kwHTML+=`<div style="display:flex;align-items:center;gap:8px;padding:8px 12px;background:var(--bg4);border-radius:var(--r2);border-left:3px solid ${pColor}">
<span style="font-size:.7em;padding:2px 8px;border-radius:8px;background:${pBg};color:${pColor};font-weight:600;flex-shrink:0">${priority}</span>
<span style="font-weight:600;color:var(--t1);flex:1">${kw}</span>
<span style="font-size:.75em;color:var(--t3);flex-shrink:0">ê²€ìƒ‰ ${vol}</span>
<button class="ebtn" onclick="navigator.clipboard.writeText('${kw.replace(/'/g,"\\'")}').then(()=>toast('ğŸ“‹ ë³µì‚¬ë¨'))" style="flex-shrink:0">ë³µì‚¬</button>
</div>`;
}
});
kwHTML+='</div>';
$('sp-rec-keywords').innerHTML=kwHTML;
$('sp-kw-diagnosis').textContent=diagPart.trim()||'ì§„ë‹¨ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...';

// 2) í‚¤ì›Œë“œ ì „ëµ
const r2=await callAI(`${area}ì—ì„œ ${bizType} ì—…ì¢…ì˜ ë„¤ì´ë²„ í”Œë ˆì´ìŠ¤ í‚¤ì›Œë“œ ì „ëµì„ ì•Œë ¤ì¤˜.

1) ì¹´í…Œê³ ë¦¬ë³„ í‚¤ì›Œë“œ ë°°ì¹˜ ì „ëµ (ì—…ì²´ ì†Œê°œ, ë©”ë‰´/ì„œë¹„ìŠ¤, íƒœê·¸ ê°ê°ì— ì–´ë–¤ í‚¤ì›Œë“œë¥¼ ë„£ì„ì§€)
2) ê²½ìŸì—…ì²´ì™€ ì°¨ë³„í™”í•  ìˆ˜ ìˆëŠ” í‹ˆìƒˆ í‚¤ì›Œë“œ 3ê°œ
3) ê³„ì ˆ/ì‹œê¸°ë³„ ì¶”ê°€í•´ì•¼ í•  í‚¤ì›Œë“œ
4) í”¼í•´ì•¼ í•  í‚¤ì›Œë“œ (ê³¼ë„í•œ í‚¤ì›Œë“œ ìŠ¤í„°í•‘ ë“±)

ê° í•­ëª© 2-3ì¤„ë¡œ ê°„ê²°í•˜ê²Œ.`);
$('sp-kw-strategy').textContent=r2||'';

$('sp-kw-results').style.display='block';
toast('âœ… ë¶„ì„ ì™„ë£Œ');
}catch(e){toast('âŒ '+e.message)}finally{
btn.disabled=false;btn.innerHTML='ğŸ¤– AI í‚¤ì›Œë“œ ìµœì í™” ë¶„ì„';
}}

// ìœ ì… ê²€ìƒ‰ì–´ AI ìƒˆë¡œê³ ì¹¨
async function refreshSpKeywords(){
if(!apiKey){toast('âš ï¸ API í‚¤ í•„ìš”');showM('m-api');return}
toast('ğŸ”„ ê²€ìƒ‰ì–´ ë¶„ì„ ì¤‘...');
try{
const r=await callAI(`LEDì „ê´‘íŒ/ë°©ì†¡ì¤‘ê³„ ì—…ì²´ì˜ ë„¤ì´ë²„ í”Œë ˆì´ìŠ¤ ìœ ì… ê²€ìƒ‰ì–´ TOP 10ì„ ì‹¤ì œì ìœ¼ë¡œ ì‹œë®¬ë ˆì´ì…˜í•´ì¤˜.
í˜•ì‹: "ìˆœìœ„ | ê²€ìƒ‰ì–´ | ìœ ì…ìˆ˜ | ë¹„ìœ¨(%) | ì „í™˜ìœ¨(%) | ì¶”ì´(up/down/same)"
ì˜ˆ: 1 | LEDì „ê´‘íŒ ì„¤ì¹˜ | 342 | 28.5 | 12.3 | up`);
const lines=r.split('\n').filter(l=>l.includes('|'));
const newData=[];
lines.forEach((line,i)=>{
const p=line.split('|');
if(p.length>=5){
newData.push({
rank:i+1,
kw:p[1].trim(),
visits:parseInt(p[2].trim())||0,
pct:parseFloat(p[3].trim())||0,
conv:parseFloat(p[4].trim())||0,
trend:(p[5]||'same').trim()
});
}
});
if(newData.length>0){
spSearchData.length=0;
newData.forEach(d=>spSearchData.push(d));
renderSpSearch();
}
toast('âœ… ì—…ë°ì´íŠ¸ ì™„ë£Œ');
}catch(e){toast('âŒ '+e.message)}}

// ì§€ì—­ ìˆœìœ„ ì¡°íšŒ
async function checkSpRanking(){
if(!apiKey){toast('âš ï¸ API í‚¤ í•„ìš”');showM('m-api');return}
const kw=$('sp-rank-kw').value.trim();
const area=$('sp-rank-area').value;
if(!kw){toast('âš ï¸ í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”');$('sp-rank-kw').focus();return}
const btn=$('sp-rank-btn');btn.disabled=true;btn.innerHTML='<span class="spinner"></span>ì¡°íšŒ ì¤‘...';
toast('ğŸ† ìˆœìœ„ ë¶„ì„ ì¤‘...');
try{
const r=await callAI(`"${kw}" í‚¤ì›Œë“œë¡œ "${area}" ì§€ì—­ì—ì„œ ë„¤ì´ë²„ í”Œë ˆì´ìŠ¤ ê²€ìƒ‰ ì‹œ ë‚˜ì˜¬ ìˆ˜ ìˆëŠ” ì—…ì²´ ìˆœìœ„ë¥¼ ì‹œë®¬ë ˆì´ì…˜í•´ì¤˜.

1) ìƒìœ„ 10ê°œ ì—…ì²´ ë¦¬ìŠ¤íŠ¸:
í˜•ì‹: "ìˆœìœ„ | ì—…ì²´ëª… | í‰ì  | ë¦¬ë·°ìˆ˜ | ê°•ì í‚¤ì›Œë“œ"
ë‚´ ì—…ì²´(LEDì „ê´‘íŒ ì „ë¬¸ì—…ì²´)ë¥¼ 3~8ìœ„ ì‚¬ì´ì— ë°°ì¹˜í•˜ê³  "(ë‚´ ì—…ì²´)" í‘œì‹œí•´ì¤˜.

2) ë‚´ ì—…ì²´ì˜ ìˆœìœ„ì™€ ì´ ê²½ìŸì—…ì²´ ìˆ˜ë¥¼ ì•Œë ¤ì¤˜.
í˜•ì‹: "ë‚´ìˆœìœ„: Nìœ„ | ì´ì—…ì²´: Mê°œ"

3) ìˆœìœ„ë¥¼ ì˜¬ë¦¬ê¸° ìœ„í•œ êµ¬ì²´ì  ì „ëµ 3ê°€ì§€ (ê° 1-2ì¤„)

êµ¬ë¶„ì "---" ë¡œ ë‚˜ëˆ ì¤˜.`);

const parts=r.split('---');

// ìˆœìœ„ í…Œì´ë¸”
const tablePart=parts[0]||'';
const lines=tablePart.split('\n').filter(l=>l.includes('|'));
let myRank='â€”';let totalBiz='â€”';
$('sp-rank-tbody').innerHTML=lines.map(line=>{
const p=line.split('|');
if(p.length<4)return '';
const rank=p[0].trim().replace(/[^\d]/g,'');
const name=p[1].trim();
const rating=p[2].trim();
const reviews=p[3].trim();
const tags=p[4]?p[4].trim():'';
const isMe=name.includes('ë‚´ ì—…ì²´')||name.includes('ìš°ë¦¬');
if(isMe)myRank=rank;
return `<tr style="${isMe?'background:rgba(249,115,22,.08);':''}">
<td><span class="rank-num ${parseInt(rank)<=3?'top':parseInt(rank)<=7?'mid':'low'}">${rank}</span></td>
<td style="font-weight:600;color:${isMe?'var(--ac)':'var(--t1)'}">${name}</td>
<td>${rating}</td>
<td>${reviews}</td>
<td style="font-size:.72em;color:var(--t3)">${tags}</td>
</tr>`;
}).join('');

// ë©”íƒ€ ì •ë³´
const metaPart=parts[1]||'';
const metaMatch=metaPart.match(/ì´ì—…ì²´[:\s]*(\d+)/);
if(metaMatch)totalBiz=metaMatch[1];
if(myRank==='â€”'){const rm=metaPart.match(/ë‚´ìˆœìœ„[:\s]*(\d+)/);if(rm)myRank=rm[1];}

$('sp-my-rank').textContent=myRank!=='â€”'?myRank+'ìœ„':'â€”';
$('sp-my-rank-sub').textContent=`"${kw}" ê²€ìƒ‰ ê¸°ì¤€ (${area})`;
$('sp-total-biz').textContent=totalBiz!=='â€”'?totalBiz+'ê°œ':'ì•½ 45ê°œ';
$('sp-total-biz-sub').textContent=`${area} ë™ì¼ ì—…ì¢…`;

// ì „ëµ
const stratPart=parts[2]||'';
if(stratPart.trim()){
$('sp-rank-analysis').textContent=stratPart.trim();
$('sp-rank-analysis-box').style.display='block';
}

// í‚¤ì›Œë“œë³„ ìˆœìœ„ ì¶”ì ì— ì¶”ê°€
addRankHistory(kw,area,myRank);

toast('âœ… ìˆœìœ„ ì¡°íšŒ ì™„ë£Œ');
}catch(e){toast('âŒ '+e.message)}finally{
btn.disabled=false;btn.innerHTML='ğŸ† ìˆœìœ„ ì¡°íšŒ';
}}

// ìˆœìœ„ ì¶”ì  íˆìŠ¤í† ë¦¬
const spRankHistory=[];
function addRankHistory(kw,area,rank){
const existing=spRankHistory.find(h=>h.kw===kw&&h.area===area);
if(existing){
existing.prev=existing.rank;
existing.rank=parseInt(rank)||'â€”';
}else{
spRankHistory.push({kw,area,rank:parseInt(rank)||'â€”',prev:'â€”',month:parseInt(rank)+Math.floor(Math.random()*5)-2||'â€”',target:Math.max(1,(parseInt(rank)||5)-3)});
}
renderRankHistory();
}

function renderRankHistory(){
$('sp-rank-history').innerHTML=spRankHistory.map(h=>{
const diff=h.prev!=='â€”'&&h.rank!=='â€”'?h.prev-h.rank:0;
const changeClass=diff>0?'up':diff<0?'down':'same';
const changeText=diff>0?'â–²'+diff:diff<0?'â–¼'+Math.abs(diff):'â€”';
const rankClass=h.rank!=='â€”'?(h.rank<=5?'top':h.rank<=10?'mid':'low'):'';
return `<tr>
<td style="font-weight:600;color:var(--t1)">${h.kw}</td>
<td style="font-size:.8em;color:var(--t3)">${h.area}</td>
<td><span class="rank-num ${rankClass}">${h.rank!=='â€”'?h.rank+'ìœ„':'â€”'}</span></td>
<td><span class="rank-change ${changeClass}">${changeText}</span></td>
<td style="color:var(--t3)">${h.month!=='â€”'?h.month+'ìœ„':'â€”'}</td>
<td style="color:var(--g);font-weight:600">${h.target}ìœ„</td>
</tr>`;
}).join('')||'<tr><td colspan="6" style="text-align:center;color:var(--t3);padding:16px">í‚¤ì›Œë“œ ìˆœìœ„ë¥¼ ì¡°íšŒí•˜ë©´ ìë™ìœ¼ë¡œ ì¶”ì ë©ë‹ˆë‹¤</td></tr>';
}

// === INIT ===
initMnav();rOOH();rOOHT();rDash();rSP();renderRankHistory();renderStyleDash();renderCmpHistory();renderKwrRecent();renderKwrSaved();
if(!apiKey)setTimeout(()=>showM('m-api'),1200);
</script></body></html>